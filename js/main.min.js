(function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require=="function"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error("Cannot find module '"+o+"'");throw f.code="MODULE_NOT_FOUND",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require=="function"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})({"/Users/sanchez/Sanchez/WORK/babysiri/src/js/entities/FriendBtn.js":[function(require,module,exports){
/**
 * Created by sanchez on 16/6/21.
 */
'use strict';

function FriendBtn(game, x, y,n) {
    this.game=game;
    this._x=x;
    this._y=y;
    this._n=n;

    Phaser.Sprite.call(this, game,  this._x, this._y,'friend_sprite',n);
    this.anchor.setTo(0.5);
    this.scale.setTo(0);

    this.bindInput();                       
    // this.anchor.setTo(0.5);
    // this.game.add.existing(this);

    return this;
}

FriendBtn.prototype = Object.create(Phaser.Sprite.prototype);
FriendBtn.prototype.constructor = FriendBtn;

FriendBtn.prototype.bindInput = function() {
    var faudio=this.game.add.audio('f'+this._n);

    this.inputEnabled = true;
    this.events.onInputDown.add(function () {
        this.alpha = 0.6;
    }, this);
    this.events.onInputUp.add(function () {
        // this.inputEnabled = false;
        this.alpha =1;
        faudio.play();


        // var maudioSt=$("#faudio"+this.n)[0];
        // maudioSt.play();


    }, this);
};


module.exports = FriendBtn;
},{}],"/Users/sanchez/Sanchez/WORK/babysiri/src/js/entities/MovieClip.js":[function(require,module,exports){
/**
 * Created by daimons on 15/12/18.
 */

'use strict';


/*
 视频序列帧播放类         
 @startIndex 开始图片文件序列
 @endIndex 结束图片文件序列      
 @x y width height 视频的位置及宽高
 @frameWidth,frameHeight  序列帧纹理宽高     
 @totalFrames 视频序列帧总帧数
 @frameRate  帧速率 每秒帧数
 @onComplete 播放结束回调
 */


//prefix,startIndex,endIndex,,frameWidth,frameHeight,totalFrames,frameRate


function MovieClip(game, _x, _y, _width, _height, videoConfig, onComplete) {
    this.game = game;
    this.videoConfig = videoConfig;
    this.curentIndex = !!this.videoConfig ? this.videoConfig.getStartIndex() : 0;
    this._x = _x;
    this._y = _y;
    this._width = _width;
    this._height = _height;
    this._pause = false;

    this._scale = this._width / this.videoConfig.frameWidth;
    this.onComplete = onComplete;
    Phaser.Sprite.call(this, this.game, this._x, this._y);
    this.anchor.set(0);
    this.sprite = null;
    return this;
};
       
MovieClip.prototype = Object.create(Phaser.Sprite.prototype);

MovieClip.prototype.constructor = MovieClip;

MovieClip.prototype.playVideo = function () {


    if (this.sprite == null) {
        this.sprite = this.game.make.sprite(0, 0, this.videoConfig.prefix + this.curentIndex);
        this.addChild(this.sprite);
    } else {
        this.curentIndex = 0;
        this.sprite.loadTexture(this.videoConfig.prefix + this.curentIndex, 0);
    }
    this.anim = this.sprite.animations.add('anim' + this.curentIndex);

    this.anim.onComplete.add(this.onAnimationFinish, this);
    this.sprite.anchor.set(0);
    this.sprite.scale.set(this._scale);  //以视频的宽为准
    this.sprite.animations.play('anim' + this.curentIndex, this.videoConfig.frameRate, false);
};

MovieClip.prototype.onAnimationFinish = function (pSender) {
    this.curentIndex++;
    if (this.curentIndex > this.videoConfig.end) {
        if (!!this.onComplete || typeof(this.onComplete) == 'function') {
            this.onComplete();
        }
        return;
    }
    this.sprite.loadTexture(this.videoConfig.prefix + this.curentIndex, 0);
    this.anim = this.sprite.animations.add('anim' + this.curentIndex);
    this.anim.onComplete.add(this.onAnimationFinish, this);
    this.sprite.animations.play('anim' + this.curentIndex, this.videoConfig.frameRate, false);
};


//是否暂停
MovieClip.prototype.isPause = function () {
    return this._pause;     
};


//暂停
MovieClip.prototype.pause = function () {
    if (!!this.sprite) {
        this.sprite.animations.stop('anim' + this.curentIndex, false);
        this.curentFrame=this.anim.frame;
        this._pause = true;
    }
};

//停止 恢复首帧
MovieClip.prototype.stop = function () {
    if (!!this.sprite) {
        this.sprite.animations.stop('anim' + this.curentIndex, false);
        this.curentIndex = 0;
        this.sprite.loadTexture(this.videoConfig.prefix + this.curentIndex, 0);
    }
};

//继续播放
MovieClip.prototype.resume = function () {
    if (!!this.sprite) {
        // .currentFrame=this.curentFrame;

        this.sprite.animations.play('anim' + this.curentIndex, this.videoConfig.frameRate, false);
        this.anim.frame=this.curentFrame;
        // console.log("resume");
        this._pause = false;
    }
};


module.exports = MovieClip;
},{}],"/Users/sanchez/Sanchez/WORK/babysiri/src/js/entities/PieProgress.js":[function(require,module,exports){
/**
 * Created by sanchez on 16/5/18.
 */
'use strict';

function PieProgress(game, x, y, radius, color, angle, weight) {
    this._radius = radius;
    this._progress = 1;
    this._weight = weight || 0.25;
    this._color = color||"#fff";
    this.bmp = game.add.bitmapData((this._radius * 2) + (this._weight * (this._radius * 0.6)), (this._radius * 2) + (this._weight * (this._radius * 0.6)));
    Phaser.Sprite.call(this, game, x, y, this.bmp);

    this.anchor.set(0.5);
    this.angle = angle || -90;
    this.updateProgress();
    return this;
}

PieProgress.prototype = Object.create(Phaser.Sprite.prototype);
PieProgress.prototype.constructor = PieProgress;

PieProgress.prototype.updateProgress = function() {
    var progress = this._progress;
    progress = Phaser.Math.clamp(progress, 0.00001, 0.99999);

    this.bmp.clear();
    this.bmp.ctx.strokeStyle = this._color;
    this.bmp.ctx.lineWidth = this._weight * this._radius;
    this.bmp.ctx.beginPath();
    this.bmp.ctx.arc(this.bmp.width * 0.5, this.bmp.height * 0.5, this._radius - 15, 0, (Math.PI * 2) * progress, false);
    this.bmp.ctx.stroke();
    this.bmp.dirty = true;
};
PieProgress.prototype.updateBmdSize = function() {
    this.bmp.resize((this._radius * 2) + (this._weight * (this._radius * 0.75)), (this._radius * 2) + (this._weight * (this._radius * 0.75)));
};

module.exports = PieProgress;
},{}],"/Users/sanchez/Sanchez/WORK/babysiri/src/js/entities/QuestionBtn.js":[function(require,module,exports){
/**
 * Created by sanchez on 16/6/17.
 */
'use strict';

function QuestionBtn(game, x, y,qu_num,ad) {
    this.game=game;
    this._x=x;
    this._y=y;
    this.qu_num=qu_num;
    // this.qu_func=qu_func;
    if(ad!=undefined)
        this.ad=ad;
    else this.ad=false;

    
    Phaser.Sprite.call(this, game, 0, 0);


    if(!ad){
        this.mquestion = this.game.make.bitmapText( this._x, this._y, 'babyfont', window.quArray[window.numArray[qu_num]], 36); //148
    }else {
        this.mquestion = this.game.make.bitmapText( this._x, this._y, 'babyfont', window.endArray[qu_num], 36); //148
    }

    this.mquestion.anchor.setTo(0.5);
    this.mquestion._width=this.mquestion.width;
    if(qu_num%2){
        this.mquestion.x = -this.mquestion.width;
    }else {
        this.mquestion.x = 750+this.mquestion.width;
    }

    this.addChild(this.mquestion);

    this.clickarea=this.game.make.sprite(0,0);
    this.clickarea.width=300;
    this.clickarea.height=80;
    this.clickarea.anchor.setTo(0.5);
    this.mquestion.addChild(this.clickarea);

    this.bindInput();
    // this.anchor.setTo(0.5);
    this.game.add.existing(this);
    
    return this;
}

QuestionBtn.prototype = Object.create(Phaser.Sprite.prototype);
QuestionBtn.prototype.constructor = QuestionBtn;

QuestionBtn.prototype.bindInput = function() {
    var that=this;
    this.clickarea.inputEnabled = true;
    this.clickarea.events.onInputDown.addOnce(function () {
        window.haveclicked=true;
        this.mquestion.alpha=0.6;
    }, this);
    this.clickarea.events.onInputUp.addOnce(function () {
        this.clickarea.inputEnabled = false;
        window.question_no=window.numArray[this.qu_num];
        // console.log("my question:  " +  window.question_no);
        if(this.ad){
            window.readCount=7;
        }else {

            window.readCount++;

        }
        // console.log("readeCount :"+ window.readCount )
        if(window.readCount==6){
            window.question_no=5;
            that.game.state.start('Ending');
            return;
        }


        this.renderQu(window.numArray[this.qu_num]);

    }, this);
};
QuestionBtn.prototype.mdestroy=function () {
    this.mquestion.kill();
    this.mquestion=null;
    this.clickarea.kill();
    this.clickarea=null;
    this.kill();

};


QuestionBtn.prototype.renderVideo=function () {
    // console.log("START Video");
    this.game.state.start('Mvideo');

};
QuestionBtn.prototype.renderVoice=function () {
    // console.log("START Voice");
    this.game.state.start('Mvoice');

};
QuestionBtn.prototype.renderName=function () {
    // console.log("START Name")
    this.game.state.start('Mname');

};
QuestionBtn.prototype.renderEnd=function () {
    // console.log("START Ending");
    this.game.state.start('Ending');

};

QuestionBtn.prototype.renderQu=function (n) {
    var that = this;
    if(this.ad){
        window.question_no= this.qu_num;
        that.renderEnd();
        return;
    }
    switch (n) {
        case 0:
            that.renderName();
            break;
        case 1:
            that.renderVideo();
            break;
        case 2:
            that.renderVideo();
            break;
        case 3:
            that.renderVoice();
            break;
        case 4:
            that.renderVideo();
            break;
        case 5:
            that.renderVideo();
            break;
        case 6:
            that.renderVideo();
            break;
        case 7:
            that.renderVideo();
            break;
        case 8:
            that.renderVideo();
            break;
        case 9:
            that.renderVoice();
            break;
        case 10:
            that.renderVideo();
            break;
        case 11:
            that.renderVoice();
            break;
        case 12:
            that.renderVoice();
            break;
        case 13:
            that.renderVideo();
            break;
        case 14:
            that.renderVideo();
            break;
        case 15:
            that.renderVideo();
            break;
        case 16:
            that.renderVoice();
            break;
        case 17:
            that.renderVoice();
            break;


    }

};


module.exports = QuestionBtn;
},{}],"/Users/sanchez/Sanchez/WORK/babysiri/src/js/entities/VideoConfig.js":[function(require,module,exports){
/**
 * Created by daimons on 15/12/19.
 */

'use strict';

/*

 视频序列帧配置类
 @filepath 路径
 @prefix 前缀
 @postfix 后缀
 @start 序列帧素材开始索引
 @end  序列帧素材结束索引
 @frameWidth 帧宽度
 @frameHeight 帧高度
 @frames 每张图片所包含的总帧数
 @totalFrame 视频总帧数
 @frameRate 帧速率 每秒多少帧

 */


function VideoConfig(game, filepath, prefix, postfix, start, end, frameWidth, frameHeight, frames, totalFrame, frameRate) {
    this.game = game;
    this.frameWidth = frameWidth || 320;
    this.frameHeight = frameHeight || 569;
    this.frames = frames || 9;
    this.frameRate = frameRate || 15;

    this.filepath = filepath;
    this.prefix = prefix;
    this.postfix = postfix;
    this.start = start;
    this.end = end;
    this.totalFrame = totalFrame;
}


VideoConfig.prototype = {
    preload: function () {
        for (var i = this.start; i <= this.end; i++) {
            var nFrame = this.frames;
            if (i == this.end) { //最后一张图片计算剩余帧数
                nFrame = this.totalFrame % this.frames;

            }
            this.game.load.spritesheet(this.prefix + i, this.filepath + this.prefix + i + this.postfix, this.frameWidth, this.frameHeight, nFrame);
        }
    },
    getStartIndex: function () {
        return this.start;
    },
    // removeload:function () {
    //     for (var i = this.start; i <= this.end; i++) {
    //         var nFrame = this.frames;
    //         if (i == this.end) { //最后一张图片计算剩余帧数
    //             nFrame = this.totalFrame % this.frames;
    //
    //         }
    //         this.game.load.spritesheet(this.prefix + i, this.filepath + this.prefix + i + this.postfix, this.frameWidth, this.frameHeight, nFrame);
    //     }
    //
    // }
};


module.exports = VideoConfig;
},{}],"/Users/sanchez/Sanchez/WORK/babysiri/src/js/main.js":[function(require,module,exports){
'use strict';
var VideoConfig = require('./entities/VideoConfig');

var ua = navigator.userAgent,
    android = ua.match(/(Android);?[\s\/]+([\d.]+)?/),
    ipad = ua.match(/(iPad).*OS\s([\d_]+)/),
    ipod = ua.match(/(iPod)(.*OS\s([\d_]+))?/),
    iphone = !ipad && ua.match(/(iPhone\sOS)\s([\d_]+)/);

// window.share = new WxMoment.Share();


// window.android=!(android&&android[2] <= '6');
window.android=!android;
window.androidv=true;
// window.androidv=!(android&&android[2] <= '6')&&!iphone;


if(!window.android){
    $('#maudio').remove();
   document.getElementById("bga").style.display="block";
}else {
    $('#maudio').remove();
    document.getElementById("bg1").style.display="block";
}


window.babys = {
    OnResize: function () {
        var screenRate = 1206 / 750;
        var mWidth;
        var mHeight;
        var spriteScale;
        var bgScale;
        //横竖屏幕
        var mWidth =window.innerWidth;
        var mHeight = window.innerHeight;
        if ((mHeight / mWidth) > (1206 / 750)) {
            mHeight = screenRate * mWidth;
            window.spriteScale = mWidth / 750;
            bgScale = 750 / mWidth;
        } else {
            mWidth = mHeight / screenRate;
            window.spriteScale = mHeight / 1206;
            bgScale = 1206 / mHeight;
        }
        $("#video_wrapper").css({
            left: 0,
            width:750,
            height: 548,
            "transform": "scale(" + window.spriteScale + ")",
            transformOrigin: "left top",
            top: 300/1206*window.innerHeight
        });

        $("#name_wrapper").css({
            left: "50%",
            marginLeft: -mWidth / 2,
            width: 750,
            height: 388,
            "transform": "scale(" + window.spriteScale + ")",
            transformOrigin: "left top",
            top: 370/1206*window.innerHeight
        });


    },
    eventInit: function () {
        var that = this;
        document.addEventListener('touchstart', function (e) {
        }, false);
        document.addEventListener('touchmove', function (e) {
            e.preventDefault();
        }, false);
        //禁止弹出选择菜单
        document.documentElement.style.webkitTouchCallout = "none";


        return that;
    }
};


window.babys.OnResize();
window.babys.eventInit();

// window.babys.initCZ();






window.game = new Phaser.Game(750, 1206, Phaser.CANVAS, 'babysiri-game',null,true);



window.playerState = {
    currentLevel: 'Game'
};

/*
 视频序列帧的所有配置写在这里
 */
window.phone = new VideoConfig(window.game, "assets/video/bv3/", "bv3_", ".jpg", 0, 9, 375, 603, 15, 138, 15);

var bv1C=new VideoConfig(window.game, "assets/video/bv1/", "bv1_", ".jpg", 0, 9, 670, 440, 12, 111, 15);
var bv2C=new VideoConfig(window.game, "assets/video/bv2/", "bv2_", ".jpg", 0, 12, 670, 440, 12, 153, 15);
var bv4C=new VideoConfig(window.game, "assets/video/bv4/", "bv4_", ".jpg", 0, 3, 670, 440, 12, 46, 15);
var bv5C=new VideoConfig(window.game, "assets/video/bv5/", "bv5_", ".jpg", 0, 10, 670, 440, 12, 131, 15);
var bv6C=new VideoConfig(window.game, "assets/video/bv6/", "bv6_", ".jpg", 0, 9, 670, 440, 12, 112, 15);
var bv7C=new VideoConfig(window.game, "assets/video/bv7/", "bv7_", ".jpg", 0, 7, 670, 440, 12, 90, 15);
var bv8C=new VideoConfig(window.game, "assets/video/bv8/", "bv8_", ".jpg", 0, 5, 670, 440, 12, 71, 15);
var bv10C=new VideoConfig(window.game, "assets/video/bv10/", "bv10_", ".jpg", 0, 4, 670, 440, 12, 52, 15);
var bv13C=new VideoConfig(window.game, "assets/video/bv13/", "bv13_", ".jpg", 0, 4, 670, 440, 12, 49, 15);
var bv14C=new VideoConfig(window.game, "assets/video/bv14/", "bv14_", ".jpg", 0, 10, 670, 440, 12, 127, 15);
var bv15C=new VideoConfig(window.game, "assets/video/bv15/", "bv15_", ".jpg", 0, 4, 670, 440, 12, 53, 15);
window.vendC=new VideoConfig(window.game, "assets/video/vend/", "vend_", ".jpg", 0, 18, 670, 440, 12, 225, 15);
// window.czC = new VideoConfig(window.game, "assets/video/cz/", "cz_", ".jpg", 0, 5, 375, 603, 15, 76, 15);
window.bvConfigArray = [null,bv1C, bv2C, null,bv4C, bv5C, bv6C, bv7C,bv8C,null,bv10C,null,null,bv13C,bv14C,bv15C];


window.numArray = new Array();
for (var i = 0; i <= 17; i++) {
    window.numArray[i] = i;
}
window.numArray.sort(function () {
    return 0.5 - Math.random();
});
window.quArray = ["你叫什么名字？","给我讲个故事", "你会算术吗？", "告诉我一个小秘密吧", "我好看吗？", "你会画画吗？", "给我唱首歌", "你爱玩什么游戏呀？",
    "你喜欢吃什么水果？","今天天气怎么样？","结婚是什么？","我好无聊","朋友是什么","你喜欢我吗？","把你的玩具送我吧","碰到坏叔叔怎么办？","你长大想做什么","说句东北话"];
window.asArray= [null,"好呀，就看你能不能听懂了。","一五得五，二五一十，三五，三五 …","嘘，我悄悄告诉你。快接电话！",null,"会呀",null,null,
    "除了柠檬我都喜欢", "下雨啦！",null,"那我们就去个好玩的地方吧",null,null,null,null,"长大后我就是Siri啦。","哎妈呀，我害小，不咋会缩话妮！"]
window.endArray = ["你喜欢看动画片吗？", "你平时都跟谁一起玩啊？","你最喜欢的明星是谁啊？","给我卖个萌呗！","北鼻来跟我玩一会儿"];

window.quG = 0;
window.haveclicked=false;
window.havechanged=false;
window.havenamed=false;
window.phone_clicked=false;
window.readCount=0;
window.haveshared=false;
window.game.state.add('Boot', require('./states/boot'));
window.game.state.add('Preloader', require('./states/preloader'));
window.game.state.add('Home', require('./states/home'));
window.game.state.add('Game', require('./states/game'));
window.game.state.add('Mname', require('./states/mname'));
window.game.state.add('Mvoice', require('./states/mvoice'));
window.game.state.add('Mvideo', require('./states/mvideo'));

window.game.state.add('Ending', require('./states/ending'));
window.game.state.start('Boot');


var hm = document.createElement("script");
hm.src = "//tajs.qq.com/stats?sId=56874741";
var s = document.getElementsByTagName("script")[0];
s.parentNode.insertBefore(hm, s);
},{"./entities/VideoConfig":"/Users/sanchez/Sanchez/WORK/babysiri/src/js/entities/VideoConfig.js","./states/boot":"/Users/sanchez/Sanchez/WORK/babysiri/src/js/states/boot.js","./states/ending":"/Users/sanchez/Sanchez/WORK/babysiri/src/js/states/ending.js","./states/game":"/Users/sanchez/Sanchez/WORK/babysiri/src/js/states/game.js","./states/home":"/Users/sanchez/Sanchez/WORK/babysiri/src/js/states/home.js","./states/mname":"/Users/sanchez/Sanchez/WORK/babysiri/src/js/states/mname.js","./states/mvideo":"/Users/sanchez/Sanchez/WORK/babysiri/src/js/states/mvideo.js","./states/mvoice":"/Users/sanchez/Sanchez/WORK/babysiri/src/js/states/mvoice.js","./states/preloader":"/Users/sanchez/Sanchez/WORK/babysiri/src/js/states/preloader.js"}],"/Users/sanchez/Sanchez/WORK/babysiri/src/js/states/boot.js":[function(require,module,exports){
(function () {
    'use strict';

    var Boot = function () {
    };

    module.exports = Boot;

    Boot.prototype = {
        preload: function () {
            // this.load.image('preloader', 'assets/preloader.gif');
            // this.load.spritesheet('load_run', 'assets/img/load_man.png',100,100,18);
            if(!window.android){
                this.load.image('bg', 'assets/img/bg2.jpg');
                this.load.image('bg', 'assets/img/bga.jpg');
                this.load.spritesheet('loader_a', 'assets/img/loader_a.png',270,142,31);
                this.load.spritesheet('lt', 'assets/img/lt_a.png', 298, 28, 3);
            }else {
                this.load.image('bg', 'assets/img/bg2.jpg');
                this.load.image('bg', 'assets/img/bg1.jpg');
                this.load.spritesheet('lt', 'assets/img/lt.png', 218, 32, 4);
            }

        },

        create: function () {
            var that = this;
            // configure game
            this.game.input.maxPointers = 1;

            if (this.game.device.desktop) {
                this.game.scale.pageAlignHorizontally = true;
            } else {


                if(!window.android){
                    this.scale.scaleMode = Phaser.ScaleManager.SHOW_ALL;
                    // this.scale.pageAlignHorizontally = true;
                    // this.scale.pageAlignVertically = true;
                }else {
                    this.scale.scaleMode = Phaser.ScaleManager.USER_SCALE;
                    this.scale.setUserScale(window.innerWidth/750,window.innerWidth/750,0,0);
                }


                // $("#babysiri-game").find("canvas").css("bottom","0");
            }
            this.game.state.start('Preloader');
        }

    };

}());


},{}],"/Users/sanchez/Sanchez/WORK/babysiri/src/js/states/ending.js":[function(require,module,exports){
/**
 * Created by sanchez on 16/6/15.
 */
(function () {
    'use strict';
    var MovieClip = require('../entities/MovieClip');
    var Ending = function () {


        this.endasArray = [
            ["我喜欢，", "但是我最喜欢看“放开我北鼻”！", "里面有我最喜欢的哥哥们！"],
            ["我最近经常和一个小鲜肉哥哥玩，", "他还带我上电视了！", "你想不想看看啊！"],
            ["我最喜欢的明星最近正在录一个节目，", "叫“放开我，北鼻”", "特别好看，你和我一起吧！"],
            ["我本来就很萌啊！", "我的小伙伴们也很萌，如果你想看的话，", "我们在“放开我北鼻”等你啊！"],
            ["我只是个机器人，没办法跟你玩。", "不过我告诉你一个好玩的节目。", "不但有小北鼻，还有好多小鲜肉呢！"],
            ["你问题好多啊，大人真没意思，", "想逗北鼻还不如去看看", "“放开我，北鼻”吧！"]
        ]

    };

    module.exports = Ending;

    Ending.prototype = {
        create: function () {
            var that = this;
            window.end_n = 0;

            this.bvoice_sprite = this.add.sprite(375, 1206, 'bvoice_sprite');
            this.bvoice_sprite.anchor.setTo(0.5, 1);
            this.bvoice_sprite.animations.add('startp', [0, 1, 2, 3, 4, 5, 6, 7], 15, false);
            this.bvoice_sprite.animations.add('loopp', [8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27], 15, true);
            this.bvoice_sprite.animations.add('endp', [7, 6, 5, 4, 3, 2, 1, 0], 15, false);


            this.back_btn = this.add.sprite(375, 1106, 'back_btn');
            this.back_btn.anchor.setTo(0.5);
            this.back_btn.scale.setTo(0);
            this.back_btn.inputEnabled = true;
            this.back_btn.events.onInputDown.addOnce(function () {
                this.back_btn.alpha = 0.6;
            }, this);
            this.back_btn.events.onInputUp.addOnce(function () {

                if(!window.android||window.androidv){
                    // var vaudio=$("#vend")[0];
                    // var mvd= this.vaudio;
                    that.vaudio.pause();
                    // this.vaudio.src = "";
                    that.bvideo.pause();
                    
                }else {
                    $("#mvideo")[0].pause();
                }

                if (window.haveshared) {
                    $("#mvideo")[0].src = "";
                    $("#mvideo")[0].poster = "";
                    $("#video_wrapper").css({
                        "display": "none",
                        "width": 0,
                        "height": 0,
                        "top": 300 /1206*window.innerHeight
                    });
                    that.game.state.start('Game');
                    return;
                } else {
                    window.haveshared = true;
                }

                var share_wrapper = document.getElementById("share_wrapper");
                share_wrapper.style.display = "block";


                $("#sclose_btn").on("touchstart", function () {
                    TweenMax.to(share_wrapper, 0.4, {
                        opacity: 0, onComplete: function () {
                            share_wrapper.style.display = "none";
                            share_wrapper.style.opacity = 1;
                            that.game.state.start('Game');
                            $("#mvideo")[0].src = "";
                            $("#mvideo")[0].poster = "";
                            $("#video_wrapper").css({
                                "display": "none",
                                "width": 0,
                                "height": 0,
                                "top": 300 /1206*window.innerHeight
                            });
                        }
                    })
                });
                this.game.time.events.add(5000, function () {
                    TweenMax.to(share_wrapper, 0.4, {
                        opacity: 0, onComplete: function () {
                            share_wrapper.style.display = "none";
                            share_wrapper.style.opacity = 1;
                            that.game.state.start('Game');
                            $("#mvideo")[0].src = "";
                            $("#mvideo")[0].poster = "";
                            $("#video_wrapper").css({
                                "display": "none",
                                "width": 0,
                                "height": 0,
                                "top": 300 /1206*window.innerHeight
                            });
                        }
                    })

                }, this);


            }, this);

            if (window.question_no == undefined) {
                window.question_no =5;
            }

            if(!window.android||window.androidv){
                this.qaudio = new Howl({
                    src: ['assets/audio/e'+window.question_no+'.mp3']
                });
                this.vaudio = new Howl({
                    src: ['assets/audio/vend.mp3']
                });
            }
            // window.question_no = 4;
            // game.add.tween(this.back_btn.scale).to({x: 1, y: 1}, 800, Phaser.Easing.Bounce.Out, true);

            if (window.question_no != 5) {
                this.t2 = this.add.bitmapText(733, 63, 'babyfont', '“' + window.endArray[window.question_no] + '”', 36);
                this.t2.anchor.setTo(1, 0);


                var c1 = game.add.tween(this.t2).from({
                    x: 750 + 200,
                    alpha: 0
                }, 800, Phaser.Easing.Bounce.Out, true, 20);

                c1.onComplete.add(function () {
                    this.qloader = this.add.sprite(122, 180, 'qloader');
                    this.qloader.anchor.setTo(0.5);
                    this.qloader.scale.setTo(0.5);

                    this.ql_aim = this.qloader.animations.add('ql', [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]);
                    this.ql_aim.play(17, true);
                    if(!window.android||window.androidv){
                        this.renderLoadA();
                    }else {
                        this.renderLoad();
                    }

                }, this);
            } else {
                this.qloader = this.add.sprite(122, 120, 'qloader');
                this.qloader.anchor.setTo(0.5);
                this.qloader.scale.setTo(0.5);

                this.ql_aim = this.qloader.animations.add('ql', [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]);
                this.ql_aim.play(17, true);
                if(!window.android||window.androidv){
                    this.renderLoadA();
                }else {
                    this.renderLoad();
                }

            }

        },
        update: function () {
            if (window.haveloaded) {
                window.haveloaded = false;
                this.ql_aim.stop();
                // this.ql_aim.play(17, false);
                this.qloader.kill();
                if (!window.android||window.androidv) {
                    this.showAnA();
                } else {
                    this.showAn();
                }
            }

        },
        renderVideoHtml: function () {
            var that = this;

            $("#video_wrapper").css({"display": "block", "height": 0, "width": 0});

            TweenMax.to($("#video_wrapper"), 0.4, {
                width: 750, height: 548, ease: Power2.easeIn, onComplete: function () {
                    // console.log("play");
                    $("#mvideo")[0].play();
                    that.renderLinkBtn();
                }
            });

        },
        showAnA: function () {
            var that = this;
            // var vaudio = $("#vend")[0];
            var video_bg = this.add.image(0, 380, 'video_bg');
            var mask2 = game.add.graphics(0, 0);
            mask2.beginFill(0xffffff);
            mask2.drawRect(0 - 750, 380 - 548, 750, 548);
            mask2.endFill();
            video_bg.mask = mask2;
            if (window.question_no != 5) {

                var qt1 = this.add.bitmapText(44, 164, 'babyfont', this.endasArray[window.question_no][0], 36);
                var qt2 = this.add.bitmapText(44, 227, 'babyfont', this.endasArray[window.question_no][1], 36);

                var tl1=this.add.image(44,164-32,'t_l');
                tl1.alpha=0;
                var  tl2=this.add.image(44,227-32,'t_l');
                tl2.alpha=0;
                var tl3=this.add.image(44,290-32,'t_l');
                tl3.alpha=0;
                this.game.add.tween(tl1).to({x: 600+44,alpha:[1,1,1,1,0]}, 1000, Phaser.Easing.Quartic.Out, true, 200);
                this.game.add.tween(tl2).to({x: 620+44,alpha:[1,1,1,1,0]}, 1000, Phaser.Easing.Quartic.Out, true, 1000);
                this.game.add.tween(tl3).to({x: 600+44,alpha:[1,1,1,1,0]}, 1000, Phaser.Easing.Quartic.Out, true, 1800);
                
                this.mask1 = game.add.graphics(0, 0);
                this.mask1.beginFill(0xffffff);
                this.mask1.drawRect(44 - 600, 164, 600, 40);
                this.mask1.endFill();
                qt1.mask = this.mask1;

                this.mask2 = game.add.graphics(0, 0);
                this.mask2.beginFill(0xffffff);
                this.mask2.drawRect(44 - 620, 227, 620, 40);
                this.mask2.endFill();
                qt2.mask = this.mask2;
                

                game.add.tween(this.mask1).to({x: 600}, 1000, Phaser.Easing.Quartic.Out, true, 200);
                game.add.tween(this.mask2).to({x: 620}, 1000, Phaser.Easing.Quartic.Out, true, 1000);
                var qt3 = this.add.bitmapText(44, 290, 'babyfont', this.endasArray[window.question_no][2], 36);

                this.mask3 = game.add.graphics(0, 0);
                this.mask3.beginFill(0xffffff);
                this.mask3.drawRect(44 - 600, 290, 600, 40);
                this.mask3.endFill();
                qt3.mask = this.mask3;
                

                game.add.tween(this.mask3).to({x: 600}, 1000, Phaser.Easing.Quartic.Out, true, 1800);

            } else {

                var qt1 = this.add.bitmapText(44, 100, 'babyfont', this.endasArray[window.question_no][0], 36);
                var qt2 = this.add.bitmapText(44, 164, 'babyfont', this.endasArray[window.question_no][1], 36);
                var qt3 = this.add.bitmapText(44, 227, 'babyfont', this.endasArray[window.question_no][2], 36);

                var tl1=this.add.image(44,100-32,'t_l');
                tl1.alpha=0;
                var  tl2=this.add.image(44,164-32,'t_l');
                tl2.alpha=0;
                var tl3=this.add.image(44,227-32,'t_l');
                tl3.alpha=0;
                this.game.add.tween(tl1).to({x: 600+44,alpha:[1,1,1,1,0]}, 1000, Phaser.Easing.Quartic.Out, true, 200);
                this.game.add.tween(tl2).to({x: 620+44,alpha:[1,1,1,1,0]}, 1000, Phaser.Easing.Quartic.Out, true, 1000);
                this.game.add.tween(tl3).to({x: 600+44,alpha:[1,1,1,1,0]}, 1000, Phaser.Easing.Quartic.Out, true, 1800);



                this.mask1 = game.add.graphics(0, 0);
                this.mask1.beginFill(0xffffff);
                this.mask1.drawRect(44 - 600, 100, 600, 40);
                this.mask1.endFill();
                qt1.mask = this.mask1;

                this.mask2 = game.add.graphics(0, 0);
                this.mask2.beginFill(0xffffff);
                this.mask2.drawRect(44 - 600, 164, 600, 40);
                this.mask2.endFill();
                qt2.mask = this.mask2;

                this.mask3 = game.add.graphics(0, 0);
                this.mask3.beginFill(0xffffff);
                this.mask3.drawRect(44 - 600, 227, 600, 40);
                this.mask3.endFill();
                qt3.mask = this.mask3;

                game.add.tween(this.mask1).to({x: 600}, 1000, Phaser.Easing.Quartic.Out, true, 200);
                game.add.tween(this.mask2).to({x: 600}, 1000, Phaser.Easing.Quartic.Out, true, 1000);
                game.add.tween(this.mask3).to({x: 600}, 1000, Phaser.Easing.Quartic.Out, true, 1800);

            }

            //play audio
            //end
            // var qaudio = this.add.audio('e'+window.question_no);
            // document.getElementById("qaudio").addEventListener('ended',function () {
            //     alert("aaa");
            // },false);
            // var $enda=$("#enda");
            // var $e=$enda.find('.e'+window.question_no);
            
            var a1 = this.bvoice_sprite.play('startp');
            a1.onComplete.add(function () {
                this.bvoice_sprite.play('loopp');
            }, this);
            // $e[0].currentTime=0;
            // $e[0].play();
            // that.qaudio.seek(0);

            // qaudio.play();
            // var vaudio=$('#vend')[0];
            var eendedH=function () {
                that.bvoice_sprite.play('endp');
                var bvf = that.add.image(40, 54, 'vef');
                that.bvideo = new MovieClip(that, 40, 54, 670, 440, window.vendC, function () {

                    that.vaudio.pause();
                    that.vaudio.seek(0);
                    that.vaudio.play();
                    // that.vaudio.restart();
                    that.bvideo.playVideo();
                });
                video_bg.addChild(bvf);
                video_bg.addChild(that.bvideo);



                var c = game.add.tween(mask2).to({x: 750, y: 548}, 800, Phaser.Easing.Quartic.Out, true, 400);
                c.onComplete.add(function () {
                    that.vaudio.seek(0);
                    that.vaudio.play();
                    that.bvideo.playVideo();
                    that.renderLinkBtn();
                }, this);
                // $e.unbind('ended',eendedH);
            };
            // $e.bind('ended',eendedH);

            that.qaudio.once('end',eendedH);
            that.qaudio.play();

        },
        showAn: function () {
            var that=this;
            if (window.question_no != 5) {
                $("#video_wrapper").css("top", 380 / 1206 * window.innerHeight);
                var qt1 = this.add.bitmapText(44, 164, 'babyfont', this.endasArray[window.question_no][0], 36);
                var qt2 = this.add.bitmapText(44, 227, 'babyfont', this.endasArray[window.question_no][1], 36);
                this.mask1 = game.add.graphics(0, 0);
                this.mask1.beginFill(0xffffff);
                this.mask1.drawRect(44 - 600, 164, 600, 40);
                this.mask1.endFill();
                qt1.mask = this.mask1;

                this.mask2 = game.add.graphics(0, 0);
                this.mask2.beginFill(0xffffff);
                this.mask2.drawRect(44 - 620, 227, 620, 40);
                this.mask2.endFill();
                qt2.mask = this.mask2;

                var tl1=this.add.image(44,164-32,'t_l');
                tl1.alpha=0;
                var  tl2=this.add.image(44,227-32,'t_l');
                tl2.alpha=0;
                var tl3=this.add.image(44,290-32,'t_l');
                tl3.alpha=0;
                this.game.add.tween(tl1).to({x: 600+44,alpha:[1,1,1,1,0]}, 1000, Phaser.Easing.Quartic.Out, true, 200);
                this.game.add.tween(tl2).to({x: 620+44,alpha:[1,1,1,1,0]}, 1000, Phaser.Easing.Quartic.Out, true, 1000);
                this.game.add.tween(tl3).to({x: 600+44,alpha:[1,1,1,1,0]}, 1000, Phaser.Easing.Quartic.Out, true, 1800);

                game.add.tween(this.mask1).to({x: 600}, 1000, Phaser.Easing.Quartic.Out, true, 200);
                game.add.tween(this.mask2).to({x: 620}, 1000, Phaser.Easing.Quartic.Out, true, 1000);
                var qt3 = this.add.bitmapText(44, 290, 'babyfont', this.endasArray[window.question_no][2], 36);

                this.mask3 = game.add.graphics(0, 0);
                this.mask3.beginFill(0xffffff);
                this.mask3.drawRect(44 - 600, 290, 600, 40);
                this.mask3.endFill();
                qt3.mask = this.mask3;
                game.add.tween(this.mask3).to({x: 600}, 1000, Phaser.Easing.Quartic.Out, true, 1800);


                //play audio
                //end

                var $enda=$("#enda");
                var $e=$enda.find('.e'+window.question_no);
                
                var endedHandler = function() {
                    that.bvoice_sprite.play('endp');
                    that.renderVideoHtml();
                    $e.unbind('ended',endedHandler);
                };
                $e.bind('ended',endedHandler);
                // var qaudio = this.add.audio('e'+window.question_no);
                // document.getElementById("qaudio").addEventListener('ended',function () {
                //     alert("aaa");
                // },false);
                //play audio
                //end
                var a1 = this.bvoice_sprite.play('startp');
                a1.onComplete.add(function () {
                    this.bvoice_sprite.play('loopp');
                }, this);
                $e[0].play();
                // qaudio.play();
                // qaudio.onStop.add(function () {
                //
                // },this);


            } else {
                $("#video_wrapper").css("top", 381 / 1206 * window.innerHeight);
                var qt1 = this.add.bitmapText(44, 100, 'babyfont', this.endasArray[window.question_no][0], 36);
                var qt2 = this.add.bitmapText(44, 164, 'babyfont', this.endasArray[window.question_no][1], 36);
                var qt3 = this.add.bitmapText(44, 227, 'babyfont', this.endasArray[window.question_no][2], 36);


                var tl1=this.add.image(44,100-32,'t_l');
                tl1.alpha=0;
                var tl2=this.add.image(44,164-32,'t_l');
                tl2.alpha=0;
                var tl3=this.add.image(44,227-32,'t_l');
                tl3.alpha=0;



                this.mask1 = game.add.graphics(0, 0);
                this.mask1.beginFill(0xffffff);
                this.mask1.drawRect(44 - 600, 100, 600, 40);
                this.mask1.endFill();
                qt1.mask = this.mask1;

                this.mask2 = game.add.graphics(0, 0);
                this.mask2.beginFill(0xffffff);
                this.mask2.drawRect(44 - 600, 164, 600, 40);
                this.mask2.endFill();
                qt2.mask = this.mask2;

                this.mask3 = game.add.graphics(0, 0);
                this.mask3.beginFill(0xffffff);
                this.mask3.drawRect(44 - 600, 227, 600, 40);
                this.mask3.endFill();
                qt3.mask = this.mask3;

                this.game.add.tween(tl1).to({x: 600+44,alpha:[1,1,1,0]}, 1000, Phaser.Easing.Quartic.Out, true, 200);
                this.game.add.tween(tl2).to({x: 600+44,alpha:[1,1,1,0]}, 1000, Phaser.Easing.Quartic.Out, true, 1000);
                this.game.add.tween(tl3).to({x: 600+44,alpha:[1,1,1,0]}, 1000, Phaser.Easing.Quartic.Out, true, 1800);

                game.add.tween(this.mask1).to({x: 600}, 1000, Phaser.Easing.Quartic.Out, true, 200);
                game.add.tween(this.mask2).to({x: 600}, 1000, Phaser.Easing.Quartic.Out, true, 1000);
                game.add.tween(this.mask3).to({x: 600}, 1000, Phaser.Easing.Quartic.Out, true, 1800);
                //play audio
                //end

                var $enda=$("#enda");
                var $e=$enda.find('.e'+window.question_no);



                var endedHandler =function () {
                    that.bvoice_sprite.play('endp');
                    that.renderVideoHtml();
                    $e.unbind('ended',endedHandler);
                };
                $e.bind('ended',endedHandler);

                // var qaudio = this.add.audio('e'+window.question_no);
                // document.getElementById("qaudio").addEventListener('ended',function () {
                //     alert("aaa");
                // },false);
                //play audio
                //end
                var a1 = this.bvoice_sprite.play('startp');
                a1.onComplete.add(function () {
                    this.bvoice_sprite.play('loopp');
                }, this);

                $e[0].play();
                // qaudio.play();
                // qaudio.onStop.add(function () {
                //     this.bvoice_sprite.play('endp');
                //     this.renderVideoHtml();
                // },this);

            }

        },
        bind: function () {
            var that = this;
            var mvideo = document.getElementById("mvideo");

            function videoHandler() {
                // console.log("canplaythrough");
                window.haveloaded = true;
                mvideo.removeEventListener("canplaythrough", videoHandler);

            }

            mvideo.addEventListener("canplaythrough", videoHandler, false);
            $("#mvideo")[0].load();
        },
        renderLoadA: function () {
            var that = this;
            this.load.onLoadComplete.addOnce(function () {
                window.haveloaded = true;

            }, this);
            // this.load.audio('e'+window.question_no , 'assets/audio/e' + window.question_no + '.mp3');

            // this.load.audio('audio', 'assets/audio/audio' + window.question_no + '.mp3');
            this.load.image('vef', 'assets/video/end1.jpg');
            this.load.audio('vend', 'assets/audio/vend.mp3');
            window.vendC.preload();

            this.load.start();
        },
        renderLoad: function () {
            var that = this;
            this.load.onLoadComplete.addOnce(function () {
                $("#mvideo")[0].src = "./assets/video/end1.mp4";
                $("#mvideo")[0].poster = "./assets/video/end1.jpg";
                that.bind();
                // $("#mvideo")[0].play();
                // $("#mvideo")[0].pause();
                // window.haveloaded=true;
            }, this);
            this.load.audio('e'+window.question_no , 'assets/audio/e' + window.question_no + '.mp3');

            this.load.start();
        },
        renderLinkBtn: function () {
            var link_btn = this.add.sprite(375, 977, 'link_btn');
            link_btn.anchor.setTo(0.5);
            link_btn.alpha = 0;
            // link_btn.scale.setTo(1.5);

            game.add.tween(link_btn).to({alpha: 1}, 500, Phaser.Easing.Exponential.In, true, 400);
            game.add.tween(link_btn.scale).from({x: 1.5, y: 1.5}, 500, Phaser.Easing.Exponential.In, true, 400);
            link_btn.inputEnabled = true;
            link_btn.events.onInputDown.addOnce(function () {
                link_btn.alpha = 0.6;
            }, this);
            link_btn.events.onInputUp.addOnce(function () {
                window.location.href = "http://sc.qq.com/fx/u?r=HLIdzDA&t=9";
            }, this);

            game.add.tween(this.back_btn.scale).to({x: 1, y: 1}, 300, null, true, 1300);

        },
        renderVideo: function () {
            var video_group = this.add.group();

            var bg = video_group.create(375, 615, 'video_bg');
            bg.anchor.setTo(0.5);

            var evideo = video_group.create(375, 615, 'evideo');
            evideo.anchor.setTo(0.5);

            var c1 = game.add.tween(video_group).from({alpha: 0}, 1000, Phaser.Easing.Quartic.Out, true);

            var link_btn = this.add.sprite(375, 977, 'link_btn');
            link_btn.anchor.setTo(0.5);
            link_btn.alpha = 0;
            // link_btn.scale.setTo(1.5);

            game.add.tween(link_btn).to({alpha: 1}, 500, Phaser.Easing.Exponential.In, true, 400);
            game.add.tween(link_btn.scale).from({x: 1.5, y: 1.5}, 500, Phaser.Easing.Exponential.In, true, 400);
            link_btn.inputEnabled = true;
            link_btn.events.onInputDown.addOnce(function () {
                link_btn.alpha = 0.6;
            }, this);
            link_btn.events.onInputUp.addOnce(function () {
                window.location.href = "";
            }, this);


        }
    };
}());
},{"../entities/MovieClip":"/Users/sanchez/Sanchez/WORK/babysiri/src/js/entities/MovieClip.js"}],"/Users/sanchez/Sanchez/WORK/babysiri/src/js/states/game.js":[function(require,module,exports){
(function () {
    'use strict';


    var QuestionBtn = require('../entities/QuestionBtn');
    var Game = function () {
        this.qu1 = null;
        this.qu2 = null;
        this.qu3 = null;
        this.qu4 = null;
        this.qu5 = null;

    };

    module.exports = Game;

    Game.prototype = {
        create: function () {

            if(!window.haveclicked){
                if(!window.android||window.androidv){
                    var g1 = new Howl({
                        src: ['assets/audio/g1.mp3']
                    }).play();
                }else {
                    var $g1=$("#g1");
                    $g1[0].play();

                }

                // $g1.remove();
                // var g1=this.add.audio('g1');
                // g1.play();
            }
            if(!window.android||window.androidv){
                var err0 = new Howl({
                    src: ['assets/audio/err0.mp3']
                });
                var err1 = new Howl({
                    src: ['assets/audio/err1.mp3']
                });
                var err2 = new Howl({
                    src: ['assets/audio/err2.mp3']
                });
            }

            var errArray=[err1,err2,err0];
            var error1=this.add.image(0,0);
            error1.width=750;
            error1.height=220;
            var error2=this.add.image(0,220);
            error2.width=120;
            error2.height=1000;
            var error3=this.add.image(630,220);
            error3.width=120;
            error3.height=1000;

            error1.inputEnabled=true;
            error2.inputEnabled=true;
            error3.inputEnabled=true;
            var $err=$('#erra');
            var errorAudio=function () {
                var erand=Math.floor(Math.random()*3);
                if(!window.android||window.androidv){
                    errArray[erand].play();
                }else {

                    $err.find('.err'+erand)[0].play();
                }

            };
            
            error1.events.onInputDown.add(errorAudio,this);
            error2.events.onInputDown.add(errorAudio,this);
            error3.events.onInputDown.add(errorAudio,this);



            var game_title = this.add.sprite(375, 135, 'game_title');
            game_title.anchor.setTo(0.5);

            this.chooseQu();
            this.change_group = this.add.group();
            this.change_group.alpha = 0;
            this.change_btn = this.change_group.create(375, 1121, 'change_btn');
            this.change_btn.anchor.setTo(0.5);
            this.change_btn.animations.add('cbtn').play(15,true);
            this.change_btn.events.onInputDown.add(function () {
                this.change_btn.alpha=0.6;
            },this);
            this.change_btn.events.onInputUp.add(function () {
                this.change_btn.alpha=1;
                console.log("Change Qu");
                if(window.haveclicked)
                    window.havechanged = true;
                this.change_btn.inputEnabled = false;
                if (this.end_i != undefined) {
                    this.end_i.kill();
                }
                var c1 = this.add.tween(this.qu1.mquestion).to({x: 750 + 375}, 600, Phaser.Easing.Quartic.Out, true, 100);
                var c2 = this.add.tween(this.qu2.mquestion).to({x: -375}, 600, Phaser.Easing.Quartic.Out, true, 300);
                var c3 = this.add.tween(this.qu3.mquestion).to({x: 750 + 375}, 600, Phaser.Easing.Quartic.Out, true, 450);
                var c4 = this.add.tween(this.qu4.mquestion).to({x: -375}, 600, Phaser.Easing.Quartic.Out, true, 600);
                var c5 = this.add.tween(this.qu5.mquestion).to({x: 750 + 375}, 600, Phaser.Easing.Quartic.Out, true, 700);
                c5.onComplete.add(function () {
                    this.qu1.mdestroy();
                    this.qu2.mdestroy();
                    this.qu3.mdestroy();
                    this.qu4.mdestroy();
                    this.qu5.mdestroy();

                    if (window.quG >= 12) {
                        window.quG = 0;
                    } else {
                        window.quG += 4;
                    }


                    this.chooseQu();
                    this.enterQu();

                }, this);


            }, this);

            var btn_a3 = this.change_group.create(483, 1121, 'btn_arrow');
            btn_a3.anchor.setTo(0.5);
            var btn_a4 = this.change_group.create(497, 1121, 'btn_arrow');
            btn_a4.anchor.setTo(0.5);
            // btn_a4.alpha=0.5;

            var btn_a1 = this.change_group.create(242, 1121, 'btn_arrow');
            btn_a1.anchor.setTo(0.5);
            btn_a1.angle = 180;
            // btn_a1.alpha=0.5;
            var btn_a2 = this.change_group.create(256, 1121, 'btn_arrow');
            btn_a2.anchor.setTo(0.5);
            btn_a2.angle = 180;

            this.game.add.tween(btn_a3).to({alpha: 0}, 400, null, true, 0, -1, true);
            this.game.add.tween(btn_a2).to({alpha: 0}, 400, null, true, 0, -1, true);
            this.game.add.tween(btn_a4).to({alpha: 0}, 400, null, true, 400, -1, true);
            this.game.add.tween(btn_a1).to({alpha: 0}, 400, null, true, 400, -1, true);


            var c1 = this.add.tween(game_title).from({y: 600, alpha: 0}, 600, Phaser.Easing.Quartic.Out, true, 300);
            c1.onComplete.add(function () {
                this.enterQu();
            }, this);


        },
        chooseQu: function (f) {
            if (!window.haveclicked || !window.havechanged) {
               
                this.qu1 = new QuestionBtn(this.game, 0, 333, window.quG);
                this.qu2 = new QuestionBtn(this.game, 0, 481, window.quG + 1);
                this.qu3 = new QuestionBtn(this.game, 0, 481 + 148, window.quG + 2);
                this.qu4 = new QuestionBtn(this.game, 0, 481 + 148 + 148, window.quG + 3);
                this.qu5 = new QuestionBtn(this.game, 0, 481 + 148 + 148 + 148, window.quG + 4);

            } else {
                if (window.quG == 0) {


                    this.qu2 = new QuestionBtn(this.game, 0, 481, window.quG + 1);
                    this.qu4 = new QuestionBtn(this.game, 0, 481 + 148 + 148, window.quG+3);
                    this.qu5 = new QuestionBtn(this.game, 0, 481 + 148 + 148 + 148, window.quG + 4);


                    if(Math.random()>=0.5){
                        this.qu3 = new QuestionBtn(this.game, 0, 481 + 148, window.quG + 2);
                        this.qu1 = new QuestionBtn(this.game, 0, 333, 0, true);
                        this.end_i = this.add.sprite(375, 333-10, 'end_i');
                        this.end_i.x = 375 - this.qu1.mquestion._width / 2 - 50;

                    }else {
                        this.qu1 = new QuestionBtn(this.game, 0, 333, window.quG);
                        this.qu3 = new QuestionBtn(this.game, 0, 481 + 148, 2, true);
                        this.end_i = this.add.image(375, 481 + 148-10, 'end_i');
                        this.end_i.x = 375 - this.qu3.mquestion._width / 2 - 50;
                    }

                    this.end_i.anchor.setTo(0.5);
                    this.end_i.scale.setTo(0);
                }

                if (window.quG == 4) {
                    this.qu1 = new QuestionBtn(this.game, 0, 333, window.quG);
                    this.qu2 = new QuestionBtn(this.game, 0, 481, window.quG + 1);
                    this.qu3 = new QuestionBtn(this.game, 0, 481 + 148, window.quG + 2);

                    this.qu5 = new QuestionBtn(this.game, 0, 481 + 148 + 148 + 148, window.quG + 4);
                    
                    this.qu4 = new QuestionBtn(this.game, 0, 481 + 148 + 148, 3, true);

                    this.end_i = this.add.image(375, 481 + 148 + 148-10, 'end_i');
                    this.end_i.x = 375 - this.qu4.mquestion._width / 2 - 50;
                    this.end_i.anchor.setTo(0.5);
                    this.end_i.scale.setTo(0);



                }

                if (window.quG == 8) {
                    this.qu1 = new QuestionBtn(this.game, 0, 333, window.quG);

                    this.qu3 = new QuestionBtn(this.game, 0, 481 + 148, window.quG + 2);
                    this.qu4 = new QuestionBtn(this.game, 0, 481 + 148 + 148, window.quG + 3);
                    this.qu5 = new QuestionBtn(this.game, 0, 481 + 148 + 148 + 148, window.quG + 4);


                    this.qu2 = new QuestionBtn(this.game, 0, 481, 1, true);
                    this.end_i = this.add.image(375, 481-10, 'end_i');
                    this.end_i.x = 375 - this.qu2.mquestion._width / 2 - 50;
                    this.end_i.anchor.setTo(0.5);
                    this.end_i.scale.setTo(0);


                }

                if (window.quG == 12) {
                    this.qu1 = new QuestionBtn(this.game, 0, 333, window.quG);
                    this.qu2 = new QuestionBtn(this.game, 0, 481, window.quG + 1);
                    this.qu3 = new QuestionBtn(this.game, 0, 481 + 148, window.quG + 2);
                    this.qu4 = new QuestionBtn(this.game, 0, 481 + 148 + 148, window.quG + 3);



                    this.qu5 = new QuestionBtn(this.game, 0, 481 + 148 + 148 + 148, 4, true);
                    this.end_i = this.add.image(375, 481 + 148 + 148 + 148-10, 'end_i');
                    this.end_i.x = 375 - this.qu5.mquestion._width / 2 - 50;
                    this.end_i.anchor.setTo(0.5);
                    this.end_i.scale.setTo(0);


                }
                var e1 = this.add.tween(this.end_i.scale).to({x: 1, y: 1}, 200, null, true, 1500);
                e1.onComplete.add(function () {
                    var ea1 = this.add.tween(this.end_i).to({angle: [-15, 15]}, 333, null, true, 0, -1, true);
                    var ea2 = this.add.tween(this.end_i.scale).to({x: 1.5, y: 1.5}, 333, null, true, 0, -1, true);
                    // ea1.repeatDelay(400);
                    // ea2.repeatDelay(400);
                }, this);
                this.end_i.animations.add('end_i').play(3,true);

            }


        },
        enterQu: function () {
            var c1 = this.add.tween(this.qu1.mquestion).to({x: 375}, 600, Phaser.Easing.Quartic.Out, true, 100);
            var c2 = this.add.tween(this.qu2.mquestion).to({x: 375}, 600, Phaser.Easing.Quartic.Out, true, 300);
            var c3 = this.add.tween(this.qu3.mquestion).to({x: 375}, 600, Phaser.Easing.Quartic.Out, true, 450);
            var c4 = this.add.tween(this.qu4.mquestion).to({x: 375}, 600, Phaser.Easing.Quartic.Out, true, 600);
            var c5 = this.add.tween(this.qu5.mquestion).to({x: 375}, 600, Phaser.Easing.Quartic.Out, true, 700);

            c5.onComplete.add(function () {
                this.add.tween(this.change_group).to({alpha: 1}, 500, Phaser.Easing.Bounce.Out, true);
                this.change_btn.inputEnabled = true;
            }, this)
        }
    };
}());
      
},{"../entities/QuestionBtn":"/Users/sanchez/Sanchez/WORK/babysiri/src/js/entities/QuestionBtn.js"}],"/Users/sanchez/Sanchez/WORK/babysiri/src/js/states/home.js":[function(require,module,exports){
/**
 * Created by sanchez on 16/6/15.
 */
(function () {
    'use strict';

    var Home = function () {
        if(!window.android){
            this.txtArray = "你好，我是Siri，-刚来到安卓的世界，有有有点不兼容，-这这个世界对于我来说还很陌陌陌生，-不如我们从零开始，一起探探索吧！"

        }else {
            this.txtArray = "咳咳咳，让你久等了，对不起！-初次见面，我是Siri！-虽然现在我老了，但是脑子还很好使，-可不像金鱼那么健忘！-我小时候更厉害，我给你讲讲啊！-嗯，刚才说到哪了.....";
        }

    };
    module.exports = Home;
    Home.prototype = {
        create: function () {
            var that=this;


            this.txt_1 = this.add.text(47, 100, '', {font: '40px Arial', fill: '#fff', align: 'left'});
            this.txt_1.lineSpacing = 20;
            this.txt_num = 0;
            if(!window.android){
                this.txt_2 = this.add.text(47, 400, 'Siri正在回退到最初版本… …', {font: '40px Arial', fill: '#fff', align: 'left'});
            }else {
                this.txt_2 = this.add.text(47, 400, '时光倒流中… …', {font: '40px Arial', fill: '#fff', align: 'left'});
            }

            this.txt_2.alpha = 0;

            this.voice_sprite = this.add.sprite(375, 1206, 'voice_sprite');
            this.voice_sprite.anchor.setTo(0.5,1);
            this.voice_sprite.frame=0;

            this.actsiri = this.add.image(375, 1106, 'actsiri');
            this.actsiri.anchor.setTo(0.5);
            this.actsiri.scale.setTo(0);
            this.actsiri.inputEnabled = true;
            this.actsiri.events.onInputDown.addOnce(this.goBack, this);
            this.actsiri.events.onInputUp.addOnce(function () {
                this.actsiri.alpha=0;
            }, this);

            // var t1 = this.add.text(this.game.width * 0.5, this.game.height * 0.5,
            //     '对', {font: '42px Arial', fill: '#ffffff', align: 'center'
            //     });
            // t1.anchor.set(0.5);
            // var t2 = this.add.text(this.game.width * 0.5+42, this.game.height * 0.5,
            //     '不', {font: '42px Arial', fill: '#ffffff', align: 'center'
            //     });
            // t2.anchor.set(0.5);
            // var t3 = this.add.text(this.game.width * 0.5+42+42, this.game.height * 0.5,
            //     '起', {font: '42px Arial', fill: '#ffffff', align: 'center'
            //     });
            // t3.anchor.set(0.5);
            //

            // var c1 = game.add.tween(t1).from( { x: this.game.width*Math.random()/2,y:this.game.height*Math.random()/2,alpha:0}, 1000, Phaser.Easing.Quartic.Out,true);
            // var c2= game.add.tween(t2).from( { x: this.game.width*Math.random()/2,y:this.game.height*Math.random()/2,alpha:0}, 1000, Phaser.Easing.Quartic.Out,true,500);

            // c1.chain(c2);
            // c1.start();

            // this.renderClock();

            this.voice_sprite.animations.add('startp',[0,1,2,3,4,5,6,7],15,false);
            this.voice_sprite.animations.add('loopp',[8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27],15,true);
            this.voice_sprite.animations.add('endp',[7,6,5,4,3,2,1,0],15,false);


            // this.renderBaby();
            var a1=this.voice_sprite.play('startp');
            a1.onComplete.add(function () {
                this.voice_sprite.play('loopp');
            },this);
            var $haudio=$("#haudio");

            if(!window.android){
                // var haudio1=document.getElementById("haudioa1");

                // $haudio.find(".haudioa1")[0].play();
                that.haudio1a = new Howl({
                    src: ['assets/audio/haudioa1.mp3']
                });
                that.didia = new Howl({
                    src: ['assets/audio/didia.mp3']
                });
                that.home1 = new Howl({
                    src: ['assets/audio/h1.mp3']
                });
                that.haudio1a.play();

            }else {
                // var haudio1=document.getElementById("haudio1");
                // var $haudio= $("#haudio1")[0];
                if(window.androidv){
                    that.haudio2 = new Howl({
                        src: ['assets/audio/haudio2.mp3']
                        // loop:true
                    });
                    that.didi = new Howl({
                        src: ['assets/audio/didi.mp3']
                    });
                    that.home_audio = new Howl({
                        src: ['assets/audio/h1.mp3']
                    });
                    that.haudio1 = new Howl({
                        src: ['assets/audio/haudio1.mp3'],
                        onend:function () {
                            that.game.time.events.add(300, function () {
                                that.haudio2.play();
                            },this);
                        }
                    });
                    that.haudio1.play();


                }else {
                    $haudio.find('.haudio1').bind('ended',function () {
                        that.game.time.events.add(300, function () {
                            $haudio.find('.haudio2')[0].play();
                        },this);
                    });

                    // haudio1.addEventListener('ended',function () {
                    //
                    // },false);
                    $haudio.find('.haudio1')[0].play();
                }




            }

            if(!window.android){
                this.game.time.events.repeat(180,this.txtArray.length-3,  this.addText, this);
            }else {
           
                this.game.time.events.repeat(80,this.txtArray.length-5,  this.addText, this);

                //longtime
                this.longtime=this.game.time.events.add(20000, function () {
                    console.log('long time');
                    this.voice_sprite.kill();
                    // this.game.add.tween( this.voice_sprite.scale).to({x: 0,y:0}, 1000, Phaser.Easing.Quartic.Out, true, 300);
                    var ae=this.game.add.tween( this.actsiri.scale).to({x: 1,y:1}, 1000, Phaser.Easing.Bounce.Out, true, 300);
                    ae.onComplete.add(function () {
                        var ea1 = this.add.tween(this.actsiri).to({angle: [0,-5,0,5,0]}, 200, null, true, 300, -1, true);
                        var ea2 = this.add.tween(this.actsiri.scale).to({x: 1.2, y: 1.2}, 200, null, true, 300, -1, true);
                        ea1.repeatDelay(1000);
                        ea2.repeatDelay(1000);
                        // this.game.time.events.add(1000, function () {
                        //     that.actsiri.inputEnabled=false;
                        //     that.actsiri.kill();
                        //     that.goBack();
                        //
                        // },this)
                    },this);
                },this);


            }


            // this.input.onDown.add(this.onDown, this);
        },
        goBack: function () {
            var that = this;
            if(that.longtime!=undefined){
                game.time.events.remove(that.longtime);
            }


            this.actsiri.alpha = 0.8;
            var $haudio=$("#haudio");
            if(!window.android){
                // $haudio.find(".haudioa1")[0].pause();
                // $haudio.find(".haudioa1").remove();
                that.haudio1a.pause();
                that.didia.play();
                // $haudio.find(".didia")[0].play();
            }else {
                if(window.androidv){
                    console.log('av');
                    that.haudio2.pause();
                    that.didi.play();
                }else {
                    $haudio.find(".haudio2")[0].pause();
                    $haudio.find(".haudio2").remove();
                    $haudio.find(".didi")[0].play();
                }

            }


            this.game.add.tween(that.txt_1).to({alpha: 0, y: -250}, 600, Phaser.Easing.Cubic.Out, true);
            this.game.add.tween(that.txt_2).to({alpha: 1, y: 100}, 600, Phaser.Easing.Cubic.Out, true, 300);
            if(!window.android){
                this.game.time.events.repeat(170,16,this.delText, this);

            }else {
                this.game.time.events.repeat(450,8,this.delText, this);
            }


            this.renderClock();


            // this.game.time.events.repeat(200, 1000, function () {
            //
            // }, this);

        },
        renderClock: function () {
            var that = this;
            this.clock_group = this.add.group();
            // clock_group.anchor.setTo(0.5);
            var clock_sprite = this.clock_group.create(375, 601, 'clock_sprite');
            clock_sprite.anchor.setTo(0.5);
            var hourhand = this.clock_group.create(375, 601, 'hourhand');
            hourhand.anchor.setTo(0.5, 1);
            var secondhand = this.clock_group.create(375, 601, 'secondhand');
            secondhand.anchor.setTo(0, 0.5);

            var c1 = this.game.add.tween(hourhand).to({angle: -360}, 8000, Phaser.Easing.Quartic.In, true, 0, 0);
            this.game.add.tween(secondhand).to({angle: -360*10*24}, 8000, Phaser.Easing.Quartic.In, true, 0);
            // c1.onComplete.add(function () {
            //
            //     // that.clock_group.alpha = 0;
            //
            //
            //     // this.game.state.start('Game');
            // }, this);

            this.game.add.tween(this.clock_group).to({alpha: 0}, 4000, Phaser.Easing.Quartic.In, true);
            this.game.add.tween(this.voice_sprite).to({alpha: 0}, 3000, null, true);
            document.getElementById("bg2").style.display='block';
            TweenMax.to(document.getElementById("bg2"), 5, {opacity: 1, top: 0,ease:Expo.easeIn,onComplete:function () {
                that.renderBaby();
                // if(window.android){
                //     document.getElementById("bg2").style.display='none';
                //     document.getElementById("bg2").style.display='none';
                //     $("#cz")[0].play();
                // }
            }});

        },
        renderBaby: function () {

            this.babytxt1 = this.add.bitmapText(44, 98, 'babyfont', '你好，我是baby Siri，现在有什么', 36);
            this.babytxt2 = this.add.bitmapText(44, 158, 'babyfont', '问题想问我吗？虽然我还小，但我', 36);
            this.babytxt3 = this.add.bitmapText(44, 218, 'babyfont', '知道的可不少哦！', 36);



            this.mask1 = game.add.graphics(0, 0);
            this.mask1.beginFill(0xffffff);
            this.mask1.drawRect(44-538, 98, 538,40);
            this.mask1.endFill();
            this.babytxt1.mask=this.mask1;

            this.mask2 = game.add.graphics(0, 0);
            this.mask2.beginFill(0xffffff);
            this.mask2.drawRect(44-538, 158, 538,40);
            this.mask2.endFill();
            this.babytxt2.mask=this.mask2;

            this.mask3 = game.add.graphics(0, 0);
            this.mask3.beginFill(0xffffff);
            this.mask3.drawRect(44-538, 218, 538,40);
            this.mask3.endFill();
            this.babytxt3.mask=this.mask3;

            this.bvoice_sprite = this.add.sprite(375, 1206, 'bvoice_sprite');
            this.bvoice_sprite.anchor.setTo(0.5,1);

            this.bvoice_sprite.animations.add('startp',[0,1,2,3,4,5,6,7],15,false);
            this.bvoice_sprite.animations.add('loopp',[8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27],15,true);
            this.bvoice_sprite.animations.add('endp',[7,6,5,4,3,2,1,0],15,false);

            this.renderTxtMask();
            this.voice_sprite.kill();


            //play audio
            //end



        },
        renderTxtMask:function () {
            var that=this;
            var a1= this.bvoice_sprite.play('startp');
            a1.onComplete.add(function () {
                this.bvoice_sprite.play('loopp');
            },this);

            // var h1=this.add.audio('h1');
            if(!window.android){
                that.home1.play();
                that.home1.on('end',function () {
                    var endanim=that.bvoice_sprite.play('endp');
                    endanim.onComplete.add(function () {
                        that.game.state.start('Game');
                    },this);
                });

            }else {
                if(window.androidv){
                    that.home_audio.on('end',function () {
                        var endanim=that.bvoice_sprite.play('endp');
                        endanim.onComplete.add(function () {
                            that.game.state.start('Game');
                        },this);
                    })
                    that.home_audio.play();
                }else {
                    var home1=$("#home1");
                    home1[0].play();
                    home1.bind('ended',function () {
                        var endanim=that.bvoice_sprite.play('endp');
                        endanim.onComplete.add(function () {
                            that.game.state.start('Game');
                        },this);
                    });
                }

            }

            //longtime
            that.longtime=this.game.time.events.add(20000, function () {
                that.game.state.start('Game');
            },this);


            // $h1.onStop.add(function () {
            //
            //
            // },this);

            this.tl1=this.add.image(44,98-35,'t_l');
            this.tl1.alpha=0;
            this.tl2=this.add.image(44,158-35,'t_l');
            this.tl2.alpha=0;
            this.tl3=this.add.image(44,228-35,'t_l');
            this.tl3.alpha=0;

            this.game.add.tween(this.tl1).to({x: 538+44,alpha:[1,0]}, 1000, Phaser.Easing.Quartic.Out, true, 300);
            this.game.add.tween(this.tl2).to({x: 538+44,alpha:[1,0]}, 1000, Phaser.Easing.Quartic.Out, true, 1000);
            this.game.add.tween(this.tl3).to({x: 538+44,alpha:[1,0]}, 1000, Phaser.Easing.Quartic.Out, true, 1800);

            this.game.add.tween(this.mask1).to({x: 538}, 1000, Phaser.Easing.Quartic.Out, true, 300);
            this.game.add.tween(this.mask2).to({x: 538}, 1000, Phaser.Easing.Quartic.Out, true, 1000);
            var c=this.game.add.tween(this.mask3).to({x: 538}, 1000, Phaser.Easing.Quartic.Out, true, 1800);


        },
        delText:function () {
            var txt_bf = this.txt_2.text;
            txt_bf=txt_bf.substring(0,txt_bf.length-1);
            this.txt_2.text=txt_bf;


        },
        addText: function () {
            var that=this;
            var txt_bf = this.txt_1.text;

            if ((this.txtArray[this.txt_num]=='-')&&(this.txt_num!=0)) {
                this.txt_num++;
                this.txt_1.text = txt_bf + '\n' + this.txtArray[this.txt_num];
            } else {
                this.txt_1.text = txt_bf + this.txtArray[this.txt_num];
            }
            this.txt_num++;
            if (this.txt_num == this.txtArray.length - 1) {
                this.voice_sprite.play('endp');
                // this.game.add.tween( this.voice_sprite.scale).to({x: 0,y:0}, 1000, Phaser.Easing.Quartic.Out, true, 300);
                var ae=this.game.add.tween( this.actsiri.scale).to({x: 1,y:1}, 1000, Phaser.Easing.Bounce.Out, true, 300);
                ae.onComplete.add(function () {
                    
                    if(that.longtime!=undefined){
                        game.time.events.remove(that.longtime);
                    }

                    var ea1 = this.add.tween(this.actsiri).to({angle: [0,-5,0,5,0]}, 200, null, true, 300, -1, true);
                    var ea2 = this.add.tween(this.actsiri.scale).to({x: 1.2, y: 1.2}, 200, null, true, 300, -1, true);
                    ea1.repeatDelay(1000);
                    ea2.repeatDelay(1000);
                    // this.game.time.events.add(1000, function () {
                    //     that.actsiri.inputEnabled=false;
                    //     that.actsiri.kill();
                    //     that.goBack();
                    //
                    // },this)
                },this);


            }

        },

        update: function () {

        },

        onDown: function () {
            // this.game.state.start('Mgame');
        }
    };

}());
},{}],"/Users/sanchez/Sanchez/WORK/babysiri/src/js/states/mname.js":[function(require,module,exports){
/**
 * Created by sanchez on 16/6/20.
 */
(function () {
    'use strict';

    var Mname = function () {

    };

    module.exports = Mname;

    Mname.prototype = {
        renderLoad: function () {
            var that = this;
            this.load.onLoadComplete.addOnce(function () {
                window.haveloaded = true;
            }, this);

            this.load.audio('q0', 'assets/audio/q0.mp3');
            this.load.audio('q0_1', 'assets/audio/q0_1.mp3');
            this.load.start();

        },
        create: function () {
            var that=this;
            this.bvoice_sprite = this.add.sprite(375, 1206, 'bvoice_sprite');
            this.bvoice_sprite.anchor.setTo(0.5, 1);
            this.bvoice_sprite.animations.add('startp', [0, 1, 2, 3, 4, 5, 6, 7], 15, false);
            this.bvoice_sprite.animations.add('loopp', [8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27], 15, true);
            this.bvoice_sprite.animations.add('endp', [7, 6, 5, 4, 3, 2, 1, 0], 15, false);


            this.back_btn = this.add.sprite(375, 1106, 'back_btn');
            this.back_btn.anchor.setTo(0.5);
            this.back_btn.scale.setTo(0);
            this.back_btn.inputEnabled = true;
            this.back_btn.events.onInputDown.addOnce(function () {
                this.back_btn.alpha = 0.6;
            }, this);
            this.back_btn.events.onInputUp.addOnce(function () {
                $("#name_wrapper").css("display", "none");

                $(".name_success").removeClass("name_s1").addClass("name_s2");
                this.game.state.start('Game');
            }, this);

            if(!window.android||window.androidv){
                if(window.havenamed){
                    that.qname = new Howl({
                        src: ['assets/audio/q0_1.mp3']
                    });
                }else {
                    that.qname = new Howl({
                        src: ['assets/audio/q0.mp3']
                    });
                }
            }

            if (!window.havenamed) {
                this.renderInput();
                this.babytxt1 = this.add.bitmapText(44, 166, 'babyfont', '我叫Baby Siri，', 36);
                this.babytxt2 = this.add.bitmapText(44, 226, 'babyfont', '你来给我取一个更好听的名字吧', 36);
            } else {
                this.babytxt1 = this.add.bitmapText(44, 166, 'babyfont', '我的名字可是你取的哦，', 36);
                this.babytxt2 = this.add.bitmapText(44, 226, 'babyfont', '不记得了吗？', 36);
            }
            this.mask1 = game.add.graphics(0, 0);
            this.mask1.beginFill(0xffffff);
            this.mask1.drawRect(44 - 538, 166, 538, 40);
            this.mask1.endFill();
            this.babytxt1.mask = this.mask1;

            this.mask2 = game.add.graphics(0, 0);
            this.mask2.beginFill(0xffffff);
            this.mask2.drawRect(44 - 538, 226, 538, 40);
            this.mask2.endFill();
            this.babytxt2.mask = this.mask2;
            //play audio
            //end
            var t2 = this.add.bitmapText(733, 63, 'babyfont', '“你叫什么名字”', 36);
            t2.anchor.setTo(1, 0);
            var c1 = game.add.tween(t2).from({
                x: 750 + 200,
                alpha: 0
            }, 1000, Phaser.Easing.Bounce.Out, true, 20);
            c1.onComplete.add(function () {
                this.qloader = this.add.sprite(122, 180, 'qloader');
                this.qloader.anchor.setTo(0.5);
                this.qloader.scale.setTo(0.5);
                this.ql_aim = this.qloader.animations.add('ql', [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]);
                this.ql_aim.play(17, true);
                this.renderLoad();
                // this.renderTxtMask();
            }, this);

        },
        update: function () {
            if (window.haveloaded) {
                window.haveloaded = false;
                this.ql_aim.stop();
                // this.ql_aim.play(17, false);
                this.qloader.kill();
                if(!window.android||window.androidv){
                    this.renderTxtMaskA();
                }else {
                    this.renderTxtMask();
                }


            }

        },
        renderTxtMaskA:function () {
            var that = this;


            var a1 = this.bvoice_sprite.play('startp');
            a1.onComplete.add(function () {
                this.bvoice_sprite.play('loopp');
            }, this);


            var tl1 = this.add.image(44, 166 - 35, 't_l');
            tl1.alpha = 0;
            var tl2 = this.add.image(44, 226 - 35, 't_l');
            tl2.alpha = 0;

            this.game.add.tween(tl1).to({x: 538 + 44, alpha: [1, 0, 0]}, 1500, Phaser.Easing.Quartic.Out, true, 300);
            this.game.add.tween(tl2).to({
                x: 538 + 44,
                alpha: [1, 1, 1, 1, 1, 0]
            }, 1500, Phaser.Easing.Quartic.Out, true, 1800);

            this.game.add.tween(this.mask1).to({x: 538}, 1500, Phaser.Easing.Quartic.Out, true, 300);
            var c = this.game.add.tween(this.mask2).to({x: 538}, 1500, Phaser.Easing.Quartic.Out, true, 1800);
            // this.game.add.tween(this.mask3).to({x: 538}, 500, Phaser.Easing.Quartic.Out, true, 900);

            function endedHandler() {
                that.bvoice_sprite.play('endp');
                // var name_wrapper = document.getElementById("name_wrapper");
                var name_wrapper = $("#name_wrapper");
                name_wrapper.css({"display": "block",height:0});
                TweenMax.to(name_wrapper, 0.8, {height: 388,onComplete:function () {
                    game.add.tween(that.back_btn.scale).to({
                        x: 1,
                        y: 1
                    }, 800, Phaser.Easing.Quartic.Out, true, 1000).onComplete.add(function () {
                        var ea2 = that.add.tween(that.back_btn.scale).to({
                            x: 1.5,
                            y: 1.5
                        }, 1000, Phaser.Easing.Bounce.Out, true, 300, -1, true);
                        ea2.repeatDelay(1500);
                    }, this);
                }});
            }
            that.qname.once('end',endedHandler);
            that.qname.play();
        },
        renderTxtMask: function () {
            var that = this;


            var a1 = this.bvoice_sprite.play('startp');
            a1.onComplete.add(function () {
                this.bvoice_sprite.play('loopp');
            }, this);


            var tl1 = this.add.image(44, 166 - 35, 't_l');
            tl1.alpha = 0;
            var tl2 = this.add.image(44, 226 - 35, 't_l');
            tl2.alpha = 0;

            this.game.add.tween(tl1).to({x: 538 + 44, alpha: [1, 0, 0]}, 1500, Phaser.Easing.Quartic.Out, true, 300);
            this.game.add.tween(tl2).to({
                x: 538 + 44,
                alpha: [1, 1, 1, 1, 1, 0]
            }, 1500, Phaser.Easing.Quartic.Out, true, 1800);

            this.game.add.tween(this.mask1).to({x: 538}, 1500, Phaser.Easing.Quartic.Out, true, 300);
            var c = this.game.add.tween(this.mask2).to({x: 538}, 1500, Phaser.Easing.Quartic.Out, true, 1800);
            // this.game.add.tween(this.mask3).to({x: 538}, 500, Phaser.Easing.Quartic.Out, true, 900);

            var $qaudio = $("#qaudio");
            if (window.havenamed) {
                var q0 = $qaudio.find('.q0_1')

            } else {
                var q0 = $qaudio.find('.q0')
            }


            function endedHandler() {
                that.bvoice_sprite.play('endp');
                // var name_wrapper = document.getElementById("name_wrapper");
                var name_wrapper = $("#name_wrapper");
                name_wrapper.css({"display": "block",height:0});
                TweenMax.to(name_wrapper, 0.8, {height: 388,onComplete:function () {
                    game.add.tween(that.back_btn.scale).to({
                        x: 1,
                        y: 1
                    }, 800, Phaser.Easing.Quartic.Out, true, 1000).onComplete.add(function () {
                        var ea2 = that.add.tween(that.back_btn.scale).to({
                            x: 1.5,
                            y: 1.5
                        }, 1000, Phaser.Easing.Bounce.Out, true, 300, -1, true);
                        ea2.repeatDelay(1500);
                    }, this);
                }});
                q0.unbind('ended',endedHandler);
            }

            q0.bind('ended',endedHandler);

            q0[0].play();


        },
        renderTips: function (msg, during) {
            var $win = $("#p_tips");
            clearTimeout($win.attr("timeid"));
            $win.html(msg);
            $win.fadeIn(500);
            if (!!during) {
                $win.attr("timeid", setTimeout(function () {
                    $win.fadeOut(500);
                }, during));
            }
        },
        renderInput: function () {
            var that = this;
            $("#name_btn").on("click", function () {
                // console.log("ck")
                if ($(this).hasClass("besubmit")) {
                    return;
                }
                var _siriname = $("#siriname").val();

                if ($.trim(_siriname) == "") {
                    that.renderTips("名字空空~", 1500);
                    $("#siriname").focus();
                    return;
                }
                if (!that.isName(_siriname)) {
                    that.renderTips("名字太low了", 1500);
                    $("#siriname").focus();
                    return;
                }

                $("#submit_btn").addClass("besubmit");
                $(".input_wrapper").find("input")[0].readOnly = true;

                window.havenamed = true;
                window.siriname = _siriname;

                var share_txt = "我的baby版siri名叫" + window.siriname + "，你的呢？";

                window.share.set('timeline', 'title', share_txt);
                window.share.set('appmessage', 'title', "Hello World");
                window.share.set('appmessage', 'desc', share_txt);

                var $name_txt = $("#name_txt");
                $name_txt.html(window.siriname);
                $(".name_content1").css("display", "none");
                $(".name_content2").css("display", "block");

                that.game.add.tween(that.back_btn.scale).to({
                    x: 1,
                    y: 1
                }, 800, Phaser.Easing.Quartic.Out, true).onComplete.add(function () {
                    var ea2 = that.add.tween(that.back_btn.scale).to({
                        x: 1.5,
                        y: 1.5
                    }, 1000, Phaser.Easing.Bounce.Out, true, 300, -1, true);
                    ea2.repeatDelay(1500);

                }, this);

            });
            // this.add.sprite
            // var content_bg=this.add.image(375,522,'content_bg');
            // content_bg.anchor.setTo(0.5);
        },
        isName: function (inputString) {
            var partten = /^[\u4e00-\u9fa5_a-zA-Z0-9]+$/;
            if (partten.test(inputString)) {
                return true;
            }
            else {
                return false;
            }

        }
    };
}());
},{}],"/Users/sanchez/Sanchez/WORK/babysiri/src/js/states/mvideo.js":[function(require,module,exports){
/**
 * Created by sanchez on 16/6/16.
 */
(function () {
    'use strict';
    var MovieClip = require('../entities/MovieClip');
    var Mvideo = function () {
        this.bvideo = null;

    };

    module.exports = Mvideo;

    Mvideo.prototype = {
        create: function () {
            var that = this;
            window.end_n = 0;
            this.bvoice_sprite = this.add.sprite(375, 1206, 'bvoice_sprite');
            this.bvoice_sprite.anchor.setTo(0.5, 1);
            this.bvoice_sprite.anchor.setTo(0.5, 1);
            this.bvoice_sprite.animations.add('startp', [0, 1, 2, 3, 4, 5, 6, 7], 15, false);
            this.bvoice_sprite.animations.add('loopp', [8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27], 15, true);
            this.bvoice_sprite.animations.add('endp', [7, 6, 5, 4, 3, 2, 1, 0], 15, false);


            this.back_btn = this.add.sprite(375, 1106, 'back_btn');
            this.back_btn.anchor.setTo(0.5);
            this.back_btn.scale.setTo(0);
            this.back_btn.inputEnabled = true;
            this.back_btn.events.onInputDown.addOnce(function () {
                this.back_btn.alpha = 0.6;
            }, this);
            this.back_btn.events.onInputUp.addOnce(function () {

                if (!window.android||window.androidv) {
                    // var mvd=$("#vaudio")[0];
                    // mvd.pause();
                    // $("#vaudio").find(".bv"+window.question_no)[0].pause();
                    that.$bv.pause();
                    // mvd.src = "";
                } else {
                    var mvideo = $("#mvideo")[0];
                    mvideo.pause();
                    mvideo.src = "";
                    mvideo.poster = "";
                    $("#video_wrapper").css({
                        "display": "none",
                        "width": 0,
                        "height": 0,
                        "top": 300 / 1206 * window.innerHeight
                    });
                }
                this.game.state.start('Game');


            }, this);
            this.back_btn.bringToTop();

            if (window.question_no == undefined) {
                window.question_no = 15;
            }

            var t2 = this.add.bitmapText(733, 63, 'babyfont', '“' + window.quArray[window.question_no] + '”', 36);
            t2.anchor.setTo(1, 0);
            var c1 = game.add.tween(t2).from({
                x: 750 + 200,
                alpha: 0
            }, 800, Phaser.Easing.Bounce.Out, true, 20);


            // var c2= game.add.tween(t2).from( { x: 200*Math.random(),y:200*Math.random(),alpha:0}, 1000, Phaser.Easing.Quartic.Out,true,500);

            c1.onComplete.add(function () {
                this.qloader = this.add.sprite(122, 180, 'qloader');
                this.qloader.anchor.setTo(0.5);
                this.qloader.scale.setTo(0.5);

                this.qloader.anchor.setTo(0.5);


                this.ql_aim = this.qloader.animations.add('ql', [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]);
                this.ql_aim.play(17, true);
                if (!window.android||window.androidv) {
                    this.renderLoadA();
                } else {
                    this.renderLoad();
                }

            }, this)
        },
        update: function () {
            if (window.haveloaded) {
                window.haveloaded = false;
                this.ql_aim.stop();
                // this.ql_aim.play(17, false);
                this.qloader.kill();
                if (!window.android||window.androidv) {
                    this.showAnA();

                } else {
                    this.showAn();
                }

            }

        },
        showAnA: function () {
            var that = this;

            // var $vaudio=$("#vaudio");
            // var $bv=$vaudio.find('.bv'+ window.question_no);
            this.$bv = new Howl({
                src: ['assets/audio/bv'+window.question_no+'.mp3']
            });

            if (window.asArray[window.question_no] == null) {
                var video_bg = this.add.image(0, 168, 'video_bg');

                var mask2 = game.add.graphics(0, 0);
                mask2.beginFill(0xffffff);
                mask2.drawRect(0 - 750, 168 - 548, 750, 548);
                mask2.endFill();
                video_bg.mask = mask2;

                var bvf = this.add.image(40, 54, 'bvf' + window.question_no);
                this.bvideo = new MovieClip(this, 40, 54, 670, 440, window.bvConfigArray[window.question_no], function () {
                    that.$bv.pause();
                    // $bv[0].currentTime=0;
                    that.$bv.seek(0);
                    that.$bv.play();
                    // that.vaudio.restart();
                    that.bvideo.playVideo();
                });
                video_bg.addChild(bvf);
                video_bg.addChild(this.bvideo);


                var c = game.add.tween(mask2).to({x: 750, y: 548}, 800, Phaser.Easing.Quartic.Out, true, 400);
                c.onComplete.add(function () {
                    // $bv.currentTime=0;
                    this.$bv.seek(0);
                    this.$bv.play();
                    this.bvideo.playVideo();
                    game.add.tween(that.back_btn.scale).to({x: 1, y: 1}, 800, Phaser.Easing.Bounce.Out, true).onComplete.add(function () {
                        var ea2 = that.add.tween(that.back_btn.scale).to({x: 1.5, y: 1.5}, 1000, Phaser.Easing.Bounce.Out, true, 300, -1,true);
                        ea2.repeatDelay(1500);
                    },this);
                }, this);

            } else {
                var video_bg = this.add.image(0, 245, 'video_bg');

                var mask2 = game.add.graphics(0, 0);
                mask2.beginFill(0xffffff);
                mask2.drawRect(0 - 750, 245 - 548, 750, 548);
                mask2.endFill();
                video_bg.mask = mask2;

                var a1 = this.bvoice_sprite.play('startp');
                a1.onComplete.add(function () {
                    this.bvoice_sprite.play('loopp');
                }, this);
                var qt1 = this.add.bitmapText(44, 164, 'babyfont', window.asArray[window.question_no], 36);

                this.mask1 = game.add.graphics(0, 0);
                this.mask1.beginFill(0xffffff);
                this.mask1.drawRect(44 - 600, 164, 600, 40);
                this.mask1.endFill();
                qt1.mask = this.mask1;

                var tl1 = this.add.image(44, 164 - 28, 't_l');
                tl1.alpha = 0;
                this.game.add.tween(tl1).to({
                    x: 600 + 44,
                    alpha: [1, 1, 1, 1, 0]
                }, 1000, Phaser.Easing.Quartic.Out, true, 200);


                game.add.tween(this.mask1).to({x: 600}, 1000, Phaser.Easing.Quartic.Out, true, 200);
                //play audio
                //end





                var a1 = this.bvoice_sprite.play('startp');
                a1.onComplete.add(function () {
                    this.bvoice_sprite.play('loopp');
                }, this);
                // qaudio.play();
                var qendedH=function() {
                    that.bvoice_sprite.play('endp');
                    var bvf = that.add.image(40, 54, 'bvf' + window.question_no);
                    that.bvideo = new MovieClip(that, 40, 54, 670, 440, window.bvConfigArray[window.question_no], function () {
                        that.$bv.pause();
                        // $bv[0].currentTime=0;
                        that.$bv.seek(0);
                        that.$bv.play();
                        that.bvideo.playVideo();
                    });
                    video_bg.addChild(bvf);
                    video_bg.addChild(that.bvideo);


                    var c = game.add.tween(mask2).to({x: 750, y: 548}, 800, Phaser.Easing.Quartic.Out, true, 400);
                    c.onComplete.add(function () {
                        // $bv[0].currentTime=0;
                        that.$bv.seek(0);
                        that.$bv.play();
                        that.bvideo.playVideo();
                        game.add.tween(that.back_btn.scale).to({x: 1, y: 1}, 800, Phaser.Easing.Bounce.Out, true).onComplete.add(function () {
                            var ea2 = that.add.tween(that.back_btn.scale).to({x: 1.5, y: 1.5}, 1000, Phaser.Easing.Bounce.Out, true, 300, -1,true);
                            ea2.repeatDelay(1500);

                        },this);
                    }, this);

                    // $q.unbind('ended',qendedH);
                };
                var q = new Howl({
                    src: ['assets/audio/q'+window.question_no+'.mp3']
                });
                q.once('end',qendedH);
                q.play();
                // $q.bind('ended',qendedH);
                // $q[0].play();


            }


        },
        showAn: function () {
            var that = this;
            if (window.asArray[window.question_no] == null) {
                $("#video_wrapper").css("top", 210 / 1206 * window.innerHeight);
                this.renderVideoHtml();

            } else {
                var a1 = this.bvoice_sprite.play('startp');
                a1.onComplete.add(function () {
                    this.bvoice_sprite.play('loopp');
                }, this);
                var qt1 = this.add.bitmapText(44, 164, 'babyfont', window.asArray[window.question_no], 36);

                this.mask1 = game.add.graphics(0, 0);
                this.mask1.beginFill(0xffffff);
                this.mask1.drawRect(44 - 600, 164, 600, 40);
                this.mask1.endFill();
                qt1.mask = this.mask1;


                var tl1 = this.add.image(44, 164 - 28, 't_l');
                tl1.alpha = 0;
                this.game.add.tween(tl1).to({
                    x: 600 + 44,
                    alpha: [1, 1, 1, 1, 1, 1, 1, 0]
                }, 1000, Phaser.Easing.Quartic.Out, true, 200);

                game.add.tween(this.mask1).to({x: 600}, 1000, Phaser.Easing.Quartic.Out, true, 200);
                //play audio
                //end
                var $qaudio = $("#qaudio");
                var $q=$qaudio.find('.q'+window.question_no);

                // var qaudio = this.add.audio('q'+window.question_no);
                // document.getElementById("qaudio").addEventListener('ended',function () {
                //     alert("aaa");
                // },false);

                // qaudio.play();
                // qaudio.onStop.add(function () {
                // 
                // },this);

                that.longtime=game.time.events.add(15000, function () {
                    endedHandler();
                },this);
                
                var endedHandler=function () {
                    that.bvoice_sprite.play('endp');
                    that.renderVideoHtml();
                    if(that.longtime!=undefined){
                        game.time.events.remove(that.longtime);
                    }
                    $q.unbind('ended', endedHandler);
                    
                   
                };
                $q.bind('ended', endedHandler);
                $q[0].play();

                //longtime
               
            }

        },
        bind: function () {
            var that = this;
            var mvideo = document.getElementById("mvideo");

            function videoHandler() {
                // console.log("canplaythrough");
                window.haveloaded = true;
                mvideo.removeEventListener("canplaythrough", videoHandler);


            }

            mvideo.addEventListener("canplaythrough", videoHandler, false);
            $("#mvideo")[0].load();
        },
        renderVideoHtml: function () {
            var that = this;

            $("#video_wrapper").css({"display": "block", "width": 0, "height": 0});

            TweenMax.to($("#video_wrapper"), 0.5, {
                width: "750px", height: "548px", ease: Power2.easeIn, onComplete: function () {
                    // console.log("play");
                    $("#mvideo")[0].play();
                    game.add.tween(that.back_btn.scale).to({x: 1, y: 1}, 800, Phaser.Easing.Bounce.Out, true).onComplete.add(function () {
                        var ea2 = that.add.tween(that.back_btn.scale).to({x: 1.5, y: 1.5}, 1000, Phaser.Easing.Bounce.Out, true, 300, -1,true);
                        ea2.repeatDelay(1500);
                    },this);


                }
            });

        },
        renderLoadA: function () {
            var that = this;
            this.load.onLoadComplete.addOnce(function () {
                window.haveloaded = true;

            }, this);
            if (window.asArray[window.question_no] != null) {
                this.load.audio('q' + window.question_no, 'assets/audio/q' + window.question_no + '.mp3');
            }
            if (window.bvConfigArray[window.question_no] != null) {
                window.bvConfigArray[window.question_no].preload();
                this.load.image('bvf' + window.question_no, 'assets/video/b' + window.question_no + '.jpg');
            }
            this.load.audio('bv' + window.question_no, 'assets/audio/bv' + window.question_no + '.mp3');


            this.load.start();

        },
        renderLoad: function () {
            var that = this;
            if (window.asArray[window.question_no] != null) {
                this.load.onLoadComplete.addOnce(function () {
                    $("#mvideo")[0].src = "./assets/video/b" + window.question_no + ".mp4";
                    $("#mvideo")[0].poster = "./assets/video/b" + window.question_no + ".jpg";
                    // $("#mvideo")[0].play();
                    // $("#mvideo")[0].pause();

                    this.bind();
                }, this);

                this.load.audio('q' + window.question_no, 'assets/audio/q' + window.question_no + '.mp3');
                this.load.start();
            } else {
                $("#mvideo")[0].src = "./assets/video/b" + window.question_no + ".mp4";
                $("#mvideo")[0].poster = "./assets/video/b" + window.question_no + ".jpg";
                // $("#mvideo")[0].play();
                // $("#mvideo")[0].pause();
                this.bind();
            }

        },
        renderVideo: function () {
            var video_group = this.add.group();

            var bg = video_group.create(375, 615, 'video_bg');
            bg.anchor.setTo(0.5);

            var evideo = video_group.create(375, 615, 'evideo');
            evideo.anchor.setTo(0.5);
            var c1 = game.add.tween(video_group).from({alpha: 0}, 1000, Phaser.Easing.Quartic.Out, true);
        }
    };
}());
},{"../entities/MovieClip":"/Users/sanchez/Sanchez/WORK/babysiri/src/js/entities/MovieClip.js"}],"/Users/sanchez/Sanchez/WORK/babysiri/src/js/states/mvoice.js":[function(require,module,exports){
/**
 * Created by sanchez on 16/6/16.
 */
(function () {
    'use strict';
    var MovieClip = require('../entities/MovieClip');
    var FriendBtn = require('../entities/FriendBtn');
    var Mvoice = function () {
        this.fbtn1=null;
        this.fbtn2=null;
        this.fbtn3=null;
        this.fbtn4=null;
        this.fbtn5=null;
        this.fbtn6=null;

    };

    module.exports = Mvoice;

    Mvoice.prototype = {

        create: function () {
            var that = this;



            this.bvoice_sprite = this.add.sprite(375, 1206, 'bvoice_sprite');
            this.bvoice_sprite.anchor.setTo(0.5, 1);
            this.bvoice_sprite.animations.add('startp', [0, 1, 2, 3, 4, 5, 6, 7], 15, false);
            this.bvoice_sprite.animations.add('loopp', [8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27], 15, true);
            this.bvoice_sprite.animations.add('endp', [7, 6, 5, 4, 3, 2, 1, 0], 15, false);


            this.back_btn = this.add.sprite(375, 1106, 'back_btn');
            this.back_btn.anchor.setTo(0.5);
            this.back_btn.scale.setTo(0);
            this.back_btn.inputEnabled = true;
            this.back_btn.events.onInputDown.addOnce(function () {
                this.back_btn.alpha = 0.6;
            }, this);
            this.back_btn.events.onInputUp.addOnce(function () {
                this.game.state.start('Game');
            }, this);
            if(window.question_no==undefined){
                window.question_no = 9 ;
            }
            if(!window.android||window.androidv){
                if(window.question_no!=12){
                    that.qa = new Howl({
                        src: ['assets/audio/q'+window.question_no+'.mp3']
                    });
                }
            }
            this.t2 = this.add.bitmapText(733, 63, 'babyfont', '“' + window.quArray[window.question_no] + '”', 36);
            this.t2.anchor.setTo(1, 0);
            var c1 = game.add.tween(this.t2).from({
                x: 750 + 200,
                alpha: 0
            }, 800, Phaser.Easing.Bounce.Out, true, 20);


            c1.onComplete.add(function () {
                this.qloader = this.add.sprite(122, 180, 'qloader');
                this.qloader.anchor.setTo(0.5);
                this.qloader.scale.setTo(0.5);

                this.ql_aim = this.qloader.animations.add('ql', [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]);
                this.ql_aim.play(17, true);
                this.renderLoad();

            }, this);

            //longtime

        },
        update: function () {
            if (window.haveloaded) {
                window.haveloaded = false;

                if(window.question_no!=12){
                    this.ql_aim.stop();
                    // this.ql_aim.play(17, false);
                    this.qloader.kill();
                    if(!window.android||window.androidv){
                        this.renderAnA();
                    }else {
                        this.renderAn();
                    }

                }else {
                    this.game.time.events.add(1000, this.render12,this);

                }


            }

        },
        render12:function () {
            var that=this;
            this.ql_aim.stop();
            // this.ql_aim.play(17, false);
            this.qloader.kill();
            var friend_bg=this.add.image(0,163,'friend_bg');
            this.fbtn1=new FriendBtn(this,137,374,0);
            friend_bg.addChild(this.fbtn1);
            this.fbtn2=new FriendBtn(this,375,374,1);
            friend_bg.addChild(this.fbtn2);
            this.fbtn3=new FriendBtn(this,614,374,2);
            friend_bg.addChild(this.fbtn3);
            this.fbtn4=new FriendBtn(this,137,642,3);
            friend_bg.addChild(this.fbtn4);
            this.fbtn5=new FriendBtn(this,375,642,4);
            friend_bg.addChild(this.fbtn5);
            this.fbtn6=new FriendBtn(this,614,642,5);
            friend_bg.addChild(this.fbtn6);

            var mask2 = game.add.graphics(0, 0);
            mask2.beginFill(0xffffff);
            mask2.drawRect(0, 163-790, 750, 790);
            mask2.endFill();
            friend_bg.mask = mask2;
            game.add.tween(mask2).to({y:790}, 800, Phaser.Easing.Quartic.Out, true, 400);

            game.add.tween( this.fbtn1.scale).to({x:1,y:1}, 500, Phaser.Easing.Quartic.Out, true, 800);
            game.add.tween( this.fbtn2.scale).to({x:1,y:1}, 500, Phaser.Easing.Quartic.Out, true, 1000);
            game.add.tween( this.fbtn3.scale).to({x:1,y:1}, 500, Phaser.Easing.Quartic.Out, true, 1100);
            game.add.tween( this.fbtn4.scale).to({x:1,y:1}, 500, Phaser.Easing.Quartic.Out, true, 1200);
            game.add.tween( this.fbtn5.scale).to({x:1,y:1}, 500, Phaser.Easing.Quartic.Out, true, 1300);
            var c=game.add.tween( this.fbtn6.scale).to({x:1,y:1}, 500, Phaser.Easing.Quartic.Out, true, 1400);
            c.onComplete.add(function () {
                game.add.tween(this.back_btn.scale).to({x: 1, y: 1}, 800, Phaser.Easing.Bounce.Out, true).onComplete.add(function () {
                    var ea2 = that.add.tween(that.back_btn.scale).to({x: 1.5, y: 1.5}, 1000, Phaser.Easing.Bounce.Out, true, 300, -1,true);
                    ea2.repeatDelay(1500);

                },this);
            },this)

        },
        renderAnA:function () {
            var that=this;
            this.qt1 = this.add.bitmapText(44, 164, 'babyfont', window.asArray[window.question_no], 36);

            this.mask1 = game.add.graphics(0, 0);
            this.mask1.beginFill(0xffffff);
            this.mask1.drawRect(44 - 538, 164, 538, 40);
            this.mask1.endFill();
            this.qt1.mask = this.mask1;

            var tl1=this.add.image(44,164-28,'t_l');
            tl1.alpha=0;
            this.game.add.tween(tl1).to({x: 538+44,alpha:[1,1,1,1,1,1,1,0]}, 1000, Phaser.Easing.Quartic.Out, true, 400);


            game.add.tween(this.mask1).to({x: 538}, 1000, Phaser.Easing.Quartic.Out, true, 400);


            var a1 = this.bvoice_sprite.play('startp');
            a1.onComplete.add(function () {
                this.bvoice_sprite.play('loopp');
            }, this);

            function endedHandler() {
                that.bvoice_sprite.play('endp');
                if (window.question_no != 3) {
                    game.add.tween(that.back_btn.scale).to({x: 1, y: 1}, 800, Phaser.Easing.Bounce.Out, true,800).onComplete.add(function () {
                        var ea2 = that.add.tween(that.back_btn.scale).to({x: 1.5, y: 1.5}, 1000, Phaser.Easing.Bounce.Out, true, 300, -1,true);
                        ea2.repeatDelay(1500);

                    },this);
                }
                switch (window.question_no) {
                    case 9:
                        that.render9();
                        break;
                    case 11:
                        that.render11();
                        break;
                    case 14:
                        that.render14();
                        break;
                    case 3:
                        if(!window.android||window.androidv){
                            that.render3A();
                        }else {
                            that.render3();
                        }

                        break;

                    default:
                        break;

                }
            };
            that.qa.once('end',endedHandler);
            that.qa.play();


        },
        renderAn: function () {
            var that=this;
            this.qt1 = this.add.bitmapText(44, 164, 'babyfont', window.asArray[window.question_no], 36);

            this.mask1 = game.add.graphics(0, 0);
            this.mask1.beginFill(0xffffff);
            this.mask1.drawRect(44 - 538, 164, 538, 40);
            this.mask1.endFill();
            this.qt1.mask = this.mask1;

            var tl1=this.add.image(44,164-28,'t_l');
            tl1.alpha=0;
            this.game.add.tween(tl1).to({x: 538+44,alpha:[1,1,1,1,1,1,1,0]}, 1000, Phaser.Easing.Quartic.Out, true, 400);


            game.add.tween(this.mask1).to({x: 538}, 1000, Phaser.Easing.Quartic.Out, true, 400);


            var a1 = this.bvoice_sprite.play('startp');
            a1.onComplete.add(function () {
                this.bvoice_sprite.play('loopp');
            }, this);

            var $qaudio=$("#qaudio");
            var $q=$qaudio.find('.q'+window.question_no);

            function endedHandler() {
                that.bvoice_sprite.play('endp');
                if (window.question_no != 3) {
                    game.add.tween(that.back_btn.scale).to({x: 1, y: 1}, 800, Phaser.Easing.Bounce.Out, true,800).onComplete.add(function () {
                        var ea2 = that.add.tween(that.back_btn.scale).to({x: 1.5, y: 1.5}, 1000, Phaser.Easing.Bounce.Out, true, 300, -1,true);
                        ea2.repeatDelay(1500);

                    },this);
                }
                switch (window.question_no) {
                    case 9:
                        that.render9();
                        break;
                    case 11:
                        that.render11();
                        break;
                    case 3:
                        if(!window.android||window.androidv){
                            that.render3A();
                        }else {
                            that.render3();
                        }

                        break;

                    default:
                        break;

                }

                if(that.longtime!=undefined){
                    game.time.events.remove(that.longtime);
                }


                $q.unbind('ended',endedHandler);
            }

            $q.bind('ended',endedHandler);
            $q[0].play();

            that.longtime=this.game.time.events.add(15000, function () {
                that.endedHandler();
            },this);
           
            // document.getElementById("qaudio").addEventListener('ended',function () {
            //     alert("aaa");
            // },false);


            //play audio
            //end

           
           
         

         
            
        },
        bind: function () {
            var that = this;
            var mvideo = document.getElementById("mphone");
            // $("#mphone")[0].play();
            // $("#mphone")[0].pause();
            function videoHandler() {
                // console.log("canplaythrough");
                window.haveloaded = true;
                // mvideo.removeEventListener("canplaythrough", videoHandler);

            }
            window.haveloaded = true;

            // mvideo.addEventListener("canplaythrough", videoHandler, false);

            // function vendHandler() {
            //     if( !window.phone_clicked){
            //         console.log("ended");
            //         window.videoend=true;
            //         document.getElementById("phone_wrapper").style.display="none";
            //         mvideo.pause();
            //         that.game.state.start('Game');
            //         mvideo.removeEventListener("ended", videoHandler);
            //     }
            // }
            // mvideo.addEventListener("ended", vendHandler, false);


        },
        render3A:function () {
            var that=this;
            game.add.tween(this.qt1).to({alpha: 0}, 10, null, true, 400);
            game.add.tween(this.t2).to({alpha: 0}, 10, null, true, 400).onComplete.add(function () {

                var phone_t = this.add.image(375, 164, 'phone_t');
                phone_t.anchor.setTo(0.5);
                // var call=$("#pcall")[0];
                // call.play();
                var pcall = new Howl({
                    src: ['assets/audio/call.mp3'],
                    loop:true
                });
                var phone = new Howl({
                    src: ['assets/audio/phone.mp3']
                });


                pcall.play();
                var phone_i1 = this.add.image(375, 1040, 'phone_i1');
                phone_i1.anchor.setTo(0.5);
                phone_i1.inputEnabled=true;
                phone_i1.events.onInputDown.addOnce(function () {
                    phone_i1.alpha = 0.6;
                }, this);
                phone_i1.events.onInputUp.addOnce(function () {
                    document.getElementById("bg2").style.display="none";
                    pcall.pause();
                    // var paudio= $("#paudio")[0];
                    var vgroup = this.add.group();
                    this.bv3=new MovieClip(this,0,0,750,1206,window.phone,function () {
                       // console.log('end');
                        phone.pause();
                        phone.seek(0);
                        // paudio.currentTime=0;
                        phone.play();
                        that.bv3.playVideo();
                    });

                    vgroup.addChild( this.bv3);
                    var canvas= $("#babysiri-game").find("canvas");

                    canvas.addClass('mid');
                    phone.seek(0);
                    phone.play();

                    // phone.currentTime=0;
                    this.bv3.playVideo();

                    phone_t.kill();
                    phone_i1.kill();
                    var phone_i2 = this.add.image(375, 1040, 'phone_i2');
                    phone_i2.anchor.setTo(0.5);
                    phone_i2.inputEnabled=true;
                    phone_i2.events.onInputDown.addOnce(function () {
                        phone_i2.alpha = 0.6;
                    }, this);
                    phone_i2.events.onInputUp.addOnce(function () {
                        phone.pause();
                        document.getElementById("bg2").style.display="block";
                        that.game.state.start('Game');
                        // $('#mphone')[0].currentTime=0;

                    }, this);


                }, this);

            }, this);
            
        },
        render3: function () {
            var that=this;
            game.add.tween(this.qt1).to({alpha: 0}, 10, null, true, 400);
            game.add.tween(this.t2).to({alpha: 0}, 10, null, true, 400).onComplete.add(function () {
                // var call=this.add.audio('call',1,true);
                var call=$("#pcall")[0];
                call.currentTime=0;
                call.play();
                var phone_t = this.add.image(375, 164, 'phone_t');
                phone_t.anchor.setTo(0.5);

                var phone_i1 = this.add.image(375, 1040, 'phone_i1');
                phone_i1.anchor.setTo(0.5);
                phone_i1.inputEnabled=true;
                phone_i1.events.onInputDown.addOnce(function () {
                    phone_i1.alpha = 0.6;
                }, this);
                phone_i1.events.onInputUp.addOnce(function () {
                    document.getElementById("phone_wrapper").style.display="block";
                    call.pause();
                    $('#mphone')[0].currentTime=0;
                    $('#mphone')[0].play();
                    // call.destroy();
                    phone_t.kill();
                    phone_i1.kill();
                    var phone_i2 = this.add.image(375, 1040, 'phone_i2');
                    phone_i2.anchor.setTo(0.5);
                    phone_i2.inputEnabled=true;
                    phone_i2.events.onInputDown.addOnce(function () {
                        phone_i2.alpha = 0.6;
                    }, this);
                    phone_i2.events.onInputUp.addOnce(function () {
                        window.phone_clicked=true;
                        document.getElementById("phone_wrapper").style.display="none";
                        $('#mphone')[0].pause();
                        // $('#mphone')[0].currentTime=0;
                        that.game.state.start('Game');

                    }, this);


                }, this);

            }, this);


        },
        render9: function () {
            var delay = 0;
            var randf=Math.floor(Math.random()*5);
            for (var i = 0; i < 15; i++) {
                var qi = this.add.sprite(50 + Math.random() * 650, -150, 'q9_i',randf);
               
                qi.angle = Math.random() * 360;
                qi.scale.set(game.rnd.realInRange(0.4, 1.2));
                var speed = game.rnd.between(4000, 6000);

                game.add.tween(qi).to({
                    x: 50 + Math.random() * 650,
                    y: 1500,
                    angle:-10
                }, speed, Phaser.Easing.Sinusoidal.InOut, true, delay, 800, false);

                delay += 200;

            }


        },

        render11: function () {
            var q1 = this.add.image(0, 278, 'q11_i1');


            var mask2 = game.add.graphics(0, 0);
            mask2.beginFill(0xffffff);
            mask2.drawRect(0, 268-650, 750, 650);
            mask2.endFill();
            q1.mask = mask2;
            game.add.tween(mask2).to({y:650}, 800, Phaser.Easing.Quartic.Out, true, 400);

            var q2 = this.add.image(415, 188, 'q11_i2');
            var _map=this.add.image(0,149,'map');
            _map.addChild(q2);
            // _map.scale.setTo(1.133);

            var mm = game.add.graphics(0, 0);
            mm.beginFill(0xffffff);
            mm.drawRect(0, 427, 750, 500);
            mm.endFill();
            _map.mask = mm;

            var bounds = new Phaser.Rectangle(0, 149-344, 750, 1188);

            _map.inputEnabled = true;
            _map.input.enableDrag();
            _map.input.boundsRect = bounds;

            q1.addChild(_map);

            // q1.addChild()

            var anim = game.add.tween(q2).from({x: 415, y: 0, alpha: 0}, 800, Phaser.Easing.Bounce.Out, true, 1000);
            this.back_btn.bringToTop();


        },
        renderLoad: function () {
            var that = this;
            this.load.onLoadComplete.addOnce(function () {
                if (window.question_no != 3) {
                    window.haveloaded = true;
                } else {
                    // $("#mphone")[0].play();
                    // $("#mphone")[0].pause();
                    that.bind();
                    // window.haveloaded = true;
                }

            }, this);
            if(window.question_no!=12){
                this.load.audio('q'+window.question_no, 'assets/audio/q' + window.question_no + '.mp3');
                switch (window.question_no) {
                    case 9:
                        // this.load.image('q9_i', 'assets/img/q9_i.png',74,72);
                        this.load.spritesheet('q9_i', 'assets/img/q9_i1.png',74,72,5);
                        break;
                    case 11:
                        this.load.image('q11_i1', 'assets/img/q11_i1.png');
                        this.load.image('q11_i2', 'assets/img/q11_i2.png');
                        this.load.image('map', 'assets/img/map.jpg');
                        break;
                    case 3:
                        this.load.image('phone_t', 'assets/img/phone_t.png');
                        this.load.image('phone_i1', 'assets/img/phone_i1.png');
                        this.load.image('phone_i2', 'assets/img/phone_i2.png');
                        this.load.audio('call', 'assets/audio/call.mp3');
                        if(!window.android||window.androidv){
                            window.phone.preload();
                            this.load.audio('phone', 'assets/audio/phone.mp3');
                        }else {
                            this.load.video('b3', 'assets/video/b3.mp4');
                        }

                        break;
                    default:
                        console.log('error');
                }
            }else {
                this.load.image('friend_bg','assets/img/friend_bg.png');
                this.load.audio('f0', 'assets/audio/f0.mp3');
                this.load.audio('f1', 'assets/audio/f1.mp3');
                this.load.audio('f2', 'assets/audio/f2.mp3');
                this.load.audio('f3', 'assets/audio/f3.mp3');
                this.load.audio('f4', 'assets/audio/f4.mp3');
                this.load.audio('f5', 'assets/audio/f5.mp3');
                this.load.spritesheet('friend_sprite', 'assets/img/friend_sprite.png', 182, 221, 6,0,2);
            }
            
           

            this.load.start();
        }


    };

}());


},{"../entities/FriendBtn":"/Users/sanchez/Sanchez/WORK/babysiri/src/js/entities/FriendBtn.js","../entities/MovieClip":"/Users/sanchez/Sanchez/WORK/babysiri/src/js/entities/MovieClip.js"}],"/Users/sanchez/Sanchez/WORK/babysiri/src/js/states/preloader.js":[function(require,module,exports){
(function () {
    'use strict';
    var PieProgress = require('../entities/PieProgress');
    var Preloader = function () {
        this.asset = null;
        this.ready = false;
        this.mpieprogress = null;
    };

    module.exports = Preloader;

    Preloader.prototype = {
        loadResources: function () {
            // load your assets here
            this.load.bitmapFont('babyfont', 'assets/fonts/babyfont.png', 'assets/fonts/babyfont.fnt');


            this.load.image('bg', 'assets/img/bg2.jpg');
            this.load.spritesheet('lt', 'assets/img/lt.png', 218, 32, 4);


            if(!window.android){
                this.load.image('actsiri', 'assets/img/actsiri_a.png');
                this.load.spritesheet('voice_sprite', 'assets/img/avoice_sprite.png', 750, 190, 27);
                this.load.image('enter_btn', 'assets/img/enter_btn.png');
            }else {
                this.load.image('actsiri', 'assets/img/actsiri.png');
                this.load.spritesheet('voice_sprite', 'assets/img/voice_sprite.jpg', 750, 190, 27);
                this.load.image('fload_ios', 'assets/img/fload_ios.png');
            }

            this.load.image('t_l', 'assets/img/t_l.png');
            this.load.image('clock_sprite', 'assets/img/clock.png');
            this.load.image('hourhand', 'assets/img/hourhand.png');
            this.load.image('secondhand', 'assets/img/secondhand.png');
            this.load.image('back_btn', 'assets/img/back_btn.png');

            this.load.spritesheet('change_btn', 'assets/img/change_btn.png',180,38,16);
            this.load.image('game_title', 'assets/img/game_title.png');
            this.load.image('btn_arrow', 'assets/img/btn_arrow.png');


            this.load.image('video_bg', 'assets/img/video_bg.png');
            this.load.image('evideo', 'assets/img/evideo.png');
            this.load.image('link_btn', 'assets/img/link_btn.png');
            this.load.spritesheet('end_i', 'assets/img/end_i.png',44,27,2);
            this.load.image('content_bg','assets/img/content_bg.png');
            

            this.load.spritesheet('qloader', 'assets/img/qloader.png', 128, 128, 12);

            var bvoice_sprite_json = {
                "frames": {

                    "in_0000.png": {
                        "frame": {"x": 710, "y": 588, "w": 1, "h": 1},
                        "rotated": false,
                        "trimmed": true,
                        "spriteSourceSize": {"x": 0, "y": 0, "w": 1, "h": 1},
                        "sourceSize": {"w": 750, "h": 190}
                    },
                    "in_0001.png": {
                        "frame": {"x": 0, "y": 588, "w": 710, "h": 16},
                        "rotated": false,
                        "trimmed": true,
                        "spriteSourceSize": {"x": 20, "y": 84, "w": 710, "h": 16},
                        "sourceSize": {"w": 750, "h": 190}
                    },
                    "in_0002.png": {
                        "frame": {"x": 0, "y": 530, "w": 716, "h": 30},
                        "rotated": false,
                        "trimmed": true,
                        "spriteSourceSize": {"x": 17, "y": 77, "w": 716, "h": 30},
                        "sourceSize": {"w": 750, "h": 190}
                    },
                    "in_0003.png": {
                        "frame": {"x": 716, "y": 526, "w": 716, "h": 30},
                        "rotated": false,
                        "trimmed": true,
                        "spriteSourceSize": {"x": 17, "y": 77, "w": 716, "h": 30},
                        "sourceSize": {"w": 750, "h": 190}
                    },
                    "in_0004.png": {
                        "frame": {"x": 0, "y": 500, "w": 716, "h": 30},
                        "rotated": false,
                        "trimmed": true,
                        "spriteSourceSize": {"x": 17, "y": 77, "w": 716, "h": 30},
                        "sourceSize": {"w": 750, "h": 190}
                    },
                    "in_0005.png": {
                        "frame": {"x": 716, "y": 496, "w": 716, "h": 30},
                        "rotated": false,
                        "trimmed": true,
                        "spriteSourceSize": {"x": 17, "y": 77, "w": 716, "h": 30},
                        "sourceSize": {"w": 750, "h": 190}
                    },
                    "in_0006.png": {
                        "frame": {"x": 716, "y": 584, "w": 716, "h": 28},
                        "rotated": false,
                        "trimmed": true,
                        "spriteSourceSize": {"x": 17, "y": 78, "w": 716, "h": 28},
                        "sourceSize": {"w": 750, "h": 190}
                    },
                    "in_0007.png": {
                        "frame": {"x": 0, "y": 560, "w": 716, "h": 28},
                        "rotated": false,
                        "trimmed": true,
                        "spriteSourceSize": {"x": 17, "y": 78, "w": 716, "h": 28},
                        "sourceSize": {"w": 750, "h": 190}
                    },
                    "white_0007.png": {
                        "frame": {"x": 716, "y": 556, "w": 716, "h": 28},
                        "rotated": false,
                        "trimmed": true,
                        "spriteSourceSize": {"x": 17, "y": 78, "w": 716, "h": 28},
                        "sourceSize": {"w": 750, "h": 190}
                    },
                    "white_0008.png": {
                        "frame": {"x": 0, "y": 422, "w": 716, "h": 42},
                        "rotated": false,
                        "trimmed": true,
                        "spriteSourceSize": {"x": 17, "y": 71, "w": 716, "h": 42},
                        "sourceSize": {"w": 750, "h": 190}
                    },
                    "white_0009.png": {
                        "frame": {"x": 716, "y": 314, "w": 716, "h": 56},
                        "rotated": false,
                        "trimmed": true,
                        "spriteSourceSize": {"x": 17, "y": 64, "w": 716, "h": 56},
                        "sourceSize": {"w": 750, "h": 190}
                    },
                    "white_0010.png": {
                        "frame": {"x": 716, "y": 0, "w": 716, "h": 72},
                        "rotated": false,
                        "trimmed": true,
                        "spriteSourceSize": {"x": 17, "y": 56, "w": 716, "h": 72},
                        "sourceSize": {"w": 750, "h": 190}
                    },
                    "white_0011.png": {
                        "frame": {"x": 0, "y": 0, "w": 716, "h": 84},
                        "rotated": false,
                        "trimmed": true,
                        "spriteSourceSize": {"x": 17, "y": 50, "w": 716, "h": 84},
                        "sourceSize": {"w": 750, "h": 190}
                    },
                    "white_0012.png": {
                        "frame": {"x": 0, "y": 84, "w": 716, "h": 64},
                        "rotated": false,
                        "trimmed": true,
                        "spriteSourceSize": {"x": 17, "y": 60, "w": 716, "h": 64},
                        "sourceSize": {"w": 750, "h": 190}
                    },
                    "white_0013.png": {
                        "frame": {"x": 716, "y": 72, "w": 716, "h": 68},
                        "rotated": false,
                        "trimmed": true,
                        "spriteSourceSize": {"x": 17, "y": 58, "w": 716, "h": 68},
                        "sourceSize": {"w": 750, "h": 190}
                    },
                    "white_0014.png": {
                        "frame": {"x": 0, "y": 206, "w": 716, "h": 58},
                        "rotated": false,
                        "trimmed": true,
                        "spriteSourceSize": {"x": 17, "y": 63, "w": 716, "h": 58},
                        "sourceSize": {"w": 750, "h": 190}
                    },
                    "white_0015.png": {
                        "frame": {"x": 716, "y": 200, "w": 716, "h": 58},
                        "rotated": false,
                        "trimmed": true,
                        "spriteSourceSize": {"x": 17, "y": 63, "w": 716, "h": 58},
                        "sourceSize": {"w": 750, "h": 190}
                    },
                    "white_0016.png": {
                        "frame": {"x": 716, "y": 140, "w": 716, "h": 60},
                        "rotated": false,
                        "trimmed": true,
                        "spriteSourceSize": {"x": 17, "y": 62, "w": 716, "h": 60},
                        "sourceSize": {"w": 750, "h": 190}
                    },
                    "white_0017.png": {
                        "frame": {"x": 0, "y": 264, "w": 716, "h": 56},
                        "rotated": false,
                        "trimmed": true,
                        "spriteSourceSize": {"x": 17, "y": 64, "w": 716, "h": 56},
                        "sourceSize": {"w": 750, "h": 190}
                    },
                    "white_0018.png": {
                        "frame": {"x": 0, "y": 320, "w": 716, "h": 54},
                        "rotated": false,
                        "trimmed": true,
                        "spriteSourceSize": {"x": 17, "y": 65, "w": 716, "h": 54},
                        "sourceSize": {"w": 750, "h": 190}
                    },
                    "white_0019.png": {
                        "frame": {"x": 0, "y": 374, "w": 716, "h": 48},
                        "rotated": false,
                        "trimmed": true,
                        "spriteSourceSize": {"x": 17, "y": 68, "w": 716, "h": 48},
                        "sourceSize": {"w": 750, "h": 190}
                    },
                    "white_0020.png": {
                        "frame": {"x": 716, "y": 258, "w": 716, "h": 56},
                        "rotated": false,
                        "trimmed": true,
                        "spriteSourceSize": {"x": 17, "y": 64, "w": 716, "h": 56},
                        "sourceSize": {"w": 750, "h": 190}
                    },
                    "white_0021.png": {
                        "frame": {"x": 0, "y": 148, "w": 716, "h": 58},
                        "rotated": false,
                        "trimmed": true,
                        "spriteSourceSize": {"x": 17, "y": 63, "w": 716, "h": 58},
                        "sourceSize": {"w": 750, "h": 190}
                    },
                    "white_0022.png": {
                        "frame": {"x": 716, "y": 370, "w": 716, "h": 50},
                        "rotated": false,
                        "trimmed": true,
                        "spriteSourceSize": {"x": 17, "y": 67, "w": 716, "h": 50},
                        "sourceSize": {"w": 750, "h": 190}
                    },
                    "white_0023.png": {
                        "frame": {"x": 716, "y": 420, "w": 716, "h": 44},
                        "rotated": false,
                        "trimmed": true,
                        "spriteSourceSize": {"x": 17, "y": 70, "w": 716, "h": 44},
                        "sourceSize": {"w": 750, "h": 190}
                    },
                    "white_0024.png": {
                        "frame": {"x": 0, "y": 464, "w": 716, "h": 36},
                        "rotated": false,
                        "trimmed": true,
                        "spriteSourceSize": {"x": 17, "y": 74, "w": 716, "h": 36},
                        "sourceSize": {"w": 750, "h": 190}
                    },
                    "white_0025.png": {
                        "frame": {"x": 716, "y": 464, "w": 716, "h": 32},
                        "rotated": false,
                        "trimmed": true,
                        "spriteSourceSize": {"x": 17, "y": 76, "w": 716, "h": 32},
                        "sourceSize": {"w": 750, "h": 190}
                    }
                },
                "meta": {
                    "app": "http://www.codeandweb.com/texturepacker ",
                    "version": "1.0",
                    "image": "bvoice_sprite.png",
                    "format": "RGBA8888",
                    "size": {"w": 1432, "h": 612},
                    "scale": "1",
                    "smartupdate": "$TexturePacker:SmartUpdate:d2b9a865885aa4f1fd2426c1702c7135:1/1$"
                }
            };


            this.load.atlas('bvoice_sprite', 'assets/img/bvoice_sprite.png', null, bvoice_sprite_json);



            // this.load.image('clickarea', 'assets/img/clickarea.png');
            // this.load.audio('q1', 'assets/audio/q1.mp3');



            this.load.start();

        },

        create: function () {
            var that = this;

            if(!window.android){
                this.loader = this.add.sprite(this.game.width / 2, this.game.height / 2-110, 'loader_a');
                this.loader.anchor.setTo(0.5);
                this.loader.animations.add('lt').play(15, true);
            }

            this.lt = this.add.sprite(this.game.width / 2, this.game.height / 2, 'lt');
            this.lt.anchor.setTo(0.5);
            this.lt.animations.add('lt').play(0.7, true);

            // this.load.onLoadStart.add(that.loadResources, this);
            this.load.onFileComplete.add(that.onfileComplete, this);
            this.load.onLoadComplete.addOnce(that.onLoadComplete, this);
            this.loadResources();

            this.ready = true;


        },

        onLoadComplete: function () {
            var that=this;
            // this.ready = true;
            // var mlength = $("#baidusport-game").find("canvas").width();
            // $("#baidusport-game").find("canvas").css("margin-left",);

            if(!window.android){
                this.game.time.events.add(3500, function () {
                    this.loader.kill();
                    this.lt.kill();

                    var enter_btn=this.add.image(this.game.width / 2, this.game.height / 2-80,'enter_btn');
                    enter_btn.anchor.setTo(0.5);
                    enter_btn.inputEnabled = true;
                    enter_btn.events.onInputDown.addOnce(function () {

                        this.game.state.start('Home');
                    }, this);
                },this);


            }else {
                
                // this.game.time.events.add(3500, function () {
                //     that.lt.kill();
                //     var f_click=this.add.image(this.game.width / 2, this.game.height / 2);
                //     f_click.width=400;
                //     f_click.height=400;
                //     f_click.anchor.setTo(0.5);
                //     f_click.inputEnabled = true;
                //     f_click.events.onInputDown.addOnce(function () {
                //
                //         this.game.state.start('Home');
                //     }, this);
                //     var fload_ios=this.add.image(this.game.width / 2, this.game.height / 2,'fload_ios');
                //     fload_ios.anchor.setTo(0.5);
                //
                //
                // },this);
                
                var c=game.add.tween(that.lt).to({alpha:0}, 800, Phaser.Easing.Exponential.Out, true, 3400);

                c.onComplete.add(function () {
                    that.game.state.start('Home');

                },this);
            }



        },
        onfileComplete: function (progress, cacheKey, success, totalLoaded, totalFiles) {
            // window.bar.animate(progress/100);
            // this.mpieprogress._progress=progress/100;
            // this.mpieprogress.updateProgress();
        }
    };

}());

},{"../entities/PieProgress":"/Users/sanchez/Sanchez/WORK/babysiri/src/js/entities/PieProgress.js"}]},{},["/Users/sanchez/Sanchez/WORK/babysiri/src/js/main.js"])
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm5vZGVfbW9kdWxlcy9icm93c2VyLXBhY2svX3ByZWx1ZGUuanMiLCJzcmMvanMvZW50aXRpZXMvRnJpZW5kQnRuLmpzIiwic3JjL2pzL2VudGl0aWVzL01vdmllQ2xpcC5qcyIsInNyYy9qcy9lbnRpdGllcy9QaWVQcm9ncmVzcy5qcyIsInNyYy9qcy9lbnRpdGllcy9RdWVzdGlvbkJ0bi5qcyIsInNyYy9qcy9lbnRpdGllcy9WaWRlb0NvbmZpZy5qcyIsInNyYy9qcy9tYWluLmpzIiwic3JjL2pzL3N0YXRlcy9ib290LmpzIiwic3JjL2pzL3N0YXRlcy9lbmRpbmcuanMiLCJzcmMvanMvc3RhdGVzL2dhbWUuanMiLCJzcmMvanMvc3RhdGVzL2hvbWUuanMiLCJzcmMvanMvc3RhdGVzL21uYW1lLmpzIiwic3JjL2pzL3N0YXRlcy9tdmlkZW8uanMiLCJzcmMvanMvc3RhdGVzL212b2ljZS5qcyIsInNyYy9qcy9zdGF0ZXMvcHJlbG9hZGVyLmpzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBO0FDQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUM5Q0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDbEhBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUN0Q0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUNyTEE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUNuRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUM3SkE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDdERBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDOWpCQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDMVFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQzlaQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ3ZTQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ2pZQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUMzaUJBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBIiwiZmlsZSI6ImdlbmVyYXRlZC5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzQ29udGVudCI6WyIoZnVuY3Rpb24gZSh0LG4scil7ZnVuY3Rpb24gcyhvLHUpe2lmKCFuW29dKXtpZighdFtvXSl7dmFyIGE9dHlwZW9mIHJlcXVpcmU9PVwiZnVuY3Rpb25cIiYmcmVxdWlyZTtpZighdSYmYSlyZXR1cm4gYShvLCEwKTtpZihpKXJldHVybiBpKG8sITApO3ZhciBmPW5ldyBFcnJvcihcIkNhbm5vdCBmaW5kIG1vZHVsZSAnXCIrbytcIidcIik7dGhyb3cgZi5jb2RlPVwiTU9EVUxFX05PVF9GT1VORFwiLGZ9dmFyIGw9bltvXT17ZXhwb3J0czp7fX07dFtvXVswXS5jYWxsKGwuZXhwb3J0cyxmdW5jdGlvbihlKXt2YXIgbj10W29dWzFdW2VdO3JldHVybiBzKG4/bjplKX0sbCxsLmV4cG9ydHMsZSx0LG4scil9cmV0dXJuIG5bb10uZXhwb3J0c312YXIgaT10eXBlb2YgcmVxdWlyZT09XCJmdW5jdGlvblwiJiZyZXF1aXJlO2Zvcih2YXIgbz0wO288ci5sZW5ndGg7bysrKXMocltvXSk7cmV0dXJuIHN9KSIsIi8qKlxuICogQ3JlYXRlZCBieSBzYW5jaGV6IG9uIDE2LzYvMjEuXG4gKi9cbid1c2Ugc3RyaWN0JztcblxuZnVuY3Rpb24gRnJpZW5kQnRuKGdhbWUsIHgsIHksbikge1xuICAgIHRoaXMuZ2FtZT1nYW1lO1xuICAgIHRoaXMuX3g9eDtcbiAgICB0aGlzLl95PXk7XG4gICAgdGhpcy5fbj1uO1xuXG4gICAgUGhhc2VyLlNwcml0ZS5jYWxsKHRoaXMsIGdhbWUsICB0aGlzLl94LCB0aGlzLl95LCdmcmllbmRfc3ByaXRlJyxuKTtcbiAgICB0aGlzLmFuY2hvci5zZXRUbygwLjUpO1xuICAgIHRoaXMuc2NhbGUuc2V0VG8oMCk7XG5cbiAgICB0aGlzLmJpbmRJbnB1dCgpOyAgICAgICAgICAgICAgICAgICAgICAgXG4gICAgLy8gdGhpcy5hbmNob3Iuc2V0VG8oMC41KTtcbiAgICAvLyB0aGlzLmdhbWUuYWRkLmV4aXN0aW5nKHRoaXMpO1xuXG4gICAgcmV0dXJuIHRoaXM7XG59XG5cbkZyaWVuZEJ0bi5wcm90b3R5cGUgPSBPYmplY3QuY3JlYXRlKFBoYXNlci5TcHJpdGUucHJvdG90eXBlKTtcbkZyaWVuZEJ0bi5wcm90b3R5cGUuY29uc3RydWN0b3IgPSBGcmllbmRCdG47XG5cbkZyaWVuZEJ0bi5wcm90b3R5cGUuYmluZElucHV0ID0gZnVuY3Rpb24oKSB7XG4gICAgdmFyIGZhdWRpbz10aGlzLmdhbWUuYWRkLmF1ZGlvKCdmJyt0aGlzLl9uKTtcblxuICAgIHRoaXMuaW5wdXRFbmFibGVkID0gdHJ1ZTtcbiAgICB0aGlzLmV2ZW50cy5vbklucHV0RG93bi5hZGQoZnVuY3Rpb24gKCkge1xuICAgICAgICB0aGlzLmFscGhhID0gMC42O1xuICAgIH0sIHRoaXMpO1xuICAgIHRoaXMuZXZlbnRzLm9uSW5wdXRVcC5hZGQoZnVuY3Rpb24gKCkge1xuICAgICAgICAvLyB0aGlzLmlucHV0RW5hYmxlZCA9IGZhbHNlO1xuICAgICAgICB0aGlzLmFscGhhID0xO1xuICAgICAgICBmYXVkaW8ucGxheSgpO1xuXG5cbiAgICAgICAgLy8gdmFyIG1hdWRpb1N0PSQoXCIjZmF1ZGlvXCIrdGhpcy5uKVswXTtcbiAgICAgICAgLy8gbWF1ZGlvU3QucGxheSgpO1xuXG5cbiAgICB9LCB0aGlzKTtcbn07XG5cblxubW9kdWxlLmV4cG9ydHMgPSBGcmllbmRCdG47IiwiLyoqXG4gKiBDcmVhdGVkIGJ5IGRhaW1vbnMgb24gMTUvMTIvMTguXG4gKi9cblxuJ3VzZSBzdHJpY3QnO1xuXG5cbi8qXG4g6KeG6aKR5bqP5YiX5bin5pKt5pS+57G7ICAgICAgICAgXG4gQHN0YXJ0SW5kZXgg5byA5aeL5Zu+54mH5paH5Lu25bqP5YiXXG4gQGVuZEluZGV4IOe7k+adn+WbvueJh+aWh+S7tuW6j+WIlyAgICAgIFxuIEB4IHkgd2lkdGggaGVpZ2h0IOinhumikeeahOS9jee9ruWPiuWuvemrmFxuIEBmcmFtZVdpZHRoLGZyYW1lSGVpZ2h0ICDluo/liJfluKfnurnnkIblrr3pq5ggICAgIFxuIEB0b3RhbEZyYW1lcyDop4bpopHluo/liJfluKfmgLvluKfmlbBcbiBAZnJhbWVSYXRlICDluKfpgJ/njocg5q+P56eS5bin5pWwXG4gQG9uQ29tcGxldGUg5pKt5pS+57uT5p2f5Zue6LCDXG4gKi9cblxuXG4vL3ByZWZpeCxzdGFydEluZGV4LGVuZEluZGV4LCxmcmFtZVdpZHRoLGZyYW1lSGVpZ2h0LHRvdGFsRnJhbWVzLGZyYW1lUmF0ZVxuXG5cbmZ1bmN0aW9uIE1vdmllQ2xpcChnYW1lLCBfeCwgX3ksIF93aWR0aCwgX2hlaWdodCwgdmlkZW9Db25maWcsIG9uQ29tcGxldGUpIHtcbiAgICB0aGlzLmdhbWUgPSBnYW1lO1xuICAgIHRoaXMudmlkZW9Db25maWcgPSB2aWRlb0NvbmZpZztcbiAgICB0aGlzLmN1cmVudEluZGV4ID0gISF0aGlzLnZpZGVvQ29uZmlnID8gdGhpcy52aWRlb0NvbmZpZy5nZXRTdGFydEluZGV4KCkgOiAwO1xuICAgIHRoaXMuX3ggPSBfeDtcbiAgICB0aGlzLl95ID0gX3k7XG4gICAgdGhpcy5fd2lkdGggPSBfd2lkdGg7XG4gICAgdGhpcy5faGVpZ2h0ID0gX2hlaWdodDtcbiAgICB0aGlzLl9wYXVzZSA9IGZhbHNlO1xuXG4gICAgdGhpcy5fc2NhbGUgPSB0aGlzLl93aWR0aCAvIHRoaXMudmlkZW9Db25maWcuZnJhbWVXaWR0aDtcbiAgICB0aGlzLm9uQ29tcGxldGUgPSBvbkNvbXBsZXRlO1xuICAgIFBoYXNlci5TcHJpdGUuY2FsbCh0aGlzLCB0aGlzLmdhbWUsIHRoaXMuX3gsIHRoaXMuX3kpO1xuICAgIHRoaXMuYW5jaG9yLnNldCgwKTtcbiAgICB0aGlzLnNwcml0ZSA9IG51bGw7XG4gICAgcmV0dXJuIHRoaXM7XG59O1xuICAgICAgIFxuTW92aWVDbGlwLnByb3RvdHlwZSA9IE9iamVjdC5jcmVhdGUoUGhhc2VyLlNwcml0ZS5wcm90b3R5cGUpO1xuXG5Nb3ZpZUNsaXAucHJvdG90eXBlLmNvbnN0cnVjdG9yID0gTW92aWVDbGlwO1xuXG5Nb3ZpZUNsaXAucHJvdG90eXBlLnBsYXlWaWRlbyA9IGZ1bmN0aW9uICgpIHtcblxuXG4gICAgaWYgKHRoaXMuc3ByaXRlID09IG51bGwpIHtcbiAgICAgICAgdGhpcy5zcHJpdGUgPSB0aGlzLmdhbWUubWFrZS5zcHJpdGUoMCwgMCwgdGhpcy52aWRlb0NvbmZpZy5wcmVmaXggKyB0aGlzLmN1cmVudEluZGV4KTtcbiAgICAgICAgdGhpcy5hZGRDaGlsZCh0aGlzLnNwcml0ZSk7XG4gICAgfSBlbHNlIHtcbiAgICAgICAgdGhpcy5jdXJlbnRJbmRleCA9IDA7XG4gICAgICAgIHRoaXMuc3ByaXRlLmxvYWRUZXh0dXJlKHRoaXMudmlkZW9Db25maWcucHJlZml4ICsgdGhpcy5jdXJlbnRJbmRleCwgMCk7XG4gICAgfVxuICAgIHRoaXMuYW5pbSA9IHRoaXMuc3ByaXRlLmFuaW1hdGlvbnMuYWRkKCdhbmltJyArIHRoaXMuY3VyZW50SW5kZXgpO1xuXG4gICAgdGhpcy5hbmltLm9uQ29tcGxldGUuYWRkKHRoaXMub25BbmltYXRpb25GaW5pc2gsIHRoaXMpO1xuICAgIHRoaXMuc3ByaXRlLmFuY2hvci5zZXQoMCk7XG4gICAgdGhpcy5zcHJpdGUuc2NhbGUuc2V0KHRoaXMuX3NjYWxlKTsgIC8v5Lul6KeG6aKR55qE5a695Li65YeGXG4gICAgdGhpcy5zcHJpdGUuYW5pbWF0aW9ucy5wbGF5KCdhbmltJyArIHRoaXMuY3VyZW50SW5kZXgsIHRoaXMudmlkZW9Db25maWcuZnJhbWVSYXRlLCBmYWxzZSk7XG59O1xuXG5Nb3ZpZUNsaXAucHJvdG90eXBlLm9uQW5pbWF0aW9uRmluaXNoID0gZnVuY3Rpb24gKHBTZW5kZXIpIHtcbiAgICB0aGlzLmN1cmVudEluZGV4Kys7XG4gICAgaWYgKHRoaXMuY3VyZW50SW5kZXggPiB0aGlzLnZpZGVvQ29uZmlnLmVuZCkge1xuICAgICAgICBpZiAoISF0aGlzLm9uQ29tcGxldGUgfHwgdHlwZW9mKHRoaXMub25Db21wbGV0ZSkgPT0gJ2Z1bmN0aW9uJykge1xuICAgICAgICAgICAgdGhpcy5vbkNvbXBsZXRlKCk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuO1xuICAgIH1cbiAgICB0aGlzLnNwcml0ZS5sb2FkVGV4dHVyZSh0aGlzLnZpZGVvQ29uZmlnLnByZWZpeCArIHRoaXMuY3VyZW50SW5kZXgsIDApO1xuICAgIHRoaXMuYW5pbSA9IHRoaXMuc3ByaXRlLmFuaW1hdGlvbnMuYWRkKCdhbmltJyArIHRoaXMuY3VyZW50SW5kZXgpO1xuICAgIHRoaXMuYW5pbS5vbkNvbXBsZXRlLmFkZCh0aGlzLm9uQW5pbWF0aW9uRmluaXNoLCB0aGlzKTtcbiAgICB0aGlzLnNwcml0ZS5hbmltYXRpb25zLnBsYXkoJ2FuaW0nICsgdGhpcy5jdXJlbnRJbmRleCwgdGhpcy52aWRlb0NvbmZpZy5mcmFtZVJhdGUsIGZhbHNlKTtcbn07XG5cblxuLy/mmK/lkKbmmoLlgZxcbk1vdmllQ2xpcC5wcm90b3R5cGUuaXNQYXVzZSA9IGZ1bmN0aW9uICgpIHtcbiAgICByZXR1cm4gdGhpcy5fcGF1c2U7ICAgICBcbn07XG5cblxuLy/mmoLlgZxcbk1vdmllQ2xpcC5wcm90b3R5cGUucGF1c2UgPSBmdW5jdGlvbiAoKSB7XG4gICAgaWYgKCEhdGhpcy5zcHJpdGUpIHtcbiAgICAgICAgdGhpcy5zcHJpdGUuYW5pbWF0aW9ucy5zdG9wKCdhbmltJyArIHRoaXMuY3VyZW50SW5kZXgsIGZhbHNlKTtcbiAgICAgICAgdGhpcy5jdXJlbnRGcmFtZT10aGlzLmFuaW0uZnJhbWU7XG4gICAgICAgIHRoaXMuX3BhdXNlID0gdHJ1ZTtcbiAgICB9XG59O1xuXG4vL+WBnOatoiDmgaLlpI3pppbluKdcbk1vdmllQ2xpcC5wcm90b3R5cGUuc3RvcCA9IGZ1bmN0aW9uICgpIHtcbiAgICBpZiAoISF0aGlzLnNwcml0ZSkge1xuICAgICAgICB0aGlzLnNwcml0ZS5hbmltYXRpb25zLnN0b3AoJ2FuaW0nICsgdGhpcy5jdXJlbnRJbmRleCwgZmFsc2UpO1xuICAgICAgICB0aGlzLmN1cmVudEluZGV4ID0gMDtcbiAgICAgICAgdGhpcy5zcHJpdGUubG9hZFRleHR1cmUodGhpcy52aWRlb0NvbmZpZy5wcmVmaXggKyB0aGlzLmN1cmVudEluZGV4LCAwKTtcbiAgICB9XG59O1xuXG4vL+e7p+e7reaSreaUvlxuTW92aWVDbGlwLnByb3RvdHlwZS5yZXN1bWUgPSBmdW5jdGlvbiAoKSB7XG4gICAgaWYgKCEhdGhpcy5zcHJpdGUpIHtcbiAgICAgICAgLy8gLmN1cnJlbnRGcmFtZT10aGlzLmN1cmVudEZyYW1lO1xuXG4gICAgICAgIHRoaXMuc3ByaXRlLmFuaW1hdGlvbnMucGxheSgnYW5pbScgKyB0aGlzLmN1cmVudEluZGV4LCB0aGlzLnZpZGVvQ29uZmlnLmZyYW1lUmF0ZSwgZmFsc2UpO1xuICAgICAgICB0aGlzLmFuaW0uZnJhbWU9dGhpcy5jdXJlbnRGcmFtZTtcbiAgICAgICAgLy8gY29uc29sZS5sb2coXCJyZXN1bWVcIik7XG4gICAgICAgIHRoaXMuX3BhdXNlID0gZmFsc2U7XG4gICAgfVxufTtcblxuXG5tb2R1bGUuZXhwb3J0cyA9IE1vdmllQ2xpcDsiLCIvKipcbiAqIENyZWF0ZWQgYnkgc2FuY2hleiBvbiAxNi81LzE4LlxuICovXG4ndXNlIHN0cmljdCc7XG5cbmZ1bmN0aW9uIFBpZVByb2dyZXNzKGdhbWUsIHgsIHksIHJhZGl1cywgY29sb3IsIGFuZ2xlLCB3ZWlnaHQpIHtcbiAgICB0aGlzLl9yYWRpdXMgPSByYWRpdXM7XG4gICAgdGhpcy5fcHJvZ3Jlc3MgPSAxO1xuICAgIHRoaXMuX3dlaWdodCA9IHdlaWdodCB8fCAwLjI1O1xuICAgIHRoaXMuX2NvbG9yID0gY29sb3J8fFwiI2ZmZlwiO1xuICAgIHRoaXMuYm1wID0gZ2FtZS5hZGQuYml0bWFwRGF0YSgodGhpcy5fcmFkaXVzICogMikgKyAodGhpcy5fd2VpZ2h0ICogKHRoaXMuX3JhZGl1cyAqIDAuNikpLCAodGhpcy5fcmFkaXVzICogMikgKyAodGhpcy5fd2VpZ2h0ICogKHRoaXMuX3JhZGl1cyAqIDAuNikpKTtcbiAgICBQaGFzZXIuU3ByaXRlLmNhbGwodGhpcywgZ2FtZSwgeCwgeSwgdGhpcy5ibXApO1xuXG4gICAgdGhpcy5hbmNob3Iuc2V0KDAuNSk7XG4gICAgdGhpcy5hbmdsZSA9IGFuZ2xlIHx8IC05MDtcbiAgICB0aGlzLnVwZGF0ZVByb2dyZXNzKCk7XG4gICAgcmV0dXJuIHRoaXM7XG59XG5cblBpZVByb2dyZXNzLnByb3RvdHlwZSA9IE9iamVjdC5jcmVhdGUoUGhhc2VyLlNwcml0ZS5wcm90b3R5cGUpO1xuUGllUHJvZ3Jlc3MucHJvdG90eXBlLmNvbnN0cnVjdG9yID0gUGllUHJvZ3Jlc3M7XG5cblBpZVByb2dyZXNzLnByb3RvdHlwZS51cGRhdGVQcm9ncmVzcyA9IGZ1bmN0aW9uKCkge1xuICAgIHZhciBwcm9ncmVzcyA9IHRoaXMuX3Byb2dyZXNzO1xuICAgIHByb2dyZXNzID0gUGhhc2VyLk1hdGguY2xhbXAocHJvZ3Jlc3MsIDAuMDAwMDEsIDAuOTk5OTkpO1xuXG4gICAgdGhpcy5ibXAuY2xlYXIoKTtcbiAgICB0aGlzLmJtcC5jdHguc3Ryb2tlU3R5bGUgPSB0aGlzLl9jb2xvcjtcbiAgICB0aGlzLmJtcC5jdHgubGluZVdpZHRoID0gdGhpcy5fd2VpZ2h0ICogdGhpcy5fcmFkaXVzO1xuICAgIHRoaXMuYm1wLmN0eC5iZWdpblBhdGgoKTtcbiAgICB0aGlzLmJtcC5jdHguYXJjKHRoaXMuYm1wLndpZHRoICogMC41LCB0aGlzLmJtcC5oZWlnaHQgKiAwLjUsIHRoaXMuX3JhZGl1cyAtIDE1LCAwLCAoTWF0aC5QSSAqIDIpICogcHJvZ3Jlc3MsIGZhbHNlKTtcbiAgICB0aGlzLmJtcC5jdHguc3Ryb2tlKCk7XG4gICAgdGhpcy5ibXAuZGlydHkgPSB0cnVlO1xufTtcblBpZVByb2dyZXNzLnByb3RvdHlwZS51cGRhdGVCbWRTaXplID0gZnVuY3Rpb24oKSB7XG4gICAgdGhpcy5ibXAucmVzaXplKCh0aGlzLl9yYWRpdXMgKiAyKSArICh0aGlzLl93ZWlnaHQgKiAodGhpcy5fcmFkaXVzICogMC43NSkpLCAodGhpcy5fcmFkaXVzICogMikgKyAodGhpcy5fd2VpZ2h0ICogKHRoaXMuX3JhZGl1cyAqIDAuNzUpKSk7XG59O1xuXG5tb2R1bGUuZXhwb3J0cyA9IFBpZVByb2dyZXNzOyIsIi8qKlxuICogQ3JlYXRlZCBieSBzYW5jaGV6IG9uIDE2LzYvMTcuXG4gKi9cbid1c2Ugc3RyaWN0JztcblxuZnVuY3Rpb24gUXVlc3Rpb25CdG4oZ2FtZSwgeCwgeSxxdV9udW0sYWQpIHtcbiAgICB0aGlzLmdhbWU9Z2FtZTtcbiAgICB0aGlzLl94PXg7XG4gICAgdGhpcy5feT15O1xuICAgIHRoaXMucXVfbnVtPXF1X251bTtcbiAgICAvLyB0aGlzLnF1X2Z1bmM9cXVfZnVuYztcbiAgICBpZihhZCE9dW5kZWZpbmVkKVxuICAgICAgICB0aGlzLmFkPWFkO1xuICAgIGVsc2UgdGhpcy5hZD1mYWxzZTtcblxuICAgIFxuICAgIFBoYXNlci5TcHJpdGUuY2FsbCh0aGlzLCBnYW1lLCAwLCAwKTtcblxuXG4gICAgaWYoIWFkKXtcbiAgICAgICAgdGhpcy5tcXVlc3Rpb24gPSB0aGlzLmdhbWUubWFrZS5iaXRtYXBUZXh0KCB0aGlzLl94LCB0aGlzLl95LCAnYmFieWZvbnQnLCB3aW5kb3cucXVBcnJheVt3aW5kb3cubnVtQXJyYXlbcXVfbnVtXV0sIDM2KTsgLy8xNDhcbiAgICB9ZWxzZSB7XG4gICAgICAgIHRoaXMubXF1ZXN0aW9uID0gdGhpcy5nYW1lLm1ha2UuYml0bWFwVGV4dCggdGhpcy5feCwgdGhpcy5feSwgJ2JhYnlmb250Jywgd2luZG93LmVuZEFycmF5W3F1X251bV0sIDM2KTsgLy8xNDhcbiAgICB9XG5cbiAgICB0aGlzLm1xdWVzdGlvbi5hbmNob3Iuc2V0VG8oMC41KTtcbiAgICB0aGlzLm1xdWVzdGlvbi5fd2lkdGg9dGhpcy5tcXVlc3Rpb24ud2lkdGg7XG4gICAgaWYocXVfbnVtJTIpe1xuICAgICAgICB0aGlzLm1xdWVzdGlvbi54ID0gLXRoaXMubXF1ZXN0aW9uLndpZHRoO1xuICAgIH1lbHNlIHtcbiAgICAgICAgdGhpcy5tcXVlc3Rpb24ueCA9IDc1MCt0aGlzLm1xdWVzdGlvbi53aWR0aDtcbiAgICB9XG5cbiAgICB0aGlzLmFkZENoaWxkKHRoaXMubXF1ZXN0aW9uKTtcblxuICAgIHRoaXMuY2xpY2thcmVhPXRoaXMuZ2FtZS5tYWtlLnNwcml0ZSgwLDApO1xuICAgIHRoaXMuY2xpY2thcmVhLndpZHRoPTMwMDtcbiAgICB0aGlzLmNsaWNrYXJlYS5oZWlnaHQ9ODA7XG4gICAgdGhpcy5jbGlja2FyZWEuYW5jaG9yLnNldFRvKDAuNSk7XG4gICAgdGhpcy5tcXVlc3Rpb24uYWRkQ2hpbGQodGhpcy5jbGlja2FyZWEpO1xuXG4gICAgdGhpcy5iaW5kSW5wdXQoKTtcbiAgICAvLyB0aGlzLmFuY2hvci5zZXRUbygwLjUpO1xuICAgIHRoaXMuZ2FtZS5hZGQuZXhpc3RpbmcodGhpcyk7XG4gICAgXG4gICAgcmV0dXJuIHRoaXM7XG59XG5cblF1ZXN0aW9uQnRuLnByb3RvdHlwZSA9IE9iamVjdC5jcmVhdGUoUGhhc2VyLlNwcml0ZS5wcm90b3R5cGUpO1xuUXVlc3Rpb25CdG4ucHJvdG90eXBlLmNvbnN0cnVjdG9yID0gUXVlc3Rpb25CdG47XG5cblF1ZXN0aW9uQnRuLnByb3RvdHlwZS5iaW5kSW5wdXQgPSBmdW5jdGlvbigpIHtcbiAgICB2YXIgdGhhdD10aGlzO1xuICAgIHRoaXMuY2xpY2thcmVhLmlucHV0RW5hYmxlZCA9IHRydWU7XG4gICAgdGhpcy5jbGlja2FyZWEuZXZlbnRzLm9uSW5wdXREb3duLmFkZE9uY2UoZnVuY3Rpb24gKCkge1xuICAgICAgICB3aW5kb3cuaGF2ZWNsaWNrZWQ9dHJ1ZTtcbiAgICAgICAgdGhpcy5tcXVlc3Rpb24uYWxwaGE9MC42O1xuICAgIH0sIHRoaXMpO1xuICAgIHRoaXMuY2xpY2thcmVhLmV2ZW50cy5vbklucHV0VXAuYWRkT25jZShmdW5jdGlvbiAoKSB7XG4gICAgICAgIHRoaXMuY2xpY2thcmVhLmlucHV0RW5hYmxlZCA9IGZhbHNlO1xuICAgICAgICB3aW5kb3cucXVlc3Rpb25fbm89d2luZG93Lm51bUFycmF5W3RoaXMucXVfbnVtXTtcbiAgICAgICAgLy8gY29uc29sZS5sb2coXCJteSBxdWVzdGlvbjogIFwiICsgIHdpbmRvdy5xdWVzdGlvbl9ubyk7XG4gICAgICAgIGlmKHRoaXMuYWQpe1xuICAgICAgICAgICAgd2luZG93LnJlYWRDb3VudD03O1xuICAgICAgICB9ZWxzZSB7XG5cbiAgICAgICAgICAgIHdpbmRvdy5yZWFkQ291bnQrKztcblxuICAgICAgICB9XG4gICAgICAgIC8vIGNvbnNvbGUubG9nKFwicmVhZGVDb3VudCA6XCIrIHdpbmRvdy5yZWFkQ291bnQgKVxuICAgICAgICBpZih3aW5kb3cucmVhZENvdW50PT02KXtcbiAgICAgICAgICAgIHdpbmRvdy5xdWVzdGlvbl9ubz01O1xuICAgICAgICAgICAgdGhhdC5nYW1lLnN0YXRlLnN0YXJ0KCdFbmRpbmcnKTtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuXG5cbiAgICAgICAgdGhpcy5yZW5kZXJRdSh3aW5kb3cubnVtQXJyYXlbdGhpcy5xdV9udW1dKTtcblxuICAgIH0sIHRoaXMpO1xufTtcblF1ZXN0aW9uQnRuLnByb3RvdHlwZS5tZGVzdHJveT1mdW5jdGlvbiAoKSB7XG4gICAgdGhpcy5tcXVlc3Rpb24ua2lsbCgpO1xuICAgIHRoaXMubXF1ZXN0aW9uPW51bGw7XG4gICAgdGhpcy5jbGlja2FyZWEua2lsbCgpO1xuICAgIHRoaXMuY2xpY2thcmVhPW51bGw7XG4gICAgdGhpcy5raWxsKCk7XG5cbn07XG5cblxuUXVlc3Rpb25CdG4ucHJvdG90eXBlLnJlbmRlclZpZGVvPWZ1bmN0aW9uICgpIHtcbiAgICAvLyBjb25zb2xlLmxvZyhcIlNUQVJUIFZpZGVvXCIpO1xuICAgIHRoaXMuZ2FtZS5zdGF0ZS5zdGFydCgnTXZpZGVvJyk7XG5cbn07XG5RdWVzdGlvbkJ0bi5wcm90b3R5cGUucmVuZGVyVm9pY2U9ZnVuY3Rpb24gKCkge1xuICAgIC8vIGNvbnNvbGUubG9nKFwiU1RBUlQgVm9pY2VcIik7XG4gICAgdGhpcy5nYW1lLnN0YXRlLnN0YXJ0KCdNdm9pY2UnKTtcblxufTtcblF1ZXN0aW9uQnRuLnByb3RvdHlwZS5yZW5kZXJOYW1lPWZ1bmN0aW9uICgpIHtcbiAgICAvLyBjb25zb2xlLmxvZyhcIlNUQVJUIE5hbWVcIilcbiAgICB0aGlzLmdhbWUuc3RhdGUuc3RhcnQoJ01uYW1lJyk7XG5cbn07XG5RdWVzdGlvbkJ0bi5wcm90b3R5cGUucmVuZGVyRW5kPWZ1bmN0aW9uICgpIHtcbiAgICAvLyBjb25zb2xlLmxvZyhcIlNUQVJUIEVuZGluZ1wiKTtcbiAgICB0aGlzLmdhbWUuc3RhdGUuc3RhcnQoJ0VuZGluZycpO1xuXG59O1xuXG5RdWVzdGlvbkJ0bi5wcm90b3R5cGUucmVuZGVyUXU9ZnVuY3Rpb24gKG4pIHtcbiAgICB2YXIgdGhhdCA9IHRoaXM7XG4gICAgaWYodGhpcy5hZCl7XG4gICAgICAgIHdpbmRvdy5xdWVzdGlvbl9ubz0gdGhpcy5xdV9udW07XG4gICAgICAgIHRoYXQucmVuZGVyRW5kKCk7XG4gICAgICAgIHJldHVybjtcbiAgICB9XG4gICAgc3dpdGNoIChuKSB7XG4gICAgICAgIGNhc2UgMDpcbiAgICAgICAgICAgIHRoYXQucmVuZGVyTmFtZSgpO1xuICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgIGNhc2UgMTpcbiAgICAgICAgICAgIHRoYXQucmVuZGVyVmlkZW8oKTtcbiAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICBjYXNlIDI6XG4gICAgICAgICAgICB0aGF0LnJlbmRlclZpZGVvKCk7XG4gICAgICAgICAgICBicmVhaztcbiAgICAgICAgY2FzZSAzOlxuICAgICAgICAgICAgdGhhdC5yZW5kZXJWb2ljZSgpO1xuICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgIGNhc2UgNDpcbiAgICAgICAgICAgIHRoYXQucmVuZGVyVmlkZW8oKTtcbiAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICBjYXNlIDU6XG4gICAgICAgICAgICB0aGF0LnJlbmRlclZpZGVvKCk7XG4gICAgICAgICAgICBicmVhaztcbiAgICAgICAgY2FzZSA2OlxuICAgICAgICAgICAgdGhhdC5yZW5kZXJWaWRlbygpO1xuICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgIGNhc2UgNzpcbiAgICAgICAgICAgIHRoYXQucmVuZGVyVmlkZW8oKTtcbiAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICBjYXNlIDg6XG4gICAgICAgICAgICB0aGF0LnJlbmRlclZpZGVvKCk7XG4gICAgICAgICAgICBicmVhaztcbiAgICAgICAgY2FzZSA5OlxuICAgICAgICAgICAgdGhhdC5yZW5kZXJWb2ljZSgpO1xuICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgIGNhc2UgMTA6XG4gICAgICAgICAgICB0aGF0LnJlbmRlclZpZGVvKCk7XG4gICAgICAgICAgICBicmVhaztcbiAgICAgICAgY2FzZSAxMTpcbiAgICAgICAgICAgIHRoYXQucmVuZGVyVm9pY2UoKTtcbiAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICBjYXNlIDEyOlxuICAgICAgICAgICAgdGhhdC5yZW5kZXJWb2ljZSgpO1xuICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgIGNhc2UgMTM6XG4gICAgICAgICAgICB0aGF0LnJlbmRlclZpZGVvKCk7XG4gICAgICAgICAgICBicmVhaztcbiAgICAgICAgY2FzZSAxNDpcbiAgICAgICAgICAgIHRoYXQucmVuZGVyVmlkZW8oKTtcbiAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICBjYXNlIDE1OlxuICAgICAgICAgICAgdGhhdC5yZW5kZXJWaWRlbygpO1xuICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgIGNhc2UgMTY6XG4gICAgICAgICAgICB0aGF0LnJlbmRlclZvaWNlKCk7XG4gICAgICAgICAgICBicmVhaztcbiAgICAgICAgY2FzZSAxNzpcbiAgICAgICAgICAgIHRoYXQucmVuZGVyVm9pY2UoKTtcbiAgICAgICAgICAgIGJyZWFrO1xuXG5cbiAgICB9XG5cbn07XG5cblxubW9kdWxlLmV4cG9ydHMgPSBRdWVzdGlvbkJ0bjsiLCIvKipcbiAqIENyZWF0ZWQgYnkgZGFpbW9ucyBvbiAxNS8xMi8xOS5cbiAqL1xuXG4ndXNlIHN0cmljdCc7XG5cbi8qXG5cbiDop4bpopHluo/liJfluKfphY3nva7nsbtcbiBAZmlsZXBhdGgg6Lev5b6EXG4gQHByZWZpeCDliY3nvIBcbiBAcG9zdGZpeCDlkI7nvIBcbiBAc3RhcnQg5bqP5YiX5bin57Sg5p2Q5byA5aeL57Si5byVXG4gQGVuZCAg5bqP5YiX5bin57Sg5p2Q57uT5p2f57Si5byVXG4gQGZyYW1lV2lkdGgg5bin5a695bqmXG4gQGZyYW1lSGVpZ2h0IOW4p+mrmOW6plxuIEBmcmFtZXMg5q+P5byg5Zu+54mH5omA5YyF5ZCr55qE5oC75bin5pWwXG4gQHRvdGFsRnJhbWUg6KeG6aKR5oC75bin5pWwXG4gQGZyYW1lUmF0ZSDluKfpgJ/njocg5q+P56eS5aSa5bCR5binXG5cbiAqL1xuXG5cbmZ1bmN0aW9uIFZpZGVvQ29uZmlnKGdhbWUsIGZpbGVwYXRoLCBwcmVmaXgsIHBvc3RmaXgsIHN0YXJ0LCBlbmQsIGZyYW1lV2lkdGgsIGZyYW1lSGVpZ2h0LCBmcmFtZXMsIHRvdGFsRnJhbWUsIGZyYW1lUmF0ZSkge1xuICAgIHRoaXMuZ2FtZSA9IGdhbWU7XG4gICAgdGhpcy5mcmFtZVdpZHRoID0gZnJhbWVXaWR0aCB8fCAzMjA7XG4gICAgdGhpcy5mcmFtZUhlaWdodCA9IGZyYW1lSGVpZ2h0IHx8IDU2OTtcbiAgICB0aGlzLmZyYW1lcyA9IGZyYW1lcyB8fCA5O1xuICAgIHRoaXMuZnJhbWVSYXRlID0gZnJhbWVSYXRlIHx8IDE1O1xuXG4gICAgdGhpcy5maWxlcGF0aCA9IGZpbGVwYXRoO1xuICAgIHRoaXMucHJlZml4ID0gcHJlZml4O1xuICAgIHRoaXMucG9zdGZpeCA9IHBvc3RmaXg7XG4gICAgdGhpcy5zdGFydCA9IHN0YXJ0O1xuICAgIHRoaXMuZW5kID0gZW5kO1xuICAgIHRoaXMudG90YWxGcmFtZSA9IHRvdGFsRnJhbWU7XG59XG5cblxuVmlkZW9Db25maWcucHJvdG90eXBlID0ge1xuICAgIHByZWxvYWQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgZm9yICh2YXIgaSA9IHRoaXMuc3RhcnQ7IGkgPD0gdGhpcy5lbmQ7IGkrKykge1xuICAgICAgICAgICAgdmFyIG5GcmFtZSA9IHRoaXMuZnJhbWVzO1xuICAgICAgICAgICAgaWYgKGkgPT0gdGhpcy5lbmQpIHsgLy/mnIDlkI7kuIDlvKDlm77niYforqHnrpfliankvZnluKfmlbBcbiAgICAgICAgICAgICAgICBuRnJhbWUgPSB0aGlzLnRvdGFsRnJhbWUgJSB0aGlzLmZyYW1lcztcblxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdGhpcy5nYW1lLmxvYWQuc3ByaXRlc2hlZXQodGhpcy5wcmVmaXggKyBpLCB0aGlzLmZpbGVwYXRoICsgdGhpcy5wcmVmaXggKyBpICsgdGhpcy5wb3N0Zml4LCB0aGlzLmZyYW1lV2lkdGgsIHRoaXMuZnJhbWVIZWlnaHQsIG5GcmFtZSk7XG4gICAgICAgIH1cbiAgICB9LFxuICAgIGdldFN0YXJ0SW5kZXg6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuc3RhcnQ7XG4gICAgfSxcbiAgICAvLyByZW1vdmVsb2FkOmZ1bmN0aW9uICgpIHtcbiAgICAvLyAgICAgZm9yICh2YXIgaSA9IHRoaXMuc3RhcnQ7IGkgPD0gdGhpcy5lbmQ7IGkrKykge1xuICAgIC8vICAgICAgICAgdmFyIG5GcmFtZSA9IHRoaXMuZnJhbWVzO1xuICAgIC8vICAgICAgICAgaWYgKGkgPT0gdGhpcy5lbmQpIHsgLy/mnIDlkI7kuIDlvKDlm77niYforqHnrpfliankvZnluKfmlbBcbiAgICAvLyAgICAgICAgICAgICBuRnJhbWUgPSB0aGlzLnRvdGFsRnJhbWUgJSB0aGlzLmZyYW1lcztcbiAgICAvL1xuICAgIC8vICAgICAgICAgfVxuICAgIC8vICAgICAgICAgdGhpcy5nYW1lLmxvYWQuc3ByaXRlc2hlZXQodGhpcy5wcmVmaXggKyBpLCB0aGlzLmZpbGVwYXRoICsgdGhpcy5wcmVmaXggKyBpICsgdGhpcy5wb3N0Zml4LCB0aGlzLmZyYW1lV2lkdGgsIHRoaXMuZnJhbWVIZWlnaHQsIG5GcmFtZSk7XG4gICAgLy8gICAgIH1cbiAgICAvL1xuICAgIC8vIH1cbn07XG5cblxubW9kdWxlLmV4cG9ydHMgPSBWaWRlb0NvbmZpZzsiLCIndXNlIHN0cmljdCc7XG52YXIgVmlkZW9Db25maWcgPSByZXF1aXJlKCcuL2VudGl0aWVzL1ZpZGVvQ29uZmlnJyk7XG5cbnZhciB1YSA9IG5hdmlnYXRvci51c2VyQWdlbnQsXG4gICAgYW5kcm9pZCA9IHVhLm1hdGNoKC8oQW5kcm9pZCk7P1tcXHNcXC9dKyhbXFxkLl0rKT8vKSxcbiAgICBpcGFkID0gdWEubWF0Y2goLyhpUGFkKS4qT1NcXHMoW1xcZF9dKykvKSxcbiAgICBpcG9kID0gdWEubWF0Y2goLyhpUG9kKSguKk9TXFxzKFtcXGRfXSspKT8vKSxcbiAgICBpcGhvbmUgPSAhaXBhZCAmJiB1YS5tYXRjaCgvKGlQaG9uZVxcc09TKVxccyhbXFxkX10rKS8pO1xuXG53aW5kb3cuc2hhcmUgPSBuZXcgV3hNb21lbnQuU2hhcmUoKTtcblxuXG4vLyB3aW5kb3cuYW5kcm9pZD0hKGFuZHJvaWQmJmFuZHJvaWRbMl0gPD0gJzYnKTtcbndpbmRvdy5hbmRyb2lkPSFhbmRyb2lkO1xud2luZG93LmFuZHJvaWR2PXRydWU7XG4vLyB3aW5kb3cuYW5kcm9pZHY9IShhbmRyb2lkJiZhbmRyb2lkWzJdIDw9ICc2JykmJiFpcGhvbmU7XG5cblxuaWYoIXdpbmRvdy5hbmRyb2lkKXtcbiAgICAkKCcjbWF1ZGlvJykucmVtb3ZlKCk7XG4gICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcImJnYVwiKS5zdHlsZS5kaXNwbGF5PVwiYmxvY2tcIjtcbn1lbHNlIHtcbiAgICAkKCcjbWF1ZGlvJykucmVtb3ZlKCk7XG4gICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJiZzFcIikuc3R5bGUuZGlzcGxheT1cImJsb2NrXCI7XG59XG5cblxud2luZG93LmJhYnlzID0ge1xuICAgIE9uUmVzaXplOiBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHZhciBzY3JlZW5SYXRlID0gMTIwNiAvIDc1MDtcbiAgICAgICAgdmFyIG1XaWR0aDtcbiAgICAgICAgdmFyIG1IZWlnaHQ7XG4gICAgICAgIHZhciBzcHJpdGVTY2FsZTtcbiAgICAgICAgdmFyIGJnU2NhbGU7XG4gICAgICAgIC8v5qiq56uW5bGP5bmVXG4gICAgICAgIHZhciBtV2lkdGggPXdpbmRvdy5pbm5lcldpZHRoO1xuICAgICAgICB2YXIgbUhlaWdodCA9IHdpbmRvdy5pbm5lckhlaWdodDtcbiAgICAgICAgaWYgKChtSGVpZ2h0IC8gbVdpZHRoKSA+ICgxMjA2IC8gNzUwKSkge1xuICAgICAgICAgICAgbUhlaWdodCA9IHNjcmVlblJhdGUgKiBtV2lkdGg7XG4gICAgICAgICAgICB3aW5kb3cuc3ByaXRlU2NhbGUgPSBtV2lkdGggLyA3NTA7XG4gICAgICAgICAgICBiZ1NjYWxlID0gNzUwIC8gbVdpZHRoO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgbVdpZHRoID0gbUhlaWdodCAvIHNjcmVlblJhdGU7XG4gICAgICAgICAgICB3aW5kb3cuc3ByaXRlU2NhbGUgPSBtSGVpZ2h0IC8gMTIwNjtcbiAgICAgICAgICAgIGJnU2NhbGUgPSAxMjA2IC8gbUhlaWdodDtcbiAgICAgICAgfVxuICAgICAgICAkKFwiI3ZpZGVvX3dyYXBwZXJcIikuY3NzKHtcbiAgICAgICAgICAgIGxlZnQ6IDAsXG4gICAgICAgICAgICB3aWR0aDo3NTAsXG4gICAgICAgICAgICBoZWlnaHQ6IDU0OCxcbiAgICAgICAgICAgIFwidHJhbnNmb3JtXCI6IFwic2NhbGUoXCIgKyB3aW5kb3cuc3ByaXRlU2NhbGUgKyBcIilcIixcbiAgICAgICAgICAgIHRyYW5zZm9ybU9yaWdpbjogXCJsZWZ0IHRvcFwiLFxuICAgICAgICAgICAgdG9wOiAzMDAvMTIwNip3aW5kb3cuaW5uZXJIZWlnaHRcbiAgICAgICAgfSk7XG5cbiAgICAgICAgJChcIiNuYW1lX3dyYXBwZXJcIikuY3NzKHtcbiAgICAgICAgICAgIGxlZnQ6IFwiNTAlXCIsXG4gICAgICAgICAgICBtYXJnaW5MZWZ0OiAtbVdpZHRoIC8gMixcbiAgICAgICAgICAgIHdpZHRoOiA3NTAsXG4gICAgICAgICAgICBoZWlnaHQ6IDM4OCxcbiAgICAgICAgICAgIFwidHJhbnNmb3JtXCI6IFwic2NhbGUoXCIgKyB3aW5kb3cuc3ByaXRlU2NhbGUgKyBcIilcIixcbiAgICAgICAgICAgIHRyYW5zZm9ybU9yaWdpbjogXCJsZWZ0IHRvcFwiLFxuICAgICAgICAgICAgdG9wOiAzNzAvMTIwNip3aW5kb3cuaW5uZXJIZWlnaHRcbiAgICAgICAgfSk7XG5cblxuICAgIH0sXG4gICAgZXZlbnRJbml0OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHZhciB0aGF0ID0gdGhpcztcbiAgICAgICAgZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcigndG91Y2hzdGFydCcsIGZ1bmN0aW9uIChlKSB7XG4gICAgICAgIH0sIGZhbHNlKTtcbiAgICAgICAgZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcigndG91Y2htb3ZlJywgZnVuY3Rpb24gKGUpIHtcbiAgICAgICAgICAgIGUucHJldmVudERlZmF1bHQoKTtcbiAgICAgICAgfSwgZmFsc2UpO1xuICAgICAgICAvL+emgeatouW8ueWHuumAieaLqeiPnOWNlVxuICAgICAgICBkb2N1bWVudC5kb2N1bWVudEVsZW1lbnQuc3R5bGUud2Via2l0VG91Y2hDYWxsb3V0ID0gXCJub25lXCI7XG5cblxuICAgICAgICByZXR1cm4gdGhhdDtcbiAgICB9XG59O1xuXG5cbndpbmRvdy5iYWJ5cy5PblJlc2l6ZSgpO1xud2luZG93LmJhYnlzLmV2ZW50SW5pdCgpO1xuXG4vLyB3aW5kb3cuYmFieXMuaW5pdENaKCk7XG5cblxuXG5cblxuXG53aW5kb3cuZ2FtZSA9IG5ldyBQaGFzZXIuR2FtZSg3NTAsIDEyMDYsIFBoYXNlci5DQU5WQVMsICdiYWJ5c2lyaS1nYW1lJyxudWxsLHRydWUpO1xuXG5cblxud2luZG93LnBsYXllclN0YXRlID0ge1xuICAgIGN1cnJlbnRMZXZlbDogJ0dhbWUnXG59O1xuXG4vKlxuIOinhumikeW6j+WIl+W4p+eahOaJgOaciemFjee9ruWGmeWcqOi/memHjFxuICovXG53aW5kb3cucGhvbmUgPSBuZXcgVmlkZW9Db25maWcod2luZG93LmdhbWUsIFwiYXNzZXRzL3ZpZGVvL2J2My9cIiwgXCJidjNfXCIsIFwiLmpwZ1wiLCAwLCA5LCAzNzUsIDYwMywgMTUsIDEzOCwgMTUpO1xuXG52YXIgYnYxQz1uZXcgVmlkZW9Db25maWcod2luZG93LmdhbWUsIFwiYXNzZXRzL3ZpZGVvL2J2MS9cIiwgXCJidjFfXCIsIFwiLmpwZ1wiLCAwLCA5LCA2NzAsIDQ0MCwgMTIsIDExMSwgMTUpO1xudmFyIGJ2MkM9bmV3IFZpZGVvQ29uZmlnKHdpbmRvdy5nYW1lLCBcImFzc2V0cy92aWRlby9idjIvXCIsIFwiYnYyX1wiLCBcIi5qcGdcIiwgMCwgMTIsIDY3MCwgNDQwLCAxMiwgMTUzLCAxNSk7XG52YXIgYnY0Qz1uZXcgVmlkZW9Db25maWcod2luZG93LmdhbWUsIFwiYXNzZXRzL3ZpZGVvL2J2NC9cIiwgXCJidjRfXCIsIFwiLmpwZ1wiLCAwLCAzLCA2NzAsIDQ0MCwgMTIsIDQ2LCAxNSk7XG52YXIgYnY1Qz1uZXcgVmlkZW9Db25maWcod2luZG93LmdhbWUsIFwiYXNzZXRzL3ZpZGVvL2J2NS9cIiwgXCJidjVfXCIsIFwiLmpwZ1wiLCAwLCAxMCwgNjcwLCA0NDAsIDEyLCAxMzEsIDE1KTtcbnZhciBidjZDPW5ldyBWaWRlb0NvbmZpZyh3aW5kb3cuZ2FtZSwgXCJhc3NldHMvdmlkZW8vYnY2L1wiLCBcImJ2Nl9cIiwgXCIuanBnXCIsIDAsIDksIDY3MCwgNDQwLCAxMiwgMTEyLCAxNSk7XG52YXIgYnY3Qz1uZXcgVmlkZW9Db25maWcod2luZG93LmdhbWUsIFwiYXNzZXRzL3ZpZGVvL2J2Ny9cIiwgXCJidjdfXCIsIFwiLmpwZ1wiLCAwLCA3LCA2NzAsIDQ0MCwgMTIsIDkwLCAxNSk7XG52YXIgYnY4Qz1uZXcgVmlkZW9Db25maWcod2luZG93LmdhbWUsIFwiYXNzZXRzL3ZpZGVvL2J2OC9cIiwgXCJidjhfXCIsIFwiLmpwZ1wiLCAwLCA1LCA2NzAsIDQ0MCwgMTIsIDcxLCAxNSk7XG52YXIgYnYxMEM9bmV3IFZpZGVvQ29uZmlnKHdpbmRvdy5nYW1lLCBcImFzc2V0cy92aWRlby9idjEwL1wiLCBcImJ2MTBfXCIsIFwiLmpwZ1wiLCAwLCA0LCA2NzAsIDQ0MCwgMTIsIDUyLCAxNSk7XG52YXIgYnYxM0M9bmV3IFZpZGVvQ29uZmlnKHdpbmRvdy5nYW1lLCBcImFzc2V0cy92aWRlby9idjEzL1wiLCBcImJ2MTNfXCIsIFwiLmpwZ1wiLCAwLCA0LCA2NzAsIDQ0MCwgMTIsIDQ5LCAxNSk7XG52YXIgYnYxNEM9bmV3IFZpZGVvQ29uZmlnKHdpbmRvdy5nYW1lLCBcImFzc2V0cy92aWRlby9idjE0L1wiLCBcImJ2MTRfXCIsIFwiLmpwZ1wiLCAwLCAxMCwgNjcwLCA0NDAsIDEyLCAxMjcsIDE1KTtcbnZhciBidjE1Qz1uZXcgVmlkZW9Db25maWcod2luZG93LmdhbWUsIFwiYXNzZXRzL3ZpZGVvL2J2MTUvXCIsIFwiYnYxNV9cIiwgXCIuanBnXCIsIDAsIDQsIDY3MCwgNDQwLCAxMiwgNTMsIDE1KTtcbndpbmRvdy52ZW5kQz1uZXcgVmlkZW9Db25maWcod2luZG93LmdhbWUsIFwiYXNzZXRzL3ZpZGVvL3ZlbmQvXCIsIFwidmVuZF9cIiwgXCIuanBnXCIsIDAsIDE4LCA2NzAsIDQ0MCwgMTIsIDIyNSwgMTUpO1xuLy8gd2luZG93LmN6QyA9IG5ldyBWaWRlb0NvbmZpZyh3aW5kb3cuZ2FtZSwgXCJhc3NldHMvdmlkZW8vY3ovXCIsIFwiY3pfXCIsIFwiLmpwZ1wiLCAwLCA1LCAzNzUsIDYwMywgMTUsIDc2LCAxNSk7XG53aW5kb3cuYnZDb25maWdBcnJheSA9IFtudWxsLGJ2MUMsIGJ2MkMsIG51bGwsYnY0QywgYnY1QywgYnY2QywgYnY3QyxidjhDLG51bGwsYnYxMEMsbnVsbCxudWxsLGJ2MTNDLGJ2MTRDLGJ2MTVDXTtcblxuXG53aW5kb3cubnVtQXJyYXkgPSBuZXcgQXJyYXkoKTtcbmZvciAodmFyIGkgPSAwOyBpIDw9IDE3OyBpKyspIHtcbiAgICB3aW5kb3cubnVtQXJyYXlbaV0gPSBpO1xufVxud2luZG93Lm51bUFycmF5LnNvcnQoZnVuY3Rpb24gKCkge1xuICAgIHJldHVybiAwLjUgLSBNYXRoLnJhbmRvbSgpO1xufSk7XG53aW5kb3cucXVBcnJheSA9IFtcIuS9oOWPq+S7gOS5iOWQjeWtl++8n1wiLFwi57uZ5oiR6K6y5Liq5pWF5LqLXCIsIFwi5L2g5Lya566X5pyv5ZCX77yfXCIsIFwi5ZGK6K+J5oiR5LiA5Liq5bCP56eY5a+G5ZCnXCIsIFwi5oiR5aW955yL5ZCX77yfXCIsIFwi5L2g5Lya55S755S75ZCX77yfXCIsIFwi57uZ5oiR5ZSx6aaW5q2MXCIsIFwi5L2g54ix546p5LuA5LmI5ri45oiP5ZGA77yfXCIsXG4gICAgXCLkvaDllpzmrKLlkIPku4DkuYjmsLTmnpzvvJ9cIixcIuS7iuWkqeWkqeawlOaAjuS5iOagt++8n1wiLFwi57uT5ama5piv5LuA5LmI77yfXCIsXCLmiJHlpb3ml6DogYpcIixcIuaci+WPi+aYr+S7gOS5iFwiLFwi5L2g5Zac5qyi5oiR5ZCX77yfXCIsXCLmiorkvaDnmoTnjqnlhbfpgIHmiJHlkKdcIixcIueisOWIsOWdj+WPlOWPlOaAjuS5iOWKnu+8n1wiLFwi5L2g6ZW/5aSn5oOz5YGa5LuA5LmIXCIsXCLor7Tlj6XkuJzljJfor51cIl07XG53aW5kb3cuYXNBcnJheT0gW251bGwsXCLlpb3lkYDvvIzlsLHnnIvkvaDog73kuI3og73lkKzmh4LkuobjgIJcIixcIuS4gOS6lOW+l+S6lO+8jOS6jOS6lOS4gOWNge+8jOS4ieS6lO+8jOS4ieS6lCDigKZcIixcIuWYmO+8jOaIkeaChOaChOWRiuivieS9oOOAguW/q+aOpeeUteivne+8gVwiLG51bGwsXCLkvJrlkYBcIixudWxsLG51bGwsXG4gICAgXCLpmaTkuobmn6DmqqzmiJHpg73llpzmrKJcIiwgXCLkuIvpm6jllabvvIFcIixudWxsLFwi6YKj5oiR5Lus5bCx5Y675Liq5aW9546p55qE5Zyw5pa55ZCnXCIsbnVsbCxudWxsLG51bGwsbnVsbCxcIumVv+Wkp+WQjuaIkeWwseaYr1NpcmnllabjgIJcIixcIuWTjuWmiOWRgO+8jOaIkeWus+Wwj++8jOS4jeWSi+S8mue8qeivneWmru+8gVwiXVxud2luZG93LmVuZEFycmF5ID0gW1wi5L2g5Zac5qyi55yL5Yqo55S754mH5ZCX77yfXCIsIFwi5L2g5bmz5pe26YO96Lef6LCB5LiA6LW3546p5ZWK77yfXCIsXCLkvaDmnIDllpzmrKLnmoTmmI7mmJ/mmK/osIHllYrvvJ9cIixcIue7meaIkeWNluS4quiQjOWRl++8gVwiLFwi5YyX6by75p2l6Lef5oiR546p5LiA5Lya5YS/XCJdO1xuXG53aW5kb3cucXVHID0gMDtcbndpbmRvdy5oYXZlY2xpY2tlZD1mYWxzZTtcbndpbmRvdy5oYXZlY2hhbmdlZD1mYWxzZTtcbndpbmRvdy5oYXZlbmFtZWQ9ZmFsc2U7XG53aW5kb3cucGhvbmVfY2xpY2tlZD1mYWxzZTtcbndpbmRvdy5yZWFkQ291bnQ9MDtcbndpbmRvdy5oYXZlc2hhcmVkPWZhbHNlO1xud2luZG93LmdhbWUuc3RhdGUuYWRkKCdCb290JywgcmVxdWlyZSgnLi9zdGF0ZXMvYm9vdCcpKTtcbndpbmRvdy5nYW1lLnN0YXRlLmFkZCgnUHJlbG9hZGVyJywgcmVxdWlyZSgnLi9zdGF0ZXMvcHJlbG9hZGVyJykpO1xud2luZG93LmdhbWUuc3RhdGUuYWRkKCdIb21lJywgcmVxdWlyZSgnLi9zdGF0ZXMvaG9tZScpKTtcbndpbmRvdy5nYW1lLnN0YXRlLmFkZCgnR2FtZScsIHJlcXVpcmUoJy4vc3RhdGVzL2dhbWUnKSk7XG53aW5kb3cuZ2FtZS5zdGF0ZS5hZGQoJ01uYW1lJywgcmVxdWlyZSgnLi9zdGF0ZXMvbW5hbWUnKSk7XG53aW5kb3cuZ2FtZS5zdGF0ZS5hZGQoJ012b2ljZScsIHJlcXVpcmUoJy4vc3RhdGVzL212b2ljZScpKTtcbndpbmRvdy5nYW1lLnN0YXRlLmFkZCgnTXZpZGVvJywgcmVxdWlyZSgnLi9zdGF0ZXMvbXZpZGVvJykpO1xuXG53aW5kb3cuZ2FtZS5zdGF0ZS5hZGQoJ0VuZGluZycsIHJlcXVpcmUoJy4vc3RhdGVzL2VuZGluZycpKTtcbndpbmRvdy5nYW1lLnN0YXRlLnN0YXJ0KCdCb290Jyk7XG5cblxudmFyIGhtID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcInNjcmlwdFwiKTtcbmhtLnNyYyA9IFwiaHR0cDovL3RhanMucXEuY29tL3N0YXRzP3NJZD01Njg3NDc0MVwiO1xudmFyIHMgPSBkb2N1bWVudC5nZXRFbGVtZW50c0J5VGFnTmFtZShcInNjcmlwdFwiKVswXTtcbnMucGFyZW50Tm9kZS5pbnNlcnRCZWZvcmUoaG0sIHMpOyIsIihmdW5jdGlvbiAoKSB7XG4gICAgJ3VzZSBzdHJpY3QnO1xuXG4gICAgdmFyIEJvb3QgPSBmdW5jdGlvbiAoKSB7XG4gICAgfTtcblxuICAgIG1vZHVsZS5leHBvcnRzID0gQm9vdDtcblxuICAgIEJvb3QucHJvdG90eXBlID0ge1xuICAgICAgICBwcmVsb2FkOiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAvLyB0aGlzLmxvYWQuaW1hZ2UoJ3ByZWxvYWRlcicsICdhc3NldHMvcHJlbG9hZGVyLmdpZicpO1xuICAgICAgICAgICAgLy8gdGhpcy5sb2FkLnNwcml0ZXNoZWV0KCdsb2FkX3J1bicsICdhc3NldHMvaW1nL2xvYWRfbWFuLnBuZycsMTAwLDEwMCwxOCk7XG4gICAgICAgICAgICBpZighd2luZG93LmFuZHJvaWQpe1xuICAgICAgICAgICAgICAgIHRoaXMubG9hZC5pbWFnZSgnYmcnLCAnYXNzZXRzL2ltZy9iZzIuanBnJyk7XG4gICAgICAgICAgICAgICAgdGhpcy5sb2FkLmltYWdlKCdiZycsICdhc3NldHMvaW1nL2JnYS5qcGcnKTtcbiAgICAgICAgICAgICAgICB0aGlzLmxvYWQuc3ByaXRlc2hlZXQoJ2xvYWRlcl9hJywgJ2Fzc2V0cy9pbWcvbG9hZGVyX2EucG5nJywyNzAsMTQyLDMxKTtcbiAgICAgICAgICAgICAgICB0aGlzLmxvYWQuc3ByaXRlc2hlZXQoJ2x0JywgJ2Fzc2V0cy9pbWcvbHRfYS5wbmcnLCAyOTgsIDI4LCAzKTtcbiAgICAgICAgICAgIH1lbHNlIHtcbiAgICAgICAgICAgICAgICB0aGlzLmxvYWQuaW1hZ2UoJ2JnJywgJ2Fzc2V0cy9pbWcvYmcyLmpwZycpO1xuICAgICAgICAgICAgICAgIHRoaXMubG9hZC5pbWFnZSgnYmcnLCAnYXNzZXRzL2ltZy9iZzEuanBnJyk7XG4gICAgICAgICAgICAgICAgdGhpcy5sb2FkLnNwcml0ZXNoZWV0KCdsdCcsICdhc3NldHMvaW1nL2x0LnBuZycsIDIxOCwgMzIsIDQpO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgIH0sXG5cbiAgICAgICAgY3JlYXRlOiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICB2YXIgdGhhdCA9IHRoaXM7XG4gICAgICAgICAgICAvLyBjb25maWd1cmUgZ2FtZVxuICAgICAgICAgICAgdGhpcy5nYW1lLmlucHV0Lm1heFBvaW50ZXJzID0gMTtcblxuICAgICAgICAgICAgaWYgKHRoaXMuZ2FtZS5kZXZpY2UuZGVza3RvcCkge1xuICAgICAgICAgICAgICAgIHRoaXMuZ2FtZS5zY2FsZS5wYWdlQWxpZ25Ib3Jpem9udGFsbHkgPSB0cnVlO1xuICAgICAgICAgICAgfSBlbHNlIHtcblxuXG4gICAgICAgICAgICAgICAgaWYoIXdpbmRvdy5hbmRyb2lkKXtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5zY2FsZS5zY2FsZU1vZGUgPSBQaGFzZXIuU2NhbGVNYW5hZ2VyLlNIT1dfQUxMO1xuICAgICAgICAgICAgICAgICAgICAvLyB0aGlzLnNjYWxlLnBhZ2VBbGlnbkhvcml6b250YWxseSA9IHRydWU7XG4gICAgICAgICAgICAgICAgICAgIC8vIHRoaXMuc2NhbGUucGFnZUFsaWduVmVydGljYWxseSA9IHRydWU7XG4gICAgICAgICAgICAgICAgfWVsc2Uge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLnNjYWxlLnNjYWxlTW9kZSA9IFBoYXNlci5TY2FsZU1hbmFnZXIuVVNFUl9TQ0FMRTtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5zY2FsZS5zZXRVc2VyU2NhbGUod2luZG93LmlubmVyV2lkdGgvNzUwLHdpbmRvdy5pbm5lcldpZHRoLzc1MCwwLDApO1xuICAgICAgICAgICAgICAgIH1cblxuXG4gICAgICAgICAgICAgICAgLy8gJChcIiNiYWJ5c2lyaS1nYW1lXCIpLmZpbmQoXCJjYW52YXNcIikuY3NzKFwiYm90dG9tXCIsXCIwXCIpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdGhpcy5nYW1lLnN0YXRlLnN0YXJ0KCdQcmVsb2FkZXInKTtcbiAgICAgICAgfVxuXG4gICAgfTtcblxufSgpKTtcblxuIiwiLyoqXG4gKiBDcmVhdGVkIGJ5IHNhbmNoZXogb24gMTYvNi8xNS5cbiAqL1xuKGZ1bmN0aW9uICgpIHtcbiAgICAndXNlIHN0cmljdCc7XG4gICAgdmFyIE1vdmllQ2xpcCA9IHJlcXVpcmUoJy4uL2VudGl0aWVzL01vdmllQ2xpcCcpO1xuICAgIHZhciBFbmRpbmcgPSBmdW5jdGlvbiAoKSB7XG5cblxuICAgICAgICB0aGlzLmVuZGFzQXJyYXkgPSBbXG4gICAgICAgICAgICBbXCLmiJHllpzmrKLvvIxcIiwgXCLkvYbmmK/miJHmnIDllpzmrKLnnIvigJzmlL7lvIDmiJHljJfpvLvigJ3vvIFcIiwgXCLph4zpnaLmnInmiJHmnIDllpzmrKLnmoTlk6Xlk6Xku6zvvIFcIl0sXG4gICAgICAgICAgICBbXCLmiJHmnIDov5Hnu4/luLjlkozkuIDkuKrlsI/pspzogonlk6Xlk6XnjqnvvIxcIiwgXCLku5bov5jluKbmiJHkuIrnlLXop4bkuobvvIFcIiwgXCLkvaDmg7PkuI3mg7PnnIvnnIvllYrvvIFcIl0sXG4gICAgICAgICAgICBbXCLmiJHmnIDllpzmrKLnmoTmmI7mmJ/mnIDov5HmraPlnKjlvZXkuIDkuKroioLnm67vvIxcIiwgXCLlj6vigJzmlL7lvIDmiJHvvIzljJfpvLvigJ1cIiwgXCLnibnliKvlpb3nnIvvvIzkvaDlkozmiJHkuIDotbflkKfvvIFcIl0sXG4gICAgICAgICAgICBbXCLmiJHmnKzmnaXlsLHlvojokIzllYrvvIFcIiwgXCLmiJHnmoTlsI/kvJnkvLTku6zkuZ/lvojokIzvvIzlpoLmnpzkvaDmg7PnnIvnmoTor53vvIxcIiwgXCLmiJHku6zlnKjigJzmlL7lvIDmiJHljJfpvLvigJ3nrYnkvaDllYrvvIFcIl0sXG4gICAgICAgICAgICBbXCLmiJHlj6rmmK/kuKrmnLrlmajkurrvvIzmsqHlip7ms5Xot5/kvaDnjqnjgIJcIiwgXCLkuI3ov4fmiJHlkYror4nkvaDkuIDkuKrlpb3njqnnmoToioLnm67jgIJcIiwgXCLkuI3kvYbmnInlsI/ljJfpvLvvvIzov5jmnInlpb3lpJrlsI/pspzogonlkaLvvIFcIl0sXG4gICAgICAgICAgICBbXCLkvaDpl67popjlpb3lpJrllYrvvIzlpKfkurrnnJ/msqHmhI/mgJ3vvIxcIiwgXCLmg7PpgJfljJfpvLvov5jkuI3lpoLljrvnnIvnnItcIiwgXCLigJzmlL7lvIDmiJHvvIzljJfpvLvigJ3lkKfvvIFcIl1cbiAgICAgICAgXVxuXG4gICAgfTtcblxuICAgIG1vZHVsZS5leHBvcnRzID0gRW5kaW5nO1xuXG4gICAgRW5kaW5nLnByb3RvdHlwZSA9IHtcbiAgICAgICAgY3JlYXRlOiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICB2YXIgdGhhdCA9IHRoaXM7XG4gICAgICAgICAgICB3aW5kb3cuZW5kX24gPSAwO1xuXG4gICAgICAgICAgICB0aGlzLmJ2b2ljZV9zcHJpdGUgPSB0aGlzLmFkZC5zcHJpdGUoMzc1LCAxMjA2LCAnYnZvaWNlX3Nwcml0ZScpO1xuICAgICAgICAgICAgdGhpcy5idm9pY2Vfc3ByaXRlLmFuY2hvci5zZXRUbygwLjUsIDEpO1xuICAgICAgICAgICAgdGhpcy5idm9pY2Vfc3ByaXRlLmFuaW1hdGlvbnMuYWRkKCdzdGFydHAnLCBbMCwgMSwgMiwgMywgNCwgNSwgNiwgN10sIDE1LCBmYWxzZSk7XG4gICAgICAgICAgICB0aGlzLmJ2b2ljZV9zcHJpdGUuYW5pbWF0aW9ucy5hZGQoJ2xvb3BwJywgWzgsIDksIDEwLCAxMSwgMTIsIDEzLCAxNCwgMTUsIDE2LCAxNywgMTgsIDE5LCAyMCwgMjEsIDIyLCAyMywgMjQsIDI1LCAyNiwgMjddLCAxNSwgdHJ1ZSk7XG4gICAgICAgICAgICB0aGlzLmJ2b2ljZV9zcHJpdGUuYW5pbWF0aW9ucy5hZGQoJ2VuZHAnLCBbNywgNiwgNSwgNCwgMywgMiwgMSwgMF0sIDE1LCBmYWxzZSk7XG5cblxuICAgICAgICAgICAgdGhpcy5iYWNrX2J0biA9IHRoaXMuYWRkLnNwcml0ZSgzNzUsIDExMDYsICdiYWNrX2J0bicpO1xuICAgICAgICAgICAgdGhpcy5iYWNrX2J0bi5hbmNob3Iuc2V0VG8oMC41KTtcbiAgICAgICAgICAgIHRoaXMuYmFja19idG4uc2NhbGUuc2V0VG8oMCk7XG4gICAgICAgICAgICB0aGlzLmJhY2tfYnRuLmlucHV0RW5hYmxlZCA9IHRydWU7XG4gICAgICAgICAgICB0aGlzLmJhY2tfYnRuLmV2ZW50cy5vbklucHV0RG93bi5hZGRPbmNlKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICB0aGlzLmJhY2tfYnRuLmFscGhhID0gMC42O1xuICAgICAgICAgICAgfSwgdGhpcyk7XG4gICAgICAgICAgICB0aGlzLmJhY2tfYnRuLmV2ZW50cy5vbklucHV0VXAuYWRkT25jZShmdW5jdGlvbiAoKSB7XG5cbiAgICAgICAgICAgICAgICBpZighd2luZG93LmFuZHJvaWR8fHdpbmRvdy5hbmRyb2lkdil7XG4gICAgICAgICAgICAgICAgICAgIC8vIHZhciB2YXVkaW89JChcIiN2ZW5kXCIpWzBdO1xuICAgICAgICAgICAgICAgICAgICAvLyB2YXIgbXZkPSB0aGlzLnZhdWRpbztcbiAgICAgICAgICAgICAgICAgICAgdGhhdC52YXVkaW8ucGF1c2UoKTtcbiAgICAgICAgICAgICAgICAgICAgLy8gdGhpcy52YXVkaW8uc3JjID0gXCJcIjtcbiAgICAgICAgICAgICAgICAgICAgdGhhdC5idmlkZW8ucGF1c2UoKTtcbiAgICAgICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgfWVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAkKFwiI212aWRlb1wiKVswXS5wYXVzZSgpO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIGlmICh3aW5kb3cuaGF2ZXNoYXJlZCkge1xuICAgICAgICAgICAgICAgICAgICAkKFwiI212aWRlb1wiKVswXS5zcmMgPSBcIlwiO1xuICAgICAgICAgICAgICAgICAgICAkKFwiI212aWRlb1wiKVswXS5wb3N0ZXIgPSBcIlwiO1xuICAgICAgICAgICAgICAgICAgICAkKFwiI3ZpZGVvX3dyYXBwZXJcIikuY3NzKHtcbiAgICAgICAgICAgICAgICAgICAgICAgIFwiZGlzcGxheVwiOiBcIm5vbmVcIixcbiAgICAgICAgICAgICAgICAgICAgICAgIFwid2lkdGhcIjogMCxcbiAgICAgICAgICAgICAgICAgICAgICAgIFwiaGVpZ2h0XCI6IDAsXG4gICAgICAgICAgICAgICAgICAgICAgICBcInRvcFwiOiAzMDAgLzEyMDYqd2luZG93LmlubmVySGVpZ2h0XG4gICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICB0aGF0LmdhbWUuc3RhdGUuc3RhcnQoJ0dhbWUnKTtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIHdpbmRvdy5oYXZlc2hhcmVkID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICB2YXIgc2hhcmVfd3JhcHBlciA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwic2hhcmVfd3JhcHBlclwiKTtcbiAgICAgICAgICAgICAgICBzaGFyZV93cmFwcGVyLnN0eWxlLmRpc3BsYXkgPSBcImJsb2NrXCI7XG5cblxuICAgICAgICAgICAgICAgICQoXCIjc2Nsb3NlX2J0blwiKS5vbihcInRvdWNoc3RhcnRcIiwgZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgICAgICBUd2Vlbk1heC50byhzaGFyZV93cmFwcGVyLCAwLjQsIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIG9wYWNpdHk6IDAsIG9uQ29tcGxldGU6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzaGFyZV93cmFwcGVyLnN0eWxlLmRpc3BsYXkgPSBcIm5vbmVcIjtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzaGFyZV93cmFwcGVyLnN0eWxlLm9wYWNpdHkgPSAxO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoYXQuZ2FtZS5zdGF0ZS5zdGFydCgnR2FtZScpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICQoXCIjbXZpZGVvXCIpWzBdLnNyYyA9IFwiXCI7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgJChcIiNtdmlkZW9cIilbMF0ucG9zdGVyID0gXCJcIjtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAkKFwiI3ZpZGVvX3dyYXBwZXJcIikuY3NzKHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJkaXNwbGF5XCI6IFwibm9uZVwiLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcIndpZHRoXCI6IDAsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwiaGVpZ2h0XCI6IDAsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwidG9wXCI6IDMwMCAvMTIwNip3aW5kb3cuaW5uZXJIZWlnaHRcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICB0aGlzLmdhbWUudGltZS5ldmVudHMuYWRkKDUwMDAsIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICAgICAgVHdlZW5NYXgudG8oc2hhcmVfd3JhcHBlciwgMC40LCB7XG4gICAgICAgICAgICAgICAgICAgICAgICBvcGFjaXR5OiAwLCBvbkNvbXBsZXRlOiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgc2hhcmVfd3JhcHBlci5zdHlsZS5kaXNwbGF5ID0gXCJub25lXCI7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgc2hhcmVfd3JhcHBlci5zdHlsZS5vcGFjaXR5ID0gMTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGF0LmdhbWUuc3RhdGUuc3RhcnQoJ0dhbWUnKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAkKFwiI212aWRlb1wiKVswXS5zcmMgPSBcIlwiO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICQoXCIjbXZpZGVvXCIpWzBdLnBvc3RlciA9IFwiXCI7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgJChcIiN2aWRlb193cmFwcGVyXCIpLmNzcyh7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwiZGlzcGxheVwiOiBcIm5vbmVcIixcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJ3aWR0aFwiOiAwLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcImhlaWdodFwiOiAwLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcInRvcFwiOiAzMDAgLzEyMDYqd2luZG93LmlubmVySGVpZ2h0XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH0pXG5cbiAgICAgICAgICAgICAgICB9LCB0aGlzKTtcblxuXG4gICAgICAgICAgICB9LCB0aGlzKTtcblxuICAgICAgICAgICAgaWYgKHdpbmRvdy5xdWVzdGlvbl9ubyA9PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgICAgICB3aW5kb3cucXVlc3Rpb25fbm8gPTU7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGlmKCF3aW5kb3cuYW5kcm9pZHx8d2luZG93LmFuZHJvaWR2KXtcbiAgICAgICAgICAgICAgICB0aGlzLnFhdWRpbyA9IG5ldyBIb3dsKHtcbiAgICAgICAgICAgICAgICAgICAgc3JjOiBbJ2Fzc2V0cy9hdWRpby9lJyt3aW5kb3cucXVlc3Rpb25fbm8rJy5tcDMnXVxuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIHRoaXMudmF1ZGlvID0gbmV3IEhvd2woe1xuICAgICAgICAgICAgICAgICAgICBzcmM6IFsnYXNzZXRzL2F1ZGlvL3ZlbmQubXAzJ11cbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIC8vIHdpbmRvdy5xdWVzdGlvbl9ubyA9IDQ7XG4gICAgICAgICAgICAvLyBnYW1lLmFkZC50d2Vlbih0aGlzLmJhY2tfYnRuLnNjYWxlKS50byh7eDogMSwgeTogMX0sIDgwMCwgUGhhc2VyLkVhc2luZy5Cb3VuY2UuT3V0LCB0cnVlKTtcblxuICAgICAgICAgICAgaWYgKHdpbmRvdy5xdWVzdGlvbl9ubyAhPSA1KSB7XG4gICAgICAgICAgICAgICAgdGhpcy50MiA9IHRoaXMuYWRkLmJpdG1hcFRleHQoNzMzLCA2MywgJ2JhYnlmb250JywgJ+KAnCcgKyB3aW5kb3cuZW5kQXJyYXlbd2luZG93LnF1ZXN0aW9uX25vXSArICfigJ0nLCAzNik7XG4gICAgICAgICAgICAgICAgdGhpcy50Mi5hbmNob3Iuc2V0VG8oMSwgMCk7XG5cblxuICAgICAgICAgICAgICAgIHZhciBjMSA9IGdhbWUuYWRkLnR3ZWVuKHRoaXMudDIpLmZyb20oe1xuICAgICAgICAgICAgICAgICAgICB4OiA3NTAgKyAyMDAsXG4gICAgICAgICAgICAgICAgICAgIGFscGhhOiAwXG4gICAgICAgICAgICAgICAgfSwgODAwLCBQaGFzZXIuRWFzaW5nLkJvdW5jZS5PdXQsIHRydWUsIDIwKTtcblxuICAgICAgICAgICAgICAgIGMxLm9uQ29tcGxldGUuYWRkKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5xbG9hZGVyID0gdGhpcy5hZGQuc3ByaXRlKDEyMiwgMTgwLCAncWxvYWRlcicpO1xuICAgICAgICAgICAgICAgICAgICB0aGlzLnFsb2FkZXIuYW5jaG9yLnNldFRvKDAuNSk7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMucWxvYWRlci5zY2FsZS5zZXRUbygwLjUpO1xuXG4gICAgICAgICAgICAgICAgICAgIHRoaXMucWxfYWltID0gdGhpcy5xbG9hZGVyLmFuaW1hdGlvbnMuYWRkKCdxbCcsIFswLCAxLCAyLCAzLCA0LCA1LCA2LCA3LCA4LCA5LCAxMCwgMTEsIDAsIDEsIDIsIDMsIDQsIDUsIDYsIDcsIDgsIDksIDEwLCAxMSwgMCwgMSwgMiwgMywgNCwgNSwgNiwgNywgOCwgOSwgMTAsIDExLCAwLCAxLCAyLCAzLCA0LCA1LCA2LCA3LCA4LCA5LCAxMCwgMTFdKTtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5xbF9haW0ucGxheSgxNywgdHJ1ZSk7XG4gICAgICAgICAgICAgICAgICAgIGlmKCF3aW5kb3cuYW5kcm9pZHx8d2luZG93LmFuZHJvaWR2KXtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMucmVuZGVyTG9hZEEoKTtcbiAgICAgICAgICAgICAgICAgICAgfWVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5yZW5kZXJMb2FkKCk7XG4gICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIH0sIHRoaXMpO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICB0aGlzLnFsb2FkZXIgPSB0aGlzLmFkZC5zcHJpdGUoMTIyLCAxMjAsICdxbG9hZGVyJyk7XG4gICAgICAgICAgICAgICAgdGhpcy5xbG9hZGVyLmFuY2hvci5zZXRUbygwLjUpO1xuICAgICAgICAgICAgICAgIHRoaXMucWxvYWRlci5zY2FsZS5zZXRUbygwLjUpO1xuXG4gICAgICAgICAgICAgICAgdGhpcy5xbF9haW0gPSB0aGlzLnFsb2FkZXIuYW5pbWF0aW9ucy5hZGQoJ3FsJywgWzAsIDEsIDIsIDMsIDQsIDUsIDYsIDcsIDgsIDksIDEwLCAxMSwgMCwgMSwgMiwgMywgNCwgNSwgNiwgNywgOCwgOSwgMTAsIDExLCAwLCAxLCAyLCAzLCA0LCA1LCA2LCA3LCA4LCA5LCAxMCwgMTEsIDAsIDEsIDIsIDMsIDQsIDUsIDYsIDcsIDgsIDksIDEwLCAxMV0pO1xuICAgICAgICAgICAgICAgIHRoaXMucWxfYWltLnBsYXkoMTcsIHRydWUpO1xuICAgICAgICAgICAgICAgIGlmKCF3aW5kb3cuYW5kcm9pZHx8d2luZG93LmFuZHJvaWR2KXtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5yZW5kZXJMb2FkQSgpO1xuICAgICAgICAgICAgICAgIH1lbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5yZW5kZXJMb2FkKCk7XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICB9XG5cbiAgICAgICAgfSxcbiAgICAgICAgdXBkYXRlOiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICBpZiAod2luZG93LmhhdmVsb2FkZWQpIHtcbiAgICAgICAgICAgICAgICB3aW5kb3cuaGF2ZWxvYWRlZCA9IGZhbHNlO1xuICAgICAgICAgICAgICAgIHRoaXMucWxfYWltLnN0b3AoKTtcbiAgICAgICAgICAgICAgICAvLyB0aGlzLnFsX2FpbS5wbGF5KDE3LCBmYWxzZSk7XG4gICAgICAgICAgICAgICAgdGhpcy5xbG9hZGVyLmtpbGwoKTtcbiAgICAgICAgICAgICAgICBpZiAoIXdpbmRvdy5hbmRyb2lkfHx3aW5kb3cuYW5kcm9pZHYpIHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5zaG93QW5BKCk7XG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5zaG93QW4oKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgfSxcbiAgICAgICAgcmVuZGVyVmlkZW9IdG1sOiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICB2YXIgdGhhdCA9IHRoaXM7XG5cbiAgICAgICAgICAgICQoXCIjdmlkZW9fd3JhcHBlclwiKS5jc3Moe1wiZGlzcGxheVwiOiBcImJsb2NrXCIsIFwiaGVpZ2h0XCI6IDAsIFwid2lkdGhcIjogMH0pO1xuXG4gICAgICAgICAgICBUd2Vlbk1heC50bygkKFwiI3ZpZGVvX3dyYXBwZXJcIiksIDAuNCwge1xuICAgICAgICAgICAgICAgIHdpZHRoOiA3NTAsIGhlaWdodDogNTQ4LCBlYXNlOiBQb3dlcjIuZWFzZUluLCBvbkNvbXBsZXRlOiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgICAgIC8vIGNvbnNvbGUubG9nKFwicGxheVwiKTtcbiAgICAgICAgICAgICAgICAgICAgJChcIiNtdmlkZW9cIilbMF0ucGxheSgpO1xuICAgICAgICAgICAgICAgICAgICB0aGF0LnJlbmRlckxpbmtCdG4oKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KTtcblxuICAgICAgICB9LFxuICAgICAgICBzaG93QW5BOiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICB2YXIgdGhhdCA9IHRoaXM7XG4gICAgICAgICAgICAvLyB2YXIgdmF1ZGlvID0gJChcIiN2ZW5kXCIpWzBdO1xuICAgICAgICAgICAgdmFyIHZpZGVvX2JnID0gdGhpcy5hZGQuaW1hZ2UoMCwgMzgwLCAndmlkZW9fYmcnKTtcbiAgICAgICAgICAgIHZhciBtYXNrMiA9IGdhbWUuYWRkLmdyYXBoaWNzKDAsIDApO1xuICAgICAgICAgICAgbWFzazIuYmVnaW5GaWxsKDB4ZmZmZmZmKTtcbiAgICAgICAgICAgIG1hc2syLmRyYXdSZWN0KDAgLSA3NTAsIDM4MCAtIDU0OCwgNzUwLCA1NDgpO1xuICAgICAgICAgICAgbWFzazIuZW5kRmlsbCgpO1xuICAgICAgICAgICAgdmlkZW9fYmcubWFzayA9IG1hc2syO1xuICAgICAgICAgICAgaWYgKHdpbmRvdy5xdWVzdGlvbl9ubyAhPSA1KSB7XG5cbiAgICAgICAgICAgICAgICB2YXIgcXQxID0gdGhpcy5hZGQuYml0bWFwVGV4dCg0NCwgMTY0LCAnYmFieWZvbnQnLCB0aGlzLmVuZGFzQXJyYXlbd2luZG93LnF1ZXN0aW9uX25vXVswXSwgMzYpO1xuICAgICAgICAgICAgICAgIHZhciBxdDIgPSB0aGlzLmFkZC5iaXRtYXBUZXh0KDQ0LCAyMjcsICdiYWJ5Zm9udCcsIHRoaXMuZW5kYXNBcnJheVt3aW5kb3cucXVlc3Rpb25fbm9dWzFdLCAzNik7XG5cbiAgICAgICAgICAgICAgICB2YXIgdGwxPXRoaXMuYWRkLmltYWdlKDQ0LDE2NC0zMiwndF9sJyk7XG4gICAgICAgICAgICAgICAgdGwxLmFscGhhPTA7XG4gICAgICAgICAgICAgICAgdmFyICB0bDI9dGhpcy5hZGQuaW1hZ2UoNDQsMjI3LTMyLCd0X2wnKTtcbiAgICAgICAgICAgICAgICB0bDIuYWxwaGE9MDtcbiAgICAgICAgICAgICAgICB2YXIgdGwzPXRoaXMuYWRkLmltYWdlKDQ0LDI5MC0zMiwndF9sJyk7XG4gICAgICAgICAgICAgICAgdGwzLmFscGhhPTA7XG4gICAgICAgICAgICAgICAgdGhpcy5nYW1lLmFkZC50d2Vlbih0bDEpLnRvKHt4OiA2MDArNDQsYWxwaGE6WzEsMSwxLDEsMF19LCAxMDAwLCBQaGFzZXIuRWFzaW5nLlF1YXJ0aWMuT3V0LCB0cnVlLCAyMDApO1xuICAgICAgICAgICAgICAgIHRoaXMuZ2FtZS5hZGQudHdlZW4odGwyKS50byh7eDogNjIwKzQ0LGFscGhhOlsxLDEsMSwxLDBdfSwgMTAwMCwgUGhhc2VyLkVhc2luZy5RdWFydGljLk91dCwgdHJ1ZSwgMTAwMCk7XG4gICAgICAgICAgICAgICAgdGhpcy5nYW1lLmFkZC50d2Vlbih0bDMpLnRvKHt4OiA2MDArNDQsYWxwaGE6WzEsMSwxLDEsMF19LCAxMDAwLCBQaGFzZXIuRWFzaW5nLlF1YXJ0aWMuT3V0LCB0cnVlLCAxODAwKTtcbiAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICB0aGlzLm1hc2sxID0gZ2FtZS5hZGQuZ3JhcGhpY3MoMCwgMCk7XG4gICAgICAgICAgICAgICAgdGhpcy5tYXNrMS5iZWdpbkZpbGwoMHhmZmZmZmYpO1xuICAgICAgICAgICAgICAgIHRoaXMubWFzazEuZHJhd1JlY3QoNDQgLSA2MDAsIDE2NCwgNjAwLCA0MCk7XG4gICAgICAgICAgICAgICAgdGhpcy5tYXNrMS5lbmRGaWxsKCk7XG4gICAgICAgICAgICAgICAgcXQxLm1hc2sgPSB0aGlzLm1hc2sxO1xuXG4gICAgICAgICAgICAgICAgdGhpcy5tYXNrMiA9IGdhbWUuYWRkLmdyYXBoaWNzKDAsIDApO1xuICAgICAgICAgICAgICAgIHRoaXMubWFzazIuYmVnaW5GaWxsKDB4ZmZmZmZmKTtcbiAgICAgICAgICAgICAgICB0aGlzLm1hc2syLmRyYXdSZWN0KDQ0IC0gNjIwLCAyMjcsIDYyMCwgNDApO1xuICAgICAgICAgICAgICAgIHRoaXMubWFzazIuZW5kRmlsbCgpO1xuICAgICAgICAgICAgICAgIHF0Mi5tYXNrID0gdGhpcy5tYXNrMjtcbiAgICAgICAgICAgICAgICBcblxuICAgICAgICAgICAgICAgIGdhbWUuYWRkLnR3ZWVuKHRoaXMubWFzazEpLnRvKHt4OiA2MDB9LCAxMDAwLCBQaGFzZXIuRWFzaW5nLlF1YXJ0aWMuT3V0LCB0cnVlLCAyMDApO1xuICAgICAgICAgICAgICAgIGdhbWUuYWRkLnR3ZWVuKHRoaXMubWFzazIpLnRvKHt4OiA2MjB9LCAxMDAwLCBQaGFzZXIuRWFzaW5nLlF1YXJ0aWMuT3V0LCB0cnVlLCAxMDAwKTtcbiAgICAgICAgICAgICAgICB2YXIgcXQzID0gdGhpcy5hZGQuYml0bWFwVGV4dCg0NCwgMjkwLCAnYmFieWZvbnQnLCB0aGlzLmVuZGFzQXJyYXlbd2luZG93LnF1ZXN0aW9uX25vXVsyXSwgMzYpO1xuXG4gICAgICAgICAgICAgICAgdGhpcy5tYXNrMyA9IGdhbWUuYWRkLmdyYXBoaWNzKDAsIDApO1xuICAgICAgICAgICAgICAgIHRoaXMubWFzazMuYmVnaW5GaWxsKDB4ZmZmZmZmKTtcbiAgICAgICAgICAgICAgICB0aGlzLm1hc2szLmRyYXdSZWN0KDQ0IC0gNjAwLCAyOTAsIDYwMCwgNDApO1xuICAgICAgICAgICAgICAgIHRoaXMubWFzazMuZW5kRmlsbCgpO1xuICAgICAgICAgICAgICAgIHF0My5tYXNrID0gdGhpcy5tYXNrMztcbiAgICAgICAgICAgICAgICBcblxuICAgICAgICAgICAgICAgIGdhbWUuYWRkLnR3ZWVuKHRoaXMubWFzazMpLnRvKHt4OiA2MDB9LCAxMDAwLCBQaGFzZXIuRWFzaW5nLlF1YXJ0aWMuT3V0LCB0cnVlLCAxODAwKTtcblxuICAgICAgICAgICAgfSBlbHNlIHtcblxuICAgICAgICAgICAgICAgIHZhciBxdDEgPSB0aGlzLmFkZC5iaXRtYXBUZXh0KDQ0LCAxMDAsICdiYWJ5Zm9udCcsIHRoaXMuZW5kYXNBcnJheVt3aW5kb3cucXVlc3Rpb25fbm9dWzBdLCAzNik7XG4gICAgICAgICAgICAgICAgdmFyIHF0MiA9IHRoaXMuYWRkLmJpdG1hcFRleHQoNDQsIDE2NCwgJ2JhYnlmb250JywgdGhpcy5lbmRhc0FycmF5W3dpbmRvdy5xdWVzdGlvbl9ub11bMV0sIDM2KTtcbiAgICAgICAgICAgICAgICB2YXIgcXQzID0gdGhpcy5hZGQuYml0bWFwVGV4dCg0NCwgMjI3LCAnYmFieWZvbnQnLCB0aGlzLmVuZGFzQXJyYXlbd2luZG93LnF1ZXN0aW9uX25vXVsyXSwgMzYpO1xuXG4gICAgICAgICAgICAgICAgdmFyIHRsMT10aGlzLmFkZC5pbWFnZSg0NCwxMDAtMzIsJ3RfbCcpO1xuICAgICAgICAgICAgICAgIHRsMS5hbHBoYT0wO1xuICAgICAgICAgICAgICAgIHZhciAgdGwyPXRoaXMuYWRkLmltYWdlKDQ0LDE2NC0zMiwndF9sJyk7XG4gICAgICAgICAgICAgICAgdGwyLmFscGhhPTA7XG4gICAgICAgICAgICAgICAgdmFyIHRsMz10aGlzLmFkZC5pbWFnZSg0NCwyMjctMzIsJ3RfbCcpO1xuICAgICAgICAgICAgICAgIHRsMy5hbHBoYT0wO1xuICAgICAgICAgICAgICAgIHRoaXMuZ2FtZS5hZGQudHdlZW4odGwxKS50byh7eDogNjAwKzQ0LGFscGhhOlsxLDEsMSwxLDBdfSwgMTAwMCwgUGhhc2VyLkVhc2luZy5RdWFydGljLk91dCwgdHJ1ZSwgMjAwKTtcbiAgICAgICAgICAgICAgICB0aGlzLmdhbWUuYWRkLnR3ZWVuKHRsMikudG8oe3g6IDYyMCs0NCxhbHBoYTpbMSwxLDEsMSwwXX0sIDEwMDAsIFBoYXNlci5FYXNpbmcuUXVhcnRpYy5PdXQsIHRydWUsIDEwMDApO1xuICAgICAgICAgICAgICAgIHRoaXMuZ2FtZS5hZGQudHdlZW4odGwzKS50byh7eDogNjAwKzQ0LGFscGhhOlsxLDEsMSwxLDBdfSwgMTAwMCwgUGhhc2VyLkVhc2luZy5RdWFydGljLk91dCwgdHJ1ZSwgMTgwMCk7XG5cblxuXG4gICAgICAgICAgICAgICAgdGhpcy5tYXNrMSA9IGdhbWUuYWRkLmdyYXBoaWNzKDAsIDApO1xuICAgICAgICAgICAgICAgIHRoaXMubWFzazEuYmVnaW5GaWxsKDB4ZmZmZmZmKTtcbiAgICAgICAgICAgICAgICB0aGlzLm1hc2sxLmRyYXdSZWN0KDQ0IC0gNjAwLCAxMDAsIDYwMCwgNDApO1xuICAgICAgICAgICAgICAgIHRoaXMubWFzazEuZW5kRmlsbCgpO1xuICAgICAgICAgICAgICAgIHF0MS5tYXNrID0gdGhpcy5tYXNrMTtcblxuICAgICAgICAgICAgICAgIHRoaXMubWFzazIgPSBnYW1lLmFkZC5ncmFwaGljcygwLCAwKTtcbiAgICAgICAgICAgICAgICB0aGlzLm1hc2syLmJlZ2luRmlsbCgweGZmZmZmZik7XG4gICAgICAgICAgICAgICAgdGhpcy5tYXNrMi5kcmF3UmVjdCg0NCAtIDYwMCwgMTY0LCA2MDAsIDQwKTtcbiAgICAgICAgICAgICAgICB0aGlzLm1hc2syLmVuZEZpbGwoKTtcbiAgICAgICAgICAgICAgICBxdDIubWFzayA9IHRoaXMubWFzazI7XG5cbiAgICAgICAgICAgICAgICB0aGlzLm1hc2szID0gZ2FtZS5hZGQuZ3JhcGhpY3MoMCwgMCk7XG4gICAgICAgICAgICAgICAgdGhpcy5tYXNrMy5iZWdpbkZpbGwoMHhmZmZmZmYpO1xuICAgICAgICAgICAgICAgIHRoaXMubWFzazMuZHJhd1JlY3QoNDQgLSA2MDAsIDIyNywgNjAwLCA0MCk7XG4gICAgICAgICAgICAgICAgdGhpcy5tYXNrMy5lbmRGaWxsKCk7XG4gICAgICAgICAgICAgICAgcXQzLm1hc2sgPSB0aGlzLm1hc2szO1xuXG4gICAgICAgICAgICAgICAgZ2FtZS5hZGQudHdlZW4odGhpcy5tYXNrMSkudG8oe3g6IDYwMH0sIDEwMDAsIFBoYXNlci5FYXNpbmcuUXVhcnRpYy5PdXQsIHRydWUsIDIwMCk7XG4gICAgICAgICAgICAgICAgZ2FtZS5hZGQudHdlZW4odGhpcy5tYXNrMikudG8oe3g6IDYwMH0sIDEwMDAsIFBoYXNlci5FYXNpbmcuUXVhcnRpYy5PdXQsIHRydWUsIDEwMDApO1xuICAgICAgICAgICAgICAgIGdhbWUuYWRkLnR3ZWVuKHRoaXMubWFzazMpLnRvKHt4OiA2MDB9LCAxMDAwLCBQaGFzZXIuRWFzaW5nLlF1YXJ0aWMuT3V0LCB0cnVlLCAxODAwKTtcblxuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvL3BsYXkgYXVkaW9cbiAgICAgICAgICAgIC8vZW5kXG4gICAgICAgICAgICAvLyB2YXIgcWF1ZGlvID0gdGhpcy5hZGQuYXVkaW8oJ2UnK3dpbmRvdy5xdWVzdGlvbl9ubyk7XG4gICAgICAgICAgICAvLyBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcInFhdWRpb1wiKS5hZGRFdmVudExpc3RlbmVyKCdlbmRlZCcsZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgLy8gICAgIGFsZXJ0KFwiYWFhXCIpO1xuICAgICAgICAgICAgLy8gfSxmYWxzZSk7XG4gICAgICAgICAgICAvLyB2YXIgJGVuZGE9JChcIiNlbmRhXCIpO1xuICAgICAgICAgICAgLy8gdmFyICRlPSRlbmRhLmZpbmQoJy5lJyt3aW5kb3cucXVlc3Rpb25fbm8pO1xuICAgICAgICAgICAgXG4gICAgICAgICAgICB2YXIgYTEgPSB0aGlzLmJ2b2ljZV9zcHJpdGUucGxheSgnc3RhcnRwJyk7XG4gICAgICAgICAgICBhMS5vbkNvbXBsZXRlLmFkZChmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5idm9pY2Vfc3ByaXRlLnBsYXkoJ2xvb3BwJyk7XG4gICAgICAgICAgICB9LCB0aGlzKTtcbiAgICAgICAgICAgIC8vICRlWzBdLmN1cnJlbnRUaW1lPTA7XG4gICAgICAgICAgICAvLyAkZVswXS5wbGF5KCk7XG4gICAgICAgICAgICAvLyB0aGF0LnFhdWRpby5zZWVrKDApO1xuXG4gICAgICAgICAgICAvLyBxYXVkaW8ucGxheSgpO1xuICAgICAgICAgICAgLy8gdmFyIHZhdWRpbz0kKCcjdmVuZCcpWzBdO1xuICAgICAgICAgICAgdmFyIGVlbmRlZEg9ZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgIHRoYXQuYnZvaWNlX3Nwcml0ZS5wbGF5KCdlbmRwJyk7XG4gICAgICAgICAgICAgICAgdmFyIGJ2ZiA9IHRoYXQuYWRkLmltYWdlKDQwLCA1NCwgJ3ZlZicpO1xuICAgICAgICAgICAgICAgIHRoYXQuYnZpZGVvID0gbmV3IE1vdmllQ2xpcCh0aGF0LCA0MCwgNTQsIDY3MCwgNDQwLCB3aW5kb3cudmVuZEMsIGZ1bmN0aW9uICgpIHtcblxuICAgICAgICAgICAgICAgICAgICB0aGF0LnZhdWRpby5wYXVzZSgpO1xuICAgICAgICAgICAgICAgICAgICB0aGF0LnZhdWRpby5zZWVrKDApO1xuICAgICAgICAgICAgICAgICAgICB0aGF0LnZhdWRpby5wbGF5KCk7XG4gICAgICAgICAgICAgICAgICAgIC8vIHRoYXQudmF1ZGlvLnJlc3RhcnQoKTtcbiAgICAgICAgICAgICAgICAgICAgdGhhdC5idmlkZW8ucGxheVZpZGVvKCk7XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgdmlkZW9fYmcuYWRkQ2hpbGQoYnZmKTtcbiAgICAgICAgICAgICAgICB2aWRlb19iZy5hZGRDaGlsZCh0aGF0LmJ2aWRlbyk7XG5cblxuXG4gICAgICAgICAgICAgICAgdmFyIGMgPSBnYW1lLmFkZC50d2VlbihtYXNrMikudG8oe3g6IDc1MCwgeTogNTQ4fSwgODAwLCBQaGFzZXIuRWFzaW5nLlF1YXJ0aWMuT3V0LCB0cnVlLCA0MDApO1xuICAgICAgICAgICAgICAgIGMub25Db21wbGV0ZS5hZGQoZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgICAgICB0aGF0LnZhdWRpby5zZWVrKDApO1xuICAgICAgICAgICAgICAgICAgICB0aGF0LnZhdWRpby5wbGF5KCk7XG4gICAgICAgICAgICAgICAgICAgIHRoYXQuYnZpZGVvLnBsYXlWaWRlbygpO1xuICAgICAgICAgICAgICAgICAgICB0aGF0LnJlbmRlckxpbmtCdG4oKTtcbiAgICAgICAgICAgICAgICB9LCB0aGlzKTtcbiAgICAgICAgICAgICAgICAvLyAkZS51bmJpbmQoJ2VuZGVkJyxlZW5kZWRIKTtcbiAgICAgICAgICAgIH07XG4gICAgICAgICAgICAvLyAkZS5iaW5kKCdlbmRlZCcsZWVuZGVkSCk7XG5cbiAgICAgICAgICAgIHRoYXQucWF1ZGlvLm9uY2UoJ2VuZCcsZWVuZGVkSCk7XG4gICAgICAgICAgICB0aGF0LnFhdWRpby5wbGF5KCk7XG5cbiAgICAgICAgfSxcbiAgICAgICAgc2hvd0FuOiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICB2YXIgdGhhdD10aGlzO1xuICAgICAgICAgICAgaWYgKHdpbmRvdy5xdWVzdGlvbl9ubyAhPSA1KSB7XG4gICAgICAgICAgICAgICAgJChcIiN2aWRlb193cmFwcGVyXCIpLmNzcyhcInRvcFwiLCAzODAgLyAxMjA2ICogd2luZG93LmlubmVySGVpZ2h0KTtcbiAgICAgICAgICAgICAgICB2YXIgcXQxID0gdGhpcy5hZGQuYml0bWFwVGV4dCg0NCwgMTY0LCAnYmFieWZvbnQnLCB0aGlzLmVuZGFzQXJyYXlbd2luZG93LnF1ZXN0aW9uX25vXVswXSwgMzYpO1xuICAgICAgICAgICAgICAgIHZhciBxdDIgPSB0aGlzLmFkZC5iaXRtYXBUZXh0KDQ0LCAyMjcsICdiYWJ5Zm9udCcsIHRoaXMuZW5kYXNBcnJheVt3aW5kb3cucXVlc3Rpb25fbm9dWzFdLCAzNik7XG4gICAgICAgICAgICAgICAgdGhpcy5tYXNrMSA9IGdhbWUuYWRkLmdyYXBoaWNzKDAsIDApO1xuICAgICAgICAgICAgICAgIHRoaXMubWFzazEuYmVnaW5GaWxsKDB4ZmZmZmZmKTtcbiAgICAgICAgICAgICAgICB0aGlzLm1hc2sxLmRyYXdSZWN0KDQ0IC0gNjAwLCAxNjQsIDYwMCwgNDApO1xuICAgICAgICAgICAgICAgIHRoaXMubWFzazEuZW5kRmlsbCgpO1xuICAgICAgICAgICAgICAgIHF0MS5tYXNrID0gdGhpcy5tYXNrMTtcblxuICAgICAgICAgICAgICAgIHRoaXMubWFzazIgPSBnYW1lLmFkZC5ncmFwaGljcygwLCAwKTtcbiAgICAgICAgICAgICAgICB0aGlzLm1hc2syLmJlZ2luRmlsbCgweGZmZmZmZik7XG4gICAgICAgICAgICAgICAgdGhpcy5tYXNrMi5kcmF3UmVjdCg0NCAtIDYyMCwgMjI3LCA2MjAsIDQwKTtcbiAgICAgICAgICAgICAgICB0aGlzLm1hc2syLmVuZEZpbGwoKTtcbiAgICAgICAgICAgICAgICBxdDIubWFzayA9IHRoaXMubWFzazI7XG5cbiAgICAgICAgICAgICAgICB2YXIgdGwxPXRoaXMuYWRkLmltYWdlKDQ0LDE2NC0zMiwndF9sJyk7XG4gICAgICAgICAgICAgICAgdGwxLmFscGhhPTA7XG4gICAgICAgICAgICAgICAgdmFyICB0bDI9dGhpcy5hZGQuaW1hZ2UoNDQsMjI3LTMyLCd0X2wnKTtcbiAgICAgICAgICAgICAgICB0bDIuYWxwaGE9MDtcbiAgICAgICAgICAgICAgICB2YXIgdGwzPXRoaXMuYWRkLmltYWdlKDQ0LDI5MC0zMiwndF9sJyk7XG4gICAgICAgICAgICAgICAgdGwzLmFscGhhPTA7XG4gICAgICAgICAgICAgICAgdGhpcy5nYW1lLmFkZC50d2Vlbih0bDEpLnRvKHt4OiA2MDArNDQsYWxwaGE6WzEsMSwxLDEsMF19LCAxMDAwLCBQaGFzZXIuRWFzaW5nLlF1YXJ0aWMuT3V0LCB0cnVlLCAyMDApO1xuICAgICAgICAgICAgICAgIHRoaXMuZ2FtZS5hZGQudHdlZW4odGwyKS50byh7eDogNjIwKzQ0LGFscGhhOlsxLDEsMSwxLDBdfSwgMTAwMCwgUGhhc2VyLkVhc2luZy5RdWFydGljLk91dCwgdHJ1ZSwgMTAwMCk7XG4gICAgICAgICAgICAgICAgdGhpcy5nYW1lLmFkZC50d2Vlbih0bDMpLnRvKHt4OiA2MDArNDQsYWxwaGE6WzEsMSwxLDEsMF19LCAxMDAwLCBQaGFzZXIuRWFzaW5nLlF1YXJ0aWMuT3V0LCB0cnVlLCAxODAwKTtcblxuICAgICAgICAgICAgICAgIGdhbWUuYWRkLnR3ZWVuKHRoaXMubWFzazEpLnRvKHt4OiA2MDB9LCAxMDAwLCBQaGFzZXIuRWFzaW5nLlF1YXJ0aWMuT3V0LCB0cnVlLCAyMDApO1xuICAgICAgICAgICAgICAgIGdhbWUuYWRkLnR3ZWVuKHRoaXMubWFzazIpLnRvKHt4OiA2MjB9LCAxMDAwLCBQaGFzZXIuRWFzaW5nLlF1YXJ0aWMuT3V0LCB0cnVlLCAxMDAwKTtcbiAgICAgICAgICAgICAgICB2YXIgcXQzID0gdGhpcy5hZGQuYml0bWFwVGV4dCg0NCwgMjkwLCAnYmFieWZvbnQnLCB0aGlzLmVuZGFzQXJyYXlbd2luZG93LnF1ZXN0aW9uX25vXVsyXSwgMzYpO1xuXG4gICAgICAgICAgICAgICAgdGhpcy5tYXNrMyA9IGdhbWUuYWRkLmdyYXBoaWNzKDAsIDApO1xuICAgICAgICAgICAgICAgIHRoaXMubWFzazMuYmVnaW5GaWxsKDB4ZmZmZmZmKTtcbiAgICAgICAgICAgICAgICB0aGlzLm1hc2szLmRyYXdSZWN0KDQ0IC0gNjAwLCAyOTAsIDYwMCwgNDApO1xuICAgICAgICAgICAgICAgIHRoaXMubWFzazMuZW5kRmlsbCgpO1xuICAgICAgICAgICAgICAgIHF0My5tYXNrID0gdGhpcy5tYXNrMztcbiAgICAgICAgICAgICAgICBnYW1lLmFkZC50d2Vlbih0aGlzLm1hc2szKS50byh7eDogNjAwfSwgMTAwMCwgUGhhc2VyLkVhc2luZy5RdWFydGljLk91dCwgdHJ1ZSwgMTgwMCk7XG5cblxuICAgICAgICAgICAgICAgIC8vcGxheSBhdWRpb1xuICAgICAgICAgICAgICAgIC8vZW5kXG5cbiAgICAgICAgICAgICAgICB2YXIgJGVuZGE9JChcIiNlbmRhXCIpO1xuICAgICAgICAgICAgICAgIHZhciAkZT0kZW5kYS5maW5kKCcuZScrd2luZG93LnF1ZXN0aW9uX25vKTtcbiAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICB2YXIgZW5kZWRIYW5kbGVyID0gZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICAgICAgICAgIHRoYXQuYnZvaWNlX3Nwcml0ZS5wbGF5KCdlbmRwJyk7XG4gICAgICAgICAgICAgICAgICAgIHRoYXQucmVuZGVyVmlkZW9IdG1sKCk7XG4gICAgICAgICAgICAgICAgICAgICRlLnVuYmluZCgnZW5kZWQnLGVuZGVkSGFuZGxlcik7XG4gICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgICAkZS5iaW5kKCdlbmRlZCcsZW5kZWRIYW5kbGVyKTtcbiAgICAgICAgICAgICAgICAvLyB2YXIgcWF1ZGlvID0gdGhpcy5hZGQuYXVkaW8oJ2UnK3dpbmRvdy5xdWVzdGlvbl9ubyk7XG4gICAgICAgICAgICAgICAgLy8gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJxYXVkaW9cIikuYWRkRXZlbnRMaXN0ZW5lcignZW5kZWQnLGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICAvLyAgICAgYWxlcnQoXCJhYWFcIik7XG4gICAgICAgICAgICAgICAgLy8gfSxmYWxzZSk7XG4gICAgICAgICAgICAgICAgLy9wbGF5IGF1ZGlvXG4gICAgICAgICAgICAgICAgLy9lbmRcbiAgICAgICAgICAgICAgICB2YXIgYTEgPSB0aGlzLmJ2b2ljZV9zcHJpdGUucGxheSgnc3RhcnRwJyk7XG4gICAgICAgICAgICAgICAgYTEub25Db21wbGV0ZS5hZGQoZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLmJ2b2ljZV9zcHJpdGUucGxheSgnbG9vcHAnKTtcbiAgICAgICAgICAgICAgICB9LCB0aGlzKTtcbiAgICAgICAgICAgICAgICAkZVswXS5wbGF5KCk7XG4gICAgICAgICAgICAgICAgLy8gcWF1ZGlvLnBsYXkoKTtcbiAgICAgICAgICAgICAgICAvLyBxYXVkaW8ub25TdG9wLmFkZChmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgLy9cbiAgICAgICAgICAgICAgICAvLyB9LHRoaXMpO1xuXG5cbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgJChcIiN2aWRlb193cmFwcGVyXCIpLmNzcyhcInRvcFwiLCAzODEgLyAxMjA2ICogd2luZG93LmlubmVySGVpZ2h0KTtcbiAgICAgICAgICAgICAgICB2YXIgcXQxID0gdGhpcy5hZGQuYml0bWFwVGV4dCg0NCwgMTAwLCAnYmFieWZvbnQnLCB0aGlzLmVuZGFzQXJyYXlbd2luZG93LnF1ZXN0aW9uX25vXVswXSwgMzYpO1xuICAgICAgICAgICAgICAgIHZhciBxdDIgPSB0aGlzLmFkZC5iaXRtYXBUZXh0KDQ0LCAxNjQsICdiYWJ5Zm9udCcsIHRoaXMuZW5kYXNBcnJheVt3aW5kb3cucXVlc3Rpb25fbm9dWzFdLCAzNik7XG4gICAgICAgICAgICAgICAgdmFyIHF0MyA9IHRoaXMuYWRkLmJpdG1hcFRleHQoNDQsIDIyNywgJ2JhYnlmb250JywgdGhpcy5lbmRhc0FycmF5W3dpbmRvdy5xdWVzdGlvbl9ub11bMl0sIDM2KTtcblxuXG4gICAgICAgICAgICAgICAgdmFyIHRsMT10aGlzLmFkZC5pbWFnZSg0NCwxMDAtMzIsJ3RfbCcpO1xuICAgICAgICAgICAgICAgIHRsMS5hbHBoYT0wO1xuICAgICAgICAgICAgICAgIHZhciB0bDI9dGhpcy5hZGQuaW1hZ2UoNDQsMTY0LTMyLCd0X2wnKTtcbiAgICAgICAgICAgICAgICB0bDIuYWxwaGE9MDtcbiAgICAgICAgICAgICAgICB2YXIgdGwzPXRoaXMuYWRkLmltYWdlKDQ0LDIyNy0zMiwndF9sJyk7XG4gICAgICAgICAgICAgICAgdGwzLmFscGhhPTA7XG5cblxuXG4gICAgICAgICAgICAgICAgdGhpcy5tYXNrMSA9IGdhbWUuYWRkLmdyYXBoaWNzKDAsIDApO1xuICAgICAgICAgICAgICAgIHRoaXMubWFzazEuYmVnaW5GaWxsKDB4ZmZmZmZmKTtcbiAgICAgICAgICAgICAgICB0aGlzLm1hc2sxLmRyYXdSZWN0KDQ0IC0gNjAwLCAxMDAsIDYwMCwgNDApO1xuICAgICAgICAgICAgICAgIHRoaXMubWFzazEuZW5kRmlsbCgpO1xuICAgICAgICAgICAgICAgIHF0MS5tYXNrID0gdGhpcy5tYXNrMTtcblxuICAgICAgICAgICAgICAgIHRoaXMubWFzazIgPSBnYW1lLmFkZC5ncmFwaGljcygwLCAwKTtcbiAgICAgICAgICAgICAgICB0aGlzLm1hc2syLmJlZ2luRmlsbCgweGZmZmZmZik7XG4gICAgICAgICAgICAgICAgdGhpcy5tYXNrMi5kcmF3UmVjdCg0NCAtIDYwMCwgMTY0LCA2MDAsIDQwKTtcbiAgICAgICAgICAgICAgICB0aGlzLm1hc2syLmVuZEZpbGwoKTtcbiAgICAgICAgICAgICAgICBxdDIubWFzayA9IHRoaXMubWFzazI7XG5cbiAgICAgICAgICAgICAgICB0aGlzLm1hc2szID0gZ2FtZS5hZGQuZ3JhcGhpY3MoMCwgMCk7XG4gICAgICAgICAgICAgICAgdGhpcy5tYXNrMy5iZWdpbkZpbGwoMHhmZmZmZmYpO1xuICAgICAgICAgICAgICAgIHRoaXMubWFzazMuZHJhd1JlY3QoNDQgLSA2MDAsIDIyNywgNjAwLCA0MCk7XG4gICAgICAgICAgICAgICAgdGhpcy5tYXNrMy5lbmRGaWxsKCk7XG4gICAgICAgICAgICAgICAgcXQzLm1hc2sgPSB0aGlzLm1hc2szO1xuXG4gICAgICAgICAgICAgICAgdGhpcy5nYW1lLmFkZC50d2Vlbih0bDEpLnRvKHt4OiA2MDArNDQsYWxwaGE6WzEsMSwxLDBdfSwgMTAwMCwgUGhhc2VyLkVhc2luZy5RdWFydGljLk91dCwgdHJ1ZSwgMjAwKTtcbiAgICAgICAgICAgICAgICB0aGlzLmdhbWUuYWRkLnR3ZWVuKHRsMikudG8oe3g6IDYwMCs0NCxhbHBoYTpbMSwxLDEsMF19LCAxMDAwLCBQaGFzZXIuRWFzaW5nLlF1YXJ0aWMuT3V0LCB0cnVlLCAxMDAwKTtcbiAgICAgICAgICAgICAgICB0aGlzLmdhbWUuYWRkLnR3ZWVuKHRsMykudG8oe3g6IDYwMCs0NCxhbHBoYTpbMSwxLDEsMF19LCAxMDAwLCBQaGFzZXIuRWFzaW5nLlF1YXJ0aWMuT3V0LCB0cnVlLCAxODAwKTtcblxuICAgICAgICAgICAgICAgIGdhbWUuYWRkLnR3ZWVuKHRoaXMubWFzazEpLnRvKHt4OiA2MDB9LCAxMDAwLCBQaGFzZXIuRWFzaW5nLlF1YXJ0aWMuT3V0LCB0cnVlLCAyMDApO1xuICAgICAgICAgICAgICAgIGdhbWUuYWRkLnR3ZWVuKHRoaXMubWFzazIpLnRvKHt4OiA2MDB9LCAxMDAwLCBQaGFzZXIuRWFzaW5nLlF1YXJ0aWMuT3V0LCB0cnVlLCAxMDAwKTtcbiAgICAgICAgICAgICAgICBnYW1lLmFkZC50d2Vlbih0aGlzLm1hc2szKS50byh7eDogNjAwfSwgMTAwMCwgUGhhc2VyLkVhc2luZy5RdWFydGljLk91dCwgdHJ1ZSwgMTgwMCk7XG4gICAgICAgICAgICAgICAgLy9wbGF5IGF1ZGlvXG4gICAgICAgICAgICAgICAgLy9lbmRcblxuICAgICAgICAgICAgICAgIHZhciAkZW5kYT0kKFwiI2VuZGFcIik7XG4gICAgICAgICAgICAgICAgdmFyICRlPSRlbmRhLmZpbmQoJy5lJyt3aW5kb3cucXVlc3Rpb25fbm8pO1xuXG5cblxuICAgICAgICAgICAgICAgIHZhciBlbmRlZEhhbmRsZXIgPWZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICAgICAgdGhhdC5idm9pY2Vfc3ByaXRlLnBsYXkoJ2VuZHAnKTtcbiAgICAgICAgICAgICAgICAgICAgdGhhdC5yZW5kZXJWaWRlb0h0bWwoKTtcbiAgICAgICAgICAgICAgICAgICAgJGUudW5iaW5kKCdlbmRlZCcsZW5kZWRIYW5kbGVyKTtcbiAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgICRlLmJpbmQoJ2VuZGVkJyxlbmRlZEhhbmRsZXIpO1xuXG4gICAgICAgICAgICAgICAgLy8gdmFyIHFhdWRpbyA9IHRoaXMuYWRkLmF1ZGlvKCdlJyt3aW5kb3cucXVlc3Rpb25fbm8pO1xuICAgICAgICAgICAgICAgIC8vIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwicWF1ZGlvXCIpLmFkZEV2ZW50TGlzdGVuZXIoJ2VuZGVkJyxmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgLy8gICAgIGFsZXJ0KFwiYWFhXCIpO1xuICAgICAgICAgICAgICAgIC8vIH0sZmFsc2UpO1xuICAgICAgICAgICAgICAgIC8vcGxheSBhdWRpb1xuICAgICAgICAgICAgICAgIC8vZW5kXG4gICAgICAgICAgICAgICAgdmFyIGExID0gdGhpcy5idm9pY2Vfc3ByaXRlLnBsYXkoJ3N0YXJ0cCcpO1xuICAgICAgICAgICAgICAgIGExLm9uQ29tcGxldGUuYWRkKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5idm9pY2Vfc3ByaXRlLnBsYXkoJ2xvb3BwJyk7XG4gICAgICAgICAgICAgICAgfSwgdGhpcyk7XG5cbiAgICAgICAgICAgICAgICAkZVswXS5wbGF5KCk7XG4gICAgICAgICAgICAgICAgLy8gcWF1ZGlvLnBsYXkoKTtcbiAgICAgICAgICAgICAgICAvLyBxYXVkaW8ub25TdG9wLmFkZChmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgLy8gICAgIHRoaXMuYnZvaWNlX3Nwcml0ZS5wbGF5KCdlbmRwJyk7XG4gICAgICAgICAgICAgICAgLy8gICAgIHRoaXMucmVuZGVyVmlkZW9IdG1sKCk7XG4gICAgICAgICAgICAgICAgLy8gfSx0aGlzKTtcblxuICAgICAgICAgICAgfVxuXG4gICAgICAgIH0sXG4gICAgICAgIGJpbmQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHZhciB0aGF0ID0gdGhpcztcbiAgICAgICAgICAgIHZhciBtdmlkZW8gPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcIm12aWRlb1wiKTtcblxuICAgICAgICAgICAgZnVuY3Rpb24gdmlkZW9IYW5kbGVyKCkge1xuICAgICAgICAgICAgICAgIC8vIGNvbnNvbGUubG9nKFwiY2FucGxheXRocm91Z2hcIik7XG4gICAgICAgICAgICAgICAgd2luZG93LmhhdmVsb2FkZWQgPSB0cnVlO1xuICAgICAgICAgICAgICAgIG12aWRlby5yZW1vdmVFdmVudExpc3RlbmVyKFwiY2FucGxheXRocm91Z2hcIiwgdmlkZW9IYW5kbGVyKTtcblxuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBtdmlkZW8uYWRkRXZlbnRMaXN0ZW5lcihcImNhbnBsYXl0aHJvdWdoXCIsIHZpZGVvSGFuZGxlciwgZmFsc2UpO1xuICAgICAgICAgICAgJChcIiNtdmlkZW9cIilbMF0ubG9hZCgpO1xuICAgICAgICB9LFxuICAgICAgICByZW5kZXJMb2FkQTogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgdmFyIHRoYXQgPSB0aGlzO1xuICAgICAgICAgICAgdGhpcy5sb2FkLm9uTG9hZENvbXBsZXRlLmFkZE9uY2UoZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgIHdpbmRvdy5oYXZlbG9hZGVkID0gdHJ1ZTtcblxuICAgICAgICAgICAgfSwgdGhpcyk7XG4gICAgICAgICAgICAvLyB0aGlzLmxvYWQuYXVkaW8oJ2UnK3dpbmRvdy5xdWVzdGlvbl9ubyAsICdhc3NldHMvYXVkaW8vZScgKyB3aW5kb3cucXVlc3Rpb25fbm8gKyAnLm1wMycpO1xuXG4gICAgICAgICAgICAvLyB0aGlzLmxvYWQuYXVkaW8oJ2F1ZGlvJywgJ2Fzc2V0cy9hdWRpby9hdWRpbycgKyB3aW5kb3cucXVlc3Rpb25fbm8gKyAnLm1wMycpO1xuICAgICAgICAgICAgdGhpcy5sb2FkLmltYWdlKCd2ZWYnLCAnYXNzZXRzL3ZpZGVvL2VuZDEuanBnJyk7XG4gICAgICAgICAgICB0aGlzLmxvYWQuYXVkaW8oJ3ZlbmQnLCAnYXNzZXRzL2F1ZGlvL3ZlbmQubXAzJyk7XG4gICAgICAgICAgICB3aW5kb3cudmVuZEMucHJlbG9hZCgpO1xuXG4gICAgICAgICAgICB0aGlzLmxvYWQuc3RhcnQoKTtcbiAgICAgICAgfSxcbiAgICAgICAgcmVuZGVyTG9hZDogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgdmFyIHRoYXQgPSB0aGlzO1xuICAgICAgICAgICAgdGhpcy5sb2FkLm9uTG9hZENvbXBsZXRlLmFkZE9uY2UoZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgICQoXCIjbXZpZGVvXCIpWzBdLnNyYyA9IFwiLi9hc3NldHMvdmlkZW8vZW5kMS5tcDRcIjtcbiAgICAgICAgICAgICAgICAkKFwiI212aWRlb1wiKVswXS5wb3N0ZXIgPSBcIi4vYXNzZXRzL3ZpZGVvL2VuZDEuanBnXCI7XG4gICAgICAgICAgICAgICAgdGhhdC5iaW5kKCk7XG4gICAgICAgICAgICAgICAgLy8gJChcIiNtdmlkZW9cIilbMF0ucGxheSgpO1xuICAgICAgICAgICAgICAgIC8vICQoXCIjbXZpZGVvXCIpWzBdLnBhdXNlKCk7XG4gICAgICAgICAgICAgICAgLy8gd2luZG93LmhhdmVsb2FkZWQ9dHJ1ZTtcbiAgICAgICAgICAgIH0sIHRoaXMpO1xuICAgICAgICAgICAgdGhpcy5sb2FkLmF1ZGlvKCdlJyt3aW5kb3cucXVlc3Rpb25fbm8gLCAnYXNzZXRzL2F1ZGlvL2UnICsgd2luZG93LnF1ZXN0aW9uX25vICsgJy5tcDMnKTtcblxuICAgICAgICAgICAgdGhpcy5sb2FkLnN0YXJ0KCk7XG4gICAgICAgIH0sXG4gICAgICAgIHJlbmRlckxpbmtCdG46IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHZhciBsaW5rX2J0biA9IHRoaXMuYWRkLnNwcml0ZSgzNzUsIDk3NywgJ2xpbmtfYnRuJyk7XG4gICAgICAgICAgICBsaW5rX2J0bi5hbmNob3Iuc2V0VG8oMC41KTtcbiAgICAgICAgICAgIGxpbmtfYnRuLmFscGhhID0gMDtcbiAgICAgICAgICAgIC8vIGxpbmtfYnRuLnNjYWxlLnNldFRvKDEuNSk7XG5cbiAgICAgICAgICAgIGdhbWUuYWRkLnR3ZWVuKGxpbmtfYnRuKS50byh7YWxwaGE6IDF9LCA1MDAsIFBoYXNlci5FYXNpbmcuRXhwb25lbnRpYWwuSW4sIHRydWUsIDQwMCk7XG4gICAgICAgICAgICBnYW1lLmFkZC50d2VlbihsaW5rX2J0bi5zY2FsZSkuZnJvbSh7eDogMS41LCB5OiAxLjV9LCA1MDAsIFBoYXNlci5FYXNpbmcuRXhwb25lbnRpYWwuSW4sIHRydWUsIDQwMCk7XG4gICAgICAgICAgICBsaW5rX2J0bi5pbnB1dEVuYWJsZWQgPSB0cnVlO1xuICAgICAgICAgICAgbGlua19idG4uZXZlbnRzLm9uSW5wdXREb3duLmFkZE9uY2UoZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgIGxpbmtfYnRuLmFscGhhID0gMC42O1xuICAgICAgICAgICAgfSwgdGhpcyk7XG4gICAgICAgICAgICBsaW5rX2J0bi5ldmVudHMub25JbnB1dFVwLmFkZE9uY2UoZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgIHdpbmRvdy5sb2NhdGlvbi5ocmVmID0gXCJodHRwOi8vc2MucXEuY29tL2Z4L3U/cj1ITElkekRBJnQ9OVwiO1xuICAgICAgICAgICAgfSwgdGhpcyk7XG5cbiAgICAgICAgICAgIGdhbWUuYWRkLnR3ZWVuKHRoaXMuYmFja19idG4uc2NhbGUpLnRvKHt4OiAxLCB5OiAxfSwgMzAwLCBudWxsLCB0cnVlLCAxMzAwKTtcblxuICAgICAgICB9LFxuICAgICAgICByZW5kZXJWaWRlbzogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgdmFyIHZpZGVvX2dyb3VwID0gdGhpcy5hZGQuZ3JvdXAoKTtcblxuICAgICAgICAgICAgdmFyIGJnID0gdmlkZW9fZ3JvdXAuY3JlYXRlKDM3NSwgNjE1LCAndmlkZW9fYmcnKTtcbiAgICAgICAgICAgIGJnLmFuY2hvci5zZXRUbygwLjUpO1xuXG4gICAgICAgICAgICB2YXIgZXZpZGVvID0gdmlkZW9fZ3JvdXAuY3JlYXRlKDM3NSwgNjE1LCAnZXZpZGVvJyk7XG4gICAgICAgICAgICBldmlkZW8uYW5jaG9yLnNldFRvKDAuNSk7XG5cbiAgICAgICAgICAgIHZhciBjMSA9IGdhbWUuYWRkLnR3ZWVuKHZpZGVvX2dyb3VwKS5mcm9tKHthbHBoYTogMH0sIDEwMDAsIFBoYXNlci5FYXNpbmcuUXVhcnRpYy5PdXQsIHRydWUpO1xuXG4gICAgICAgICAgICB2YXIgbGlua19idG4gPSB0aGlzLmFkZC5zcHJpdGUoMzc1LCA5NzcsICdsaW5rX2J0bicpO1xuICAgICAgICAgICAgbGlua19idG4uYW5jaG9yLnNldFRvKDAuNSk7XG4gICAgICAgICAgICBsaW5rX2J0bi5hbHBoYSA9IDA7XG4gICAgICAgICAgICAvLyBsaW5rX2J0bi5zY2FsZS5zZXRUbygxLjUpO1xuXG4gICAgICAgICAgICBnYW1lLmFkZC50d2VlbihsaW5rX2J0bikudG8oe2FscGhhOiAxfSwgNTAwLCBQaGFzZXIuRWFzaW5nLkV4cG9uZW50aWFsLkluLCB0cnVlLCA0MDApO1xuICAgICAgICAgICAgZ2FtZS5hZGQudHdlZW4obGlua19idG4uc2NhbGUpLmZyb20oe3g6IDEuNSwgeTogMS41fSwgNTAwLCBQaGFzZXIuRWFzaW5nLkV4cG9uZW50aWFsLkluLCB0cnVlLCA0MDApO1xuICAgICAgICAgICAgbGlua19idG4uaW5wdXRFbmFibGVkID0gdHJ1ZTtcbiAgICAgICAgICAgIGxpbmtfYnRuLmV2ZW50cy5vbklucHV0RG93bi5hZGRPbmNlKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICBsaW5rX2J0bi5hbHBoYSA9IDAuNjtcbiAgICAgICAgICAgIH0sIHRoaXMpO1xuICAgICAgICAgICAgbGlua19idG4uZXZlbnRzLm9uSW5wdXRVcC5hZGRPbmNlKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICB3aW5kb3cubG9jYXRpb24uaHJlZiA9IFwiXCI7XG4gICAgICAgICAgICB9LCB0aGlzKTtcblxuXG4gICAgICAgIH1cbiAgICB9O1xufSgpKTsiLCIoZnVuY3Rpb24gKCkge1xuICAgICd1c2Ugc3RyaWN0JztcblxuXG4gICAgdmFyIFF1ZXN0aW9uQnRuID0gcmVxdWlyZSgnLi4vZW50aXRpZXMvUXVlc3Rpb25CdG4nKTtcbiAgICB2YXIgR2FtZSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdGhpcy5xdTEgPSBudWxsO1xuICAgICAgICB0aGlzLnF1MiA9IG51bGw7XG4gICAgICAgIHRoaXMucXUzID0gbnVsbDtcbiAgICAgICAgdGhpcy5xdTQgPSBudWxsO1xuICAgICAgICB0aGlzLnF1NSA9IG51bGw7XG5cbiAgICB9O1xuXG4gICAgbW9kdWxlLmV4cG9ydHMgPSBHYW1lO1xuXG4gICAgR2FtZS5wcm90b3R5cGUgPSB7XG4gICAgICAgIGNyZWF0ZTogZnVuY3Rpb24gKCkge1xuXG4gICAgICAgICAgICBpZighd2luZG93LmhhdmVjbGlja2VkKXtcbiAgICAgICAgICAgICAgICBpZighd2luZG93LmFuZHJvaWR8fHdpbmRvdy5hbmRyb2lkdil7XG4gICAgICAgICAgICAgICAgICAgIHZhciBnMSA9IG5ldyBIb3dsKHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHNyYzogWydhc3NldHMvYXVkaW8vZzEubXAzJ11cbiAgICAgICAgICAgICAgICAgICAgfSkucGxheSgpO1xuICAgICAgICAgICAgICAgIH1lbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgdmFyICRnMT0kKFwiI2cxXCIpO1xuICAgICAgICAgICAgICAgICAgICAkZzFbMF0ucGxheSgpO1xuXG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgLy8gJGcxLnJlbW92ZSgpO1xuICAgICAgICAgICAgICAgIC8vIHZhciBnMT10aGlzLmFkZC5hdWRpbygnZzEnKTtcbiAgICAgICAgICAgICAgICAvLyBnMS5wbGF5KCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZighd2luZG93LmFuZHJvaWR8fHdpbmRvdy5hbmRyb2lkdil7XG4gICAgICAgICAgICAgICAgdmFyIGVycjAgPSBuZXcgSG93bCh7XG4gICAgICAgICAgICAgICAgICAgIHNyYzogWydhc3NldHMvYXVkaW8vZXJyMC5tcDMnXVxuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIHZhciBlcnIxID0gbmV3IEhvd2woe1xuICAgICAgICAgICAgICAgICAgICBzcmM6IFsnYXNzZXRzL2F1ZGlvL2VycjEubXAzJ11cbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICB2YXIgZXJyMiA9IG5ldyBIb3dsKHtcbiAgICAgICAgICAgICAgICAgICAgc3JjOiBbJ2Fzc2V0cy9hdWRpby9lcnIyLm1wMyddXG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIHZhciBlcnJBcnJheT1bZXJyMSxlcnIyLGVycjBdO1xuICAgICAgICAgICAgdmFyIGVycm9yMT10aGlzLmFkZC5pbWFnZSgwLDApO1xuICAgICAgICAgICAgZXJyb3IxLndpZHRoPTc1MDtcbiAgICAgICAgICAgIGVycm9yMS5oZWlnaHQ9MjIwO1xuICAgICAgICAgICAgdmFyIGVycm9yMj10aGlzLmFkZC5pbWFnZSgwLDIyMCk7XG4gICAgICAgICAgICBlcnJvcjIud2lkdGg9MTIwO1xuICAgICAgICAgICAgZXJyb3IyLmhlaWdodD0xMDAwO1xuICAgICAgICAgICAgdmFyIGVycm9yMz10aGlzLmFkZC5pbWFnZSg2MzAsMjIwKTtcbiAgICAgICAgICAgIGVycm9yMy53aWR0aD0xMjA7XG4gICAgICAgICAgICBlcnJvcjMuaGVpZ2h0PTEwMDA7XG5cbiAgICAgICAgICAgIGVycm9yMS5pbnB1dEVuYWJsZWQ9dHJ1ZTtcbiAgICAgICAgICAgIGVycm9yMi5pbnB1dEVuYWJsZWQ9dHJ1ZTtcbiAgICAgICAgICAgIGVycm9yMy5pbnB1dEVuYWJsZWQ9dHJ1ZTtcbiAgICAgICAgICAgIHZhciAkZXJyPSQoJyNlcnJhJyk7XG4gICAgICAgICAgICB2YXIgZXJyb3JBdWRpbz1mdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgdmFyIGVyYW5kPU1hdGguZmxvb3IoTWF0aC5yYW5kb20oKSozKTtcbiAgICAgICAgICAgICAgICBpZighd2luZG93LmFuZHJvaWR8fHdpbmRvdy5hbmRyb2lkdil7XG4gICAgICAgICAgICAgICAgICAgIGVyckFycmF5W2VyYW5kXS5wbGF5KCk7XG4gICAgICAgICAgICAgICAgfWVsc2Uge1xuXG4gICAgICAgICAgICAgICAgICAgICRlcnIuZmluZCgnLmVycicrZXJhbmQpWzBdLnBsYXkoKTtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIH07XG4gICAgICAgICAgICBcbiAgICAgICAgICAgIGVycm9yMS5ldmVudHMub25JbnB1dERvd24uYWRkKGVycm9yQXVkaW8sdGhpcyk7XG4gICAgICAgICAgICBlcnJvcjIuZXZlbnRzLm9uSW5wdXREb3duLmFkZChlcnJvckF1ZGlvLHRoaXMpO1xuICAgICAgICAgICAgZXJyb3IzLmV2ZW50cy5vbklucHV0RG93bi5hZGQoZXJyb3JBdWRpbyx0aGlzKTtcblxuXG5cbiAgICAgICAgICAgIHZhciBnYW1lX3RpdGxlID0gdGhpcy5hZGQuc3ByaXRlKDM3NSwgMTM1LCAnZ2FtZV90aXRsZScpO1xuICAgICAgICAgICAgZ2FtZV90aXRsZS5hbmNob3Iuc2V0VG8oMC41KTtcblxuICAgICAgICAgICAgdGhpcy5jaG9vc2VRdSgpO1xuICAgICAgICAgICAgdGhpcy5jaGFuZ2VfZ3JvdXAgPSB0aGlzLmFkZC5ncm91cCgpO1xuICAgICAgICAgICAgdGhpcy5jaGFuZ2VfZ3JvdXAuYWxwaGEgPSAwO1xuICAgICAgICAgICAgdGhpcy5jaGFuZ2VfYnRuID0gdGhpcy5jaGFuZ2VfZ3JvdXAuY3JlYXRlKDM3NSwgMTEyMSwgJ2NoYW5nZV9idG4nKTtcbiAgICAgICAgICAgIHRoaXMuY2hhbmdlX2J0bi5hbmNob3Iuc2V0VG8oMC41KTtcbiAgICAgICAgICAgIHRoaXMuY2hhbmdlX2J0bi5hbmltYXRpb25zLmFkZCgnY2J0bicpLnBsYXkoMTUsdHJ1ZSk7XG4gICAgICAgICAgICB0aGlzLmNoYW5nZV9idG4uZXZlbnRzLm9uSW5wdXREb3duLmFkZChmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5jaGFuZ2VfYnRuLmFscGhhPTAuNjtcbiAgICAgICAgICAgIH0sdGhpcyk7XG4gICAgICAgICAgICB0aGlzLmNoYW5nZV9idG4uZXZlbnRzLm9uSW5wdXRVcC5hZGQoZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgIHRoaXMuY2hhbmdlX2J0bi5hbHBoYT0xO1xuICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKFwiQ2hhbmdlIFF1XCIpO1xuICAgICAgICAgICAgICAgIGlmKHdpbmRvdy5oYXZlY2xpY2tlZClcbiAgICAgICAgICAgICAgICAgICAgd2luZG93LmhhdmVjaGFuZ2VkID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICB0aGlzLmNoYW5nZV9idG4uaW5wdXRFbmFibGVkID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgaWYgKHRoaXMuZW5kX2kgIT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuZW5kX2kua2lsbCgpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB2YXIgYzEgPSB0aGlzLmFkZC50d2Vlbih0aGlzLnF1MS5tcXVlc3Rpb24pLnRvKHt4OiA3NTAgKyAzNzV9LCA2MDAsIFBoYXNlci5FYXNpbmcuUXVhcnRpYy5PdXQsIHRydWUsIDEwMCk7XG4gICAgICAgICAgICAgICAgdmFyIGMyID0gdGhpcy5hZGQudHdlZW4odGhpcy5xdTIubXF1ZXN0aW9uKS50byh7eDogLTM3NX0sIDYwMCwgUGhhc2VyLkVhc2luZy5RdWFydGljLk91dCwgdHJ1ZSwgMzAwKTtcbiAgICAgICAgICAgICAgICB2YXIgYzMgPSB0aGlzLmFkZC50d2Vlbih0aGlzLnF1My5tcXVlc3Rpb24pLnRvKHt4OiA3NTAgKyAzNzV9LCA2MDAsIFBoYXNlci5FYXNpbmcuUXVhcnRpYy5PdXQsIHRydWUsIDQ1MCk7XG4gICAgICAgICAgICAgICAgdmFyIGM0ID0gdGhpcy5hZGQudHdlZW4odGhpcy5xdTQubXF1ZXN0aW9uKS50byh7eDogLTM3NX0sIDYwMCwgUGhhc2VyLkVhc2luZy5RdWFydGljLk91dCwgdHJ1ZSwgNjAwKTtcbiAgICAgICAgICAgICAgICB2YXIgYzUgPSB0aGlzLmFkZC50d2Vlbih0aGlzLnF1NS5tcXVlc3Rpb24pLnRvKHt4OiA3NTAgKyAzNzV9LCA2MDAsIFBoYXNlci5FYXNpbmcuUXVhcnRpYy5PdXQsIHRydWUsIDcwMCk7XG4gICAgICAgICAgICAgICAgYzUub25Db21wbGV0ZS5hZGQoZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLnF1MS5tZGVzdHJveSgpO1xuICAgICAgICAgICAgICAgICAgICB0aGlzLnF1Mi5tZGVzdHJveSgpO1xuICAgICAgICAgICAgICAgICAgICB0aGlzLnF1My5tZGVzdHJveSgpO1xuICAgICAgICAgICAgICAgICAgICB0aGlzLnF1NC5tZGVzdHJveSgpO1xuICAgICAgICAgICAgICAgICAgICB0aGlzLnF1NS5tZGVzdHJveSgpO1xuXG4gICAgICAgICAgICAgICAgICAgIGlmICh3aW5kb3cucXVHID49IDEyKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB3aW5kb3cucXVHID0gMDtcbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHdpbmRvdy5xdUcgKz0gNDtcbiAgICAgICAgICAgICAgICAgICAgfVxuXG5cbiAgICAgICAgICAgICAgICAgICAgdGhpcy5jaG9vc2VRdSgpO1xuICAgICAgICAgICAgICAgICAgICB0aGlzLmVudGVyUXUoKTtcblxuICAgICAgICAgICAgICAgIH0sIHRoaXMpO1xuXG5cbiAgICAgICAgICAgIH0sIHRoaXMpO1xuXG4gICAgICAgICAgICB2YXIgYnRuX2EzID0gdGhpcy5jaGFuZ2VfZ3JvdXAuY3JlYXRlKDQ4MywgMTEyMSwgJ2J0bl9hcnJvdycpO1xuICAgICAgICAgICAgYnRuX2EzLmFuY2hvci5zZXRUbygwLjUpO1xuICAgICAgICAgICAgdmFyIGJ0bl9hNCA9IHRoaXMuY2hhbmdlX2dyb3VwLmNyZWF0ZSg0OTcsIDExMjEsICdidG5fYXJyb3cnKTtcbiAgICAgICAgICAgIGJ0bl9hNC5hbmNob3Iuc2V0VG8oMC41KTtcbiAgICAgICAgICAgIC8vIGJ0bl9hNC5hbHBoYT0wLjU7XG5cbiAgICAgICAgICAgIHZhciBidG5fYTEgPSB0aGlzLmNoYW5nZV9ncm91cC5jcmVhdGUoMjQyLCAxMTIxLCAnYnRuX2Fycm93Jyk7XG4gICAgICAgICAgICBidG5fYTEuYW5jaG9yLnNldFRvKDAuNSk7XG4gICAgICAgICAgICBidG5fYTEuYW5nbGUgPSAxODA7XG4gICAgICAgICAgICAvLyBidG5fYTEuYWxwaGE9MC41O1xuICAgICAgICAgICAgdmFyIGJ0bl9hMiA9IHRoaXMuY2hhbmdlX2dyb3VwLmNyZWF0ZSgyNTYsIDExMjEsICdidG5fYXJyb3cnKTtcbiAgICAgICAgICAgIGJ0bl9hMi5hbmNob3Iuc2V0VG8oMC41KTtcbiAgICAgICAgICAgIGJ0bl9hMi5hbmdsZSA9IDE4MDtcblxuICAgICAgICAgICAgdGhpcy5nYW1lLmFkZC50d2VlbihidG5fYTMpLnRvKHthbHBoYTogMH0sIDQwMCwgbnVsbCwgdHJ1ZSwgMCwgLTEsIHRydWUpO1xuICAgICAgICAgICAgdGhpcy5nYW1lLmFkZC50d2VlbihidG5fYTIpLnRvKHthbHBoYTogMH0sIDQwMCwgbnVsbCwgdHJ1ZSwgMCwgLTEsIHRydWUpO1xuICAgICAgICAgICAgdGhpcy5nYW1lLmFkZC50d2VlbihidG5fYTQpLnRvKHthbHBoYTogMH0sIDQwMCwgbnVsbCwgdHJ1ZSwgNDAwLCAtMSwgdHJ1ZSk7XG4gICAgICAgICAgICB0aGlzLmdhbWUuYWRkLnR3ZWVuKGJ0bl9hMSkudG8oe2FscGhhOiAwfSwgNDAwLCBudWxsLCB0cnVlLCA0MDAsIC0xLCB0cnVlKTtcblxuXG4gICAgICAgICAgICB2YXIgYzEgPSB0aGlzLmFkZC50d2VlbihnYW1lX3RpdGxlKS5mcm9tKHt5OiA2MDAsIGFscGhhOiAwfSwgNjAwLCBQaGFzZXIuRWFzaW5nLlF1YXJ0aWMuT3V0LCB0cnVlLCAzMDApO1xuICAgICAgICAgICAgYzEub25Db21wbGV0ZS5hZGQoZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgIHRoaXMuZW50ZXJRdSgpO1xuICAgICAgICAgICAgfSwgdGhpcyk7XG5cblxuICAgICAgICB9LFxuICAgICAgICBjaG9vc2VRdTogZnVuY3Rpb24gKGYpIHtcbiAgICAgICAgICAgIGlmICghd2luZG93LmhhdmVjbGlja2VkIHx8ICF3aW5kb3cuaGF2ZWNoYW5nZWQpIHtcbiAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgIHRoaXMucXUxID0gbmV3IFF1ZXN0aW9uQnRuKHRoaXMuZ2FtZSwgMCwgMzMzLCB3aW5kb3cucXVHKTtcbiAgICAgICAgICAgICAgICB0aGlzLnF1MiA9IG5ldyBRdWVzdGlvbkJ0bih0aGlzLmdhbWUsIDAsIDQ4MSwgd2luZG93LnF1RyArIDEpO1xuICAgICAgICAgICAgICAgIHRoaXMucXUzID0gbmV3IFF1ZXN0aW9uQnRuKHRoaXMuZ2FtZSwgMCwgNDgxICsgMTQ4LCB3aW5kb3cucXVHICsgMik7XG4gICAgICAgICAgICAgICAgdGhpcy5xdTQgPSBuZXcgUXVlc3Rpb25CdG4odGhpcy5nYW1lLCAwLCA0ODEgKyAxNDggKyAxNDgsIHdpbmRvdy5xdUcgKyAzKTtcbiAgICAgICAgICAgICAgICB0aGlzLnF1NSA9IG5ldyBRdWVzdGlvbkJ0bih0aGlzLmdhbWUsIDAsIDQ4MSArIDE0OCArIDE0OCArIDE0OCwgd2luZG93LnF1RyArIDQpO1xuXG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIGlmICh3aW5kb3cucXVHID09IDApIHtcblxuXG4gICAgICAgICAgICAgICAgICAgIHRoaXMucXUyID0gbmV3IFF1ZXN0aW9uQnRuKHRoaXMuZ2FtZSwgMCwgNDgxLCB3aW5kb3cucXVHICsgMSk7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMucXU0ID0gbmV3IFF1ZXN0aW9uQnRuKHRoaXMuZ2FtZSwgMCwgNDgxICsgMTQ4ICsgMTQ4LCB3aW5kb3cucXVHKzMpO1xuICAgICAgICAgICAgICAgICAgICB0aGlzLnF1NSA9IG5ldyBRdWVzdGlvbkJ0bih0aGlzLmdhbWUsIDAsIDQ4MSArIDE0OCArIDE0OCArIDE0OCwgd2luZG93LnF1RyArIDQpO1xuXG5cbiAgICAgICAgICAgICAgICAgICAgaWYoTWF0aC5yYW5kb20oKT49MC41KXtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMucXUzID0gbmV3IFF1ZXN0aW9uQnRuKHRoaXMuZ2FtZSwgMCwgNDgxICsgMTQ4LCB3aW5kb3cucXVHICsgMik7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnF1MSA9IG5ldyBRdWVzdGlvbkJ0bih0aGlzLmdhbWUsIDAsIDMzMywgMCwgdHJ1ZSk7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmVuZF9pID0gdGhpcy5hZGQuc3ByaXRlKDM3NSwgMzMzLTEwLCAnZW5kX2knKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuZW5kX2kueCA9IDM3NSAtIHRoaXMucXUxLm1xdWVzdGlvbi5fd2lkdGggLyAyIC0gNTA7XG5cbiAgICAgICAgICAgICAgICAgICAgfWVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5xdTEgPSBuZXcgUXVlc3Rpb25CdG4odGhpcy5nYW1lLCAwLCAzMzMsIHdpbmRvdy5xdUcpO1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5xdTMgPSBuZXcgUXVlc3Rpb25CdG4odGhpcy5nYW1lLCAwLCA0ODEgKyAxNDgsIDIsIHRydWUpO1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5lbmRfaSA9IHRoaXMuYWRkLmltYWdlKDM3NSwgNDgxICsgMTQ4LTEwLCAnZW5kX2knKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuZW5kX2kueCA9IDM3NSAtIHRoaXMucXUzLm1xdWVzdGlvbi5fd2lkdGggLyAyIC0gNTA7XG4gICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgICB0aGlzLmVuZF9pLmFuY2hvci5zZXRUbygwLjUpO1xuICAgICAgICAgICAgICAgICAgICB0aGlzLmVuZF9pLnNjYWxlLnNldFRvKDApO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIGlmICh3aW5kb3cucXVHID09IDQpIHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5xdTEgPSBuZXcgUXVlc3Rpb25CdG4odGhpcy5nYW1lLCAwLCAzMzMsIHdpbmRvdy5xdUcpO1xuICAgICAgICAgICAgICAgICAgICB0aGlzLnF1MiA9IG5ldyBRdWVzdGlvbkJ0bih0aGlzLmdhbWUsIDAsIDQ4MSwgd2luZG93LnF1RyArIDEpO1xuICAgICAgICAgICAgICAgICAgICB0aGlzLnF1MyA9IG5ldyBRdWVzdGlvbkJ0bih0aGlzLmdhbWUsIDAsIDQ4MSArIDE0OCwgd2luZG93LnF1RyArIDIpO1xuXG4gICAgICAgICAgICAgICAgICAgIHRoaXMucXU1ID0gbmV3IFF1ZXN0aW9uQnRuKHRoaXMuZ2FtZSwgMCwgNDgxICsgMTQ4ICsgMTQ4ICsgMTQ4LCB3aW5kb3cucXVHICsgNCk7XG4gICAgICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgICAgICB0aGlzLnF1NCA9IG5ldyBRdWVzdGlvbkJ0bih0aGlzLmdhbWUsIDAsIDQ4MSArIDE0OCArIDE0OCwgMywgdHJ1ZSk7XG5cbiAgICAgICAgICAgICAgICAgICAgdGhpcy5lbmRfaSA9IHRoaXMuYWRkLmltYWdlKDM3NSwgNDgxICsgMTQ4ICsgMTQ4LTEwLCAnZW5kX2knKTtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5lbmRfaS54ID0gMzc1IC0gdGhpcy5xdTQubXF1ZXN0aW9uLl93aWR0aCAvIDIgLSA1MDtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5lbmRfaS5hbmNob3Iuc2V0VG8oMC41KTtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5lbmRfaS5zY2FsZS5zZXRUbygwKTtcblxuXG5cbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICBpZiAod2luZG93LnF1RyA9PSA4KSB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMucXUxID0gbmV3IFF1ZXN0aW9uQnRuKHRoaXMuZ2FtZSwgMCwgMzMzLCB3aW5kb3cucXVHKTtcblxuICAgICAgICAgICAgICAgICAgICB0aGlzLnF1MyA9IG5ldyBRdWVzdGlvbkJ0bih0aGlzLmdhbWUsIDAsIDQ4MSArIDE0OCwgd2luZG93LnF1RyArIDIpO1xuICAgICAgICAgICAgICAgICAgICB0aGlzLnF1NCA9IG5ldyBRdWVzdGlvbkJ0bih0aGlzLmdhbWUsIDAsIDQ4MSArIDE0OCArIDE0OCwgd2luZG93LnF1RyArIDMpO1xuICAgICAgICAgICAgICAgICAgICB0aGlzLnF1NSA9IG5ldyBRdWVzdGlvbkJ0bih0aGlzLmdhbWUsIDAsIDQ4MSArIDE0OCArIDE0OCArIDE0OCwgd2luZG93LnF1RyArIDQpO1xuXG5cbiAgICAgICAgICAgICAgICAgICAgdGhpcy5xdTIgPSBuZXcgUXVlc3Rpb25CdG4odGhpcy5nYW1lLCAwLCA0ODEsIDEsIHRydWUpO1xuICAgICAgICAgICAgICAgICAgICB0aGlzLmVuZF9pID0gdGhpcy5hZGQuaW1hZ2UoMzc1LCA0ODEtMTAsICdlbmRfaScpO1xuICAgICAgICAgICAgICAgICAgICB0aGlzLmVuZF9pLnggPSAzNzUgLSB0aGlzLnF1Mi5tcXVlc3Rpb24uX3dpZHRoIC8gMiAtIDUwO1xuICAgICAgICAgICAgICAgICAgICB0aGlzLmVuZF9pLmFuY2hvci5zZXRUbygwLjUpO1xuICAgICAgICAgICAgICAgICAgICB0aGlzLmVuZF9pLnNjYWxlLnNldFRvKDApO1xuXG5cbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICBpZiAod2luZG93LnF1RyA9PSAxMikge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLnF1MSA9IG5ldyBRdWVzdGlvbkJ0bih0aGlzLmdhbWUsIDAsIDMzMywgd2luZG93LnF1Ryk7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMucXUyID0gbmV3IFF1ZXN0aW9uQnRuKHRoaXMuZ2FtZSwgMCwgNDgxLCB3aW5kb3cucXVHICsgMSk7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMucXUzID0gbmV3IFF1ZXN0aW9uQnRuKHRoaXMuZ2FtZSwgMCwgNDgxICsgMTQ4LCB3aW5kb3cucXVHICsgMik7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMucXU0ID0gbmV3IFF1ZXN0aW9uQnRuKHRoaXMuZ2FtZSwgMCwgNDgxICsgMTQ4ICsgMTQ4LCB3aW5kb3cucXVHICsgMyk7XG5cblxuXG4gICAgICAgICAgICAgICAgICAgIHRoaXMucXU1ID0gbmV3IFF1ZXN0aW9uQnRuKHRoaXMuZ2FtZSwgMCwgNDgxICsgMTQ4ICsgMTQ4ICsgMTQ4LCA0LCB0cnVlKTtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5lbmRfaSA9IHRoaXMuYWRkLmltYWdlKDM3NSwgNDgxICsgMTQ4ICsgMTQ4ICsgMTQ4LTEwLCAnZW5kX2knKTtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5lbmRfaS54ID0gMzc1IC0gdGhpcy5xdTUubXF1ZXN0aW9uLl93aWR0aCAvIDIgLSA1MDtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5lbmRfaS5hbmNob3Iuc2V0VG8oMC41KTtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5lbmRfaS5zY2FsZS5zZXRUbygwKTtcblxuXG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHZhciBlMSA9IHRoaXMuYWRkLnR3ZWVuKHRoaXMuZW5kX2kuc2NhbGUpLnRvKHt4OiAxLCB5OiAxfSwgMjAwLCBudWxsLCB0cnVlLCAxNTAwKTtcbiAgICAgICAgICAgICAgICBlMS5vbkNvbXBsZXRlLmFkZChmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgICAgIHZhciBlYTEgPSB0aGlzLmFkZC50d2Vlbih0aGlzLmVuZF9pKS50byh7YW5nbGU6IFstMTUsIDE1XX0sIDMzMywgbnVsbCwgdHJ1ZSwgMCwgLTEsIHRydWUpO1xuICAgICAgICAgICAgICAgICAgICB2YXIgZWEyID0gdGhpcy5hZGQudHdlZW4odGhpcy5lbmRfaS5zY2FsZSkudG8oe3g6IDEuNSwgeTogMS41fSwgMzMzLCBudWxsLCB0cnVlLCAwLCAtMSwgdHJ1ZSk7XG4gICAgICAgICAgICAgICAgICAgIC8vIGVhMS5yZXBlYXREZWxheSg0MDApO1xuICAgICAgICAgICAgICAgICAgICAvLyBlYTIucmVwZWF0RGVsYXkoNDAwKTtcbiAgICAgICAgICAgICAgICB9LCB0aGlzKTtcbiAgICAgICAgICAgICAgICB0aGlzLmVuZF9pLmFuaW1hdGlvbnMuYWRkKCdlbmRfaScpLnBsYXkoMyx0cnVlKTtcblxuICAgICAgICAgICAgfVxuXG5cbiAgICAgICAgfSxcbiAgICAgICAgZW50ZXJRdTogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgdmFyIGMxID0gdGhpcy5hZGQudHdlZW4odGhpcy5xdTEubXF1ZXN0aW9uKS50byh7eDogMzc1fSwgNjAwLCBQaGFzZXIuRWFzaW5nLlF1YXJ0aWMuT3V0LCB0cnVlLCAxMDApO1xuICAgICAgICAgICAgdmFyIGMyID0gdGhpcy5hZGQudHdlZW4odGhpcy5xdTIubXF1ZXN0aW9uKS50byh7eDogMzc1fSwgNjAwLCBQaGFzZXIuRWFzaW5nLlF1YXJ0aWMuT3V0LCB0cnVlLCAzMDApO1xuICAgICAgICAgICAgdmFyIGMzID0gdGhpcy5hZGQudHdlZW4odGhpcy5xdTMubXF1ZXN0aW9uKS50byh7eDogMzc1fSwgNjAwLCBQaGFzZXIuRWFzaW5nLlF1YXJ0aWMuT3V0LCB0cnVlLCA0NTApO1xuICAgICAgICAgICAgdmFyIGM0ID0gdGhpcy5hZGQudHdlZW4odGhpcy5xdTQubXF1ZXN0aW9uKS50byh7eDogMzc1fSwgNjAwLCBQaGFzZXIuRWFzaW5nLlF1YXJ0aWMuT3V0LCB0cnVlLCA2MDApO1xuICAgICAgICAgICAgdmFyIGM1ID0gdGhpcy5hZGQudHdlZW4odGhpcy5xdTUubXF1ZXN0aW9uKS50byh7eDogMzc1fSwgNjAwLCBQaGFzZXIuRWFzaW5nLlF1YXJ0aWMuT3V0LCB0cnVlLCA3MDApO1xuXG4gICAgICAgICAgICBjNS5vbkNvbXBsZXRlLmFkZChmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5hZGQudHdlZW4odGhpcy5jaGFuZ2VfZ3JvdXApLnRvKHthbHBoYTogMX0sIDUwMCwgUGhhc2VyLkVhc2luZy5Cb3VuY2UuT3V0LCB0cnVlKTtcbiAgICAgICAgICAgICAgICB0aGlzLmNoYW5nZV9idG4uaW5wdXRFbmFibGVkID0gdHJ1ZTtcbiAgICAgICAgICAgIH0sIHRoaXMpXG4gICAgICAgIH1cbiAgICB9O1xufSgpKTtcbiAgICAgICIsIi8qKlxuICogQ3JlYXRlZCBieSBzYW5jaGV6IG9uIDE2LzYvMTUuXG4gKi9cbihmdW5jdGlvbiAoKSB7XG4gICAgJ3VzZSBzdHJpY3QnO1xuXG4gICAgdmFyIEhvbWUgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIGlmKCF3aW5kb3cuYW5kcm9pZCl7XG4gICAgICAgICAgICB0aGlzLnR4dEFycmF5ID0gXCLkvaDlpb3vvIzmiJHmmK9TaXJp77yMLeWImuadpeWIsOWuieWNk+eahOS4lueVjO+8jOacieacieacieeCueS4jeWFvOWuue+8jC3ov5nov5nkuKrkuJbnlYzlr7nkuo7miJHmnaXor7Tov5jlvojpmYzpmYzpmYznlJ/vvIwt5LiN5aaC5oiR5Lus5LuO6Zu25byA5aeL77yM5LiA6LW35o6i5o6i57Si5ZCn77yBXCJcblxuICAgICAgICB9ZWxzZSB7XG4gICAgICAgICAgICB0aGlzLnR4dEFycmF5ID0gXCLlkrPlkrPlkrPvvIzorqnkvaDkuYXnrYnkuobvvIzlr7nkuI3otbfvvIEt5Yid5qyh6KeB6Z2i77yM5oiR5pivU2lyae+8gS3omb3nhLbnjrDlnKjmiJHogIHkuobvvIzkvYbmmK/ohJHlrZDov5jlvojlpb3kvb/vvIwt5Y+v5LiN5YOP6YeR6bG86YKj5LmI5YGl5b+Y77yBLeaIkeWwj+aXtuWAmeabtOWOieWus++8jOaIkee7meS9oOiusuiusuWViu+8gS3ll6/vvIzliJrmiY3or7TliLDlk6rkuoYuLi4uLlwiO1xuICAgICAgICB9XG5cbiAgICB9O1xuICAgIG1vZHVsZS5leHBvcnRzID0gSG9tZTtcbiAgICBIb21lLnByb3RvdHlwZSA9IHtcbiAgICAgICAgY3JlYXRlOiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICB2YXIgdGhhdD10aGlzO1xuXG5cbiAgICAgICAgICAgIHRoaXMudHh0XzEgPSB0aGlzLmFkZC50ZXh0KDQ3LCAxMDAsICcnLCB7Zm9udDogJzQwcHggQXJpYWwnLCBmaWxsOiAnI2ZmZicsIGFsaWduOiAnbGVmdCd9KTtcbiAgICAgICAgICAgIHRoaXMudHh0XzEubGluZVNwYWNpbmcgPSAyMDtcbiAgICAgICAgICAgIHRoaXMudHh0X251bSA9IDA7XG4gICAgICAgICAgICBpZighd2luZG93LmFuZHJvaWQpe1xuICAgICAgICAgICAgICAgIHRoaXMudHh0XzIgPSB0aGlzLmFkZC50ZXh0KDQ3LCA0MDAsICdTaXJp5q2j5Zyo5Zue6YCA5Yiw5pyA5Yid54mI5pys4oCmIOKApicsIHtmb250OiAnNDBweCBBcmlhbCcsIGZpbGw6ICcjZmZmJywgYWxpZ246ICdsZWZ0J30pO1xuICAgICAgICAgICAgfWVsc2Uge1xuICAgICAgICAgICAgICAgIHRoaXMudHh0XzIgPSB0aGlzLmFkZC50ZXh0KDQ3LCA0MDAsICfml7blhYnlgJLmtYHkuK3igKYg4oCmJywge2ZvbnQ6ICc0MHB4IEFyaWFsJywgZmlsbDogJyNmZmYnLCBhbGlnbjogJ2xlZnQnfSk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIHRoaXMudHh0XzIuYWxwaGEgPSAwO1xuXG4gICAgICAgICAgICB0aGlzLnZvaWNlX3Nwcml0ZSA9IHRoaXMuYWRkLnNwcml0ZSgzNzUsIDEyMDYsICd2b2ljZV9zcHJpdGUnKTtcbiAgICAgICAgICAgIHRoaXMudm9pY2Vfc3ByaXRlLmFuY2hvci5zZXRUbygwLjUsMSk7XG4gICAgICAgICAgICB0aGlzLnZvaWNlX3Nwcml0ZS5mcmFtZT0wO1xuXG4gICAgICAgICAgICB0aGlzLmFjdHNpcmkgPSB0aGlzLmFkZC5pbWFnZSgzNzUsIDExMDYsICdhY3RzaXJpJyk7XG4gICAgICAgICAgICB0aGlzLmFjdHNpcmkuYW5jaG9yLnNldFRvKDAuNSk7XG4gICAgICAgICAgICB0aGlzLmFjdHNpcmkuc2NhbGUuc2V0VG8oMCk7XG4gICAgICAgICAgICB0aGlzLmFjdHNpcmkuaW5wdXRFbmFibGVkID0gdHJ1ZTtcbiAgICAgICAgICAgIHRoaXMuYWN0c2lyaS5ldmVudHMub25JbnB1dERvd24uYWRkT25jZSh0aGlzLmdvQmFjaywgdGhpcyk7XG4gICAgICAgICAgICB0aGlzLmFjdHNpcmkuZXZlbnRzLm9uSW5wdXRVcC5hZGRPbmNlKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICB0aGlzLmFjdHNpcmkuYWxwaGE9MDtcbiAgICAgICAgICAgIH0sIHRoaXMpO1xuXG4gICAgICAgICAgICAvLyB2YXIgdDEgPSB0aGlzLmFkZC50ZXh0KHRoaXMuZ2FtZS53aWR0aCAqIDAuNSwgdGhpcy5nYW1lLmhlaWdodCAqIDAuNSxcbiAgICAgICAgICAgIC8vICAgICAn5a+5Jywge2ZvbnQ6ICc0MnB4IEFyaWFsJywgZmlsbDogJyNmZmZmZmYnLCBhbGlnbjogJ2NlbnRlcidcbiAgICAgICAgICAgIC8vICAgICB9KTtcbiAgICAgICAgICAgIC8vIHQxLmFuY2hvci5zZXQoMC41KTtcbiAgICAgICAgICAgIC8vIHZhciB0MiA9IHRoaXMuYWRkLnRleHQodGhpcy5nYW1lLndpZHRoICogMC41KzQyLCB0aGlzLmdhbWUuaGVpZ2h0ICogMC41LFxuICAgICAgICAgICAgLy8gICAgICfkuI0nLCB7Zm9udDogJzQycHggQXJpYWwnLCBmaWxsOiAnI2ZmZmZmZicsIGFsaWduOiAnY2VudGVyJ1xuICAgICAgICAgICAgLy8gICAgIH0pO1xuICAgICAgICAgICAgLy8gdDIuYW5jaG9yLnNldCgwLjUpO1xuICAgICAgICAgICAgLy8gdmFyIHQzID0gdGhpcy5hZGQudGV4dCh0aGlzLmdhbWUud2lkdGggKiAwLjUrNDIrNDIsIHRoaXMuZ2FtZS5oZWlnaHQgKiAwLjUsXG4gICAgICAgICAgICAvLyAgICAgJ+i1tycsIHtmb250OiAnNDJweCBBcmlhbCcsIGZpbGw6ICcjZmZmZmZmJywgYWxpZ246ICdjZW50ZXInXG4gICAgICAgICAgICAvLyAgICAgfSk7XG4gICAgICAgICAgICAvLyB0My5hbmNob3Iuc2V0KDAuNSk7XG4gICAgICAgICAgICAvL1xuXG4gICAgICAgICAgICAvLyB2YXIgYzEgPSBnYW1lLmFkZC50d2Vlbih0MSkuZnJvbSggeyB4OiB0aGlzLmdhbWUud2lkdGgqTWF0aC5yYW5kb20oKS8yLHk6dGhpcy5nYW1lLmhlaWdodCpNYXRoLnJhbmRvbSgpLzIsYWxwaGE6MH0sIDEwMDAsIFBoYXNlci5FYXNpbmcuUXVhcnRpYy5PdXQsdHJ1ZSk7XG4gICAgICAgICAgICAvLyB2YXIgYzI9IGdhbWUuYWRkLnR3ZWVuKHQyKS5mcm9tKCB7IHg6IHRoaXMuZ2FtZS53aWR0aCpNYXRoLnJhbmRvbSgpLzIseTp0aGlzLmdhbWUuaGVpZ2h0Kk1hdGgucmFuZG9tKCkvMixhbHBoYTowfSwgMTAwMCwgUGhhc2VyLkVhc2luZy5RdWFydGljLk91dCx0cnVlLDUwMCk7XG5cbiAgICAgICAgICAgIC8vIGMxLmNoYWluKGMyKTtcbiAgICAgICAgICAgIC8vIGMxLnN0YXJ0KCk7XG5cbiAgICAgICAgICAgIC8vIHRoaXMucmVuZGVyQ2xvY2soKTtcblxuICAgICAgICAgICAgdGhpcy52b2ljZV9zcHJpdGUuYW5pbWF0aW9ucy5hZGQoJ3N0YXJ0cCcsWzAsMSwyLDMsNCw1LDYsN10sMTUsZmFsc2UpO1xuICAgICAgICAgICAgdGhpcy52b2ljZV9zcHJpdGUuYW5pbWF0aW9ucy5hZGQoJ2xvb3BwJyxbOCw5LDEwLDExLDEyLDEzLDE0LDE1LDE2LDE3LDE4LDE5LDIwLDIxLDIyLDIzLDI0LDI1LDI2LDI3XSwxNSx0cnVlKTtcbiAgICAgICAgICAgIHRoaXMudm9pY2Vfc3ByaXRlLmFuaW1hdGlvbnMuYWRkKCdlbmRwJyxbNyw2LDUsNCwzLDIsMSwwXSwxNSxmYWxzZSk7XG5cblxuICAgICAgICAgICAgLy8gdGhpcy5yZW5kZXJCYWJ5KCk7XG4gICAgICAgICAgICB2YXIgYTE9dGhpcy52b2ljZV9zcHJpdGUucGxheSgnc3RhcnRwJyk7XG4gICAgICAgICAgICBhMS5vbkNvbXBsZXRlLmFkZChmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgdGhpcy52b2ljZV9zcHJpdGUucGxheSgnbG9vcHAnKTtcbiAgICAgICAgICAgIH0sdGhpcyk7XG4gICAgICAgICAgICB2YXIgJGhhdWRpbz0kKFwiI2hhdWRpb1wiKTtcblxuICAgICAgICAgICAgaWYoIXdpbmRvdy5hbmRyb2lkKXtcbiAgICAgICAgICAgICAgICAvLyB2YXIgaGF1ZGlvMT1kb2N1bWVudC5nZXRFbGVtZW50QnlJZChcImhhdWRpb2ExXCIpO1xuXG4gICAgICAgICAgICAgICAgLy8gJGhhdWRpby5maW5kKFwiLmhhdWRpb2ExXCIpWzBdLnBsYXkoKTtcbiAgICAgICAgICAgICAgICB0aGF0LmhhdWRpbzFhID0gbmV3IEhvd2woe1xuICAgICAgICAgICAgICAgICAgICBzcmM6IFsnYXNzZXRzL2F1ZGlvL2hhdWRpb2ExLm1wMyddXG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgdGhhdC5kaWRpYSA9IG5ldyBIb3dsKHtcbiAgICAgICAgICAgICAgICAgICAgc3JjOiBbJ2Fzc2V0cy9hdWRpby9kaWRpYS5tcDMnXVxuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIHRoYXQuaG9tZTEgPSBuZXcgSG93bCh7XG4gICAgICAgICAgICAgICAgICAgIHNyYzogWydhc3NldHMvYXVkaW8vaDEubXAzJ11cbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICB0aGF0LmhhdWRpbzFhLnBsYXkoKTtcblxuICAgICAgICAgICAgfWVsc2Uge1xuICAgICAgICAgICAgICAgIC8vIHZhciBoYXVkaW8xPWRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwiaGF1ZGlvMVwiKTtcbiAgICAgICAgICAgICAgICAvLyB2YXIgJGhhdWRpbz0gJChcIiNoYXVkaW8xXCIpWzBdO1xuICAgICAgICAgICAgICAgIGlmKHdpbmRvdy5hbmRyb2lkdil7XG4gICAgICAgICAgICAgICAgICAgIHRoYXQuaGF1ZGlvMiA9IG5ldyBIb3dsKHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHNyYzogWydhc3NldHMvYXVkaW8vaGF1ZGlvMi5tcDMnXVxuICAgICAgICAgICAgICAgICAgICAgICAgLy8gbG9vcDp0cnVlXG4gICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICB0aGF0LmRpZGkgPSBuZXcgSG93bCh7XG4gICAgICAgICAgICAgICAgICAgICAgICBzcmM6IFsnYXNzZXRzL2F1ZGlvL2RpZGkubXAzJ11cbiAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgIHRoYXQuaG9tZV9hdWRpbyA9IG5ldyBIb3dsKHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHNyYzogWydhc3NldHMvYXVkaW8vaDEubXAzJ11cbiAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgIHRoYXQuaGF1ZGlvMSA9IG5ldyBIb3dsKHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHNyYzogWydhc3NldHMvYXVkaW8vaGF1ZGlvMS5tcDMnXSxcbiAgICAgICAgICAgICAgICAgICAgICAgIG9uZW5kOmZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGF0LmdhbWUudGltZS5ldmVudHMuYWRkKDMwMCwgZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGF0LmhhdWRpbzIucGxheSgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sdGhpcyk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICB0aGF0LmhhdWRpbzEucGxheSgpO1xuXG5cbiAgICAgICAgICAgICAgICB9ZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICRoYXVkaW8uZmluZCgnLmhhdWRpbzEnKS5iaW5kKCdlbmRlZCcsZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhhdC5nYW1lLnRpbWUuZXZlbnRzLmFkZCgzMDAsIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAkaGF1ZGlvLmZpbmQoJy5oYXVkaW8yJylbMF0ucGxheSgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfSx0aGlzKTtcbiAgICAgICAgICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgICAgICAgICAgLy8gaGF1ZGlvMS5hZGRFdmVudExpc3RlbmVyKCdlbmRlZCcsZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgICAgICAvL1xuICAgICAgICAgICAgICAgICAgICAvLyB9LGZhbHNlKTtcbiAgICAgICAgICAgICAgICAgICAgJGhhdWRpby5maW5kKCcuaGF1ZGlvMScpWzBdLnBsYXkoKTtcbiAgICAgICAgICAgICAgICB9XG5cblxuXG5cbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgaWYoIXdpbmRvdy5hbmRyb2lkKXtcbiAgICAgICAgICAgICAgICB0aGlzLmdhbWUudGltZS5ldmVudHMucmVwZWF0KDE4MCx0aGlzLnR4dEFycmF5Lmxlbmd0aC0zLCAgdGhpcy5hZGRUZXh0LCB0aGlzKTtcbiAgICAgICAgICAgIH1lbHNlIHtcbiAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgdGhpcy5nYW1lLnRpbWUuZXZlbnRzLnJlcGVhdCg4MCx0aGlzLnR4dEFycmF5Lmxlbmd0aC01LCAgdGhpcy5hZGRUZXh0LCB0aGlzKTtcblxuICAgICAgICAgICAgICAgIC8vbG9uZ3RpbWVcbiAgICAgICAgICAgICAgICB0aGlzLmxvbmd0aW1lPXRoaXMuZ2FtZS50aW1lLmV2ZW50cy5hZGQoMjAwMDAsIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coJ2xvbmcgdGltZScpO1xuICAgICAgICAgICAgICAgICAgICB0aGlzLnZvaWNlX3Nwcml0ZS5raWxsKCk7XG4gICAgICAgICAgICAgICAgICAgIC8vIHRoaXMuZ2FtZS5hZGQudHdlZW4oIHRoaXMudm9pY2Vfc3ByaXRlLnNjYWxlKS50byh7eDogMCx5OjB9LCAxMDAwLCBQaGFzZXIuRWFzaW5nLlF1YXJ0aWMuT3V0LCB0cnVlLCAzMDApO1xuICAgICAgICAgICAgICAgICAgICB2YXIgYWU9dGhpcy5nYW1lLmFkZC50d2VlbiggdGhpcy5hY3RzaXJpLnNjYWxlKS50byh7eDogMSx5OjF9LCAxMDAwLCBQaGFzZXIuRWFzaW5nLkJvdW5jZS5PdXQsIHRydWUsIDMwMCk7XG4gICAgICAgICAgICAgICAgICAgIGFlLm9uQ29tcGxldGUuYWRkKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBlYTEgPSB0aGlzLmFkZC50d2Vlbih0aGlzLmFjdHNpcmkpLnRvKHthbmdsZTogWzAsLTUsMCw1LDBdfSwgMjAwLCBudWxsLCB0cnVlLCAzMDAsIC0xLCB0cnVlKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBlYTIgPSB0aGlzLmFkZC50d2Vlbih0aGlzLmFjdHNpcmkuc2NhbGUpLnRvKHt4OiAxLjIsIHk6IDEuMn0sIDIwMCwgbnVsbCwgdHJ1ZSwgMzAwLCAtMSwgdHJ1ZSk7XG4gICAgICAgICAgICAgICAgICAgICAgICBlYTEucmVwZWF0RGVsYXkoMTAwMCk7XG4gICAgICAgICAgICAgICAgICAgICAgICBlYTIucmVwZWF0RGVsYXkoMTAwMCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAvLyB0aGlzLmdhbWUudGltZS5ldmVudHMuYWRkKDEwMDAsIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vICAgICB0aGF0LmFjdHNpcmkuaW5wdXRFbmFibGVkPWZhbHNlO1xuICAgICAgICAgICAgICAgICAgICAgICAgLy8gICAgIHRoYXQuYWN0c2lyaS5raWxsKCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAvLyAgICAgdGhhdC5nb0JhY2soKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vXG4gICAgICAgICAgICAgICAgICAgICAgICAvLyB9LHRoaXMpXG4gICAgICAgICAgICAgICAgICAgIH0sdGhpcyk7XG4gICAgICAgICAgICAgICAgfSx0aGlzKTtcblxuXG4gICAgICAgICAgICB9XG5cblxuICAgICAgICAgICAgLy8gdGhpcy5pbnB1dC5vbkRvd24uYWRkKHRoaXMub25Eb3duLCB0aGlzKTtcbiAgICAgICAgfSxcbiAgICAgICAgZ29CYWNrOiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICB2YXIgdGhhdCA9IHRoaXM7XG4gICAgICAgICAgICBpZih0aGF0Lmxvbmd0aW1lIT11bmRlZmluZWQpe1xuICAgICAgICAgICAgICAgIGdhbWUudGltZS5ldmVudHMucmVtb3ZlKHRoYXQubG9uZ3RpbWUpO1xuICAgICAgICAgICAgfVxuXG5cbiAgICAgICAgICAgIHRoaXMuYWN0c2lyaS5hbHBoYSA9IDAuODtcbiAgICAgICAgICAgIHZhciAkaGF1ZGlvPSQoXCIjaGF1ZGlvXCIpO1xuICAgICAgICAgICAgaWYoIXdpbmRvdy5hbmRyb2lkKXtcbiAgICAgICAgICAgICAgICAvLyAkaGF1ZGlvLmZpbmQoXCIuaGF1ZGlvYTFcIilbMF0ucGF1c2UoKTtcbiAgICAgICAgICAgICAgICAvLyAkaGF1ZGlvLmZpbmQoXCIuaGF1ZGlvYTFcIikucmVtb3ZlKCk7XG4gICAgICAgICAgICAgICAgdGhhdC5oYXVkaW8xYS5wYXVzZSgpO1xuICAgICAgICAgICAgICAgIHRoYXQuZGlkaWEucGxheSgpO1xuICAgICAgICAgICAgICAgIC8vICRoYXVkaW8uZmluZChcIi5kaWRpYVwiKVswXS5wbGF5KCk7XG4gICAgICAgICAgICB9ZWxzZSB7XG4gICAgICAgICAgICAgICAgaWYod2luZG93LmFuZHJvaWR2KXtcbiAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coJ2F2Jyk7XG4gICAgICAgICAgICAgICAgICAgIHRoYXQuaGF1ZGlvMi5wYXVzZSgpO1xuICAgICAgICAgICAgICAgICAgICB0aGF0LmRpZGkucGxheSgpO1xuICAgICAgICAgICAgICAgIH1lbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgJGhhdWRpby5maW5kKFwiLmhhdWRpbzJcIilbMF0ucGF1c2UoKTtcbiAgICAgICAgICAgICAgICAgICAgJGhhdWRpby5maW5kKFwiLmhhdWRpbzJcIikucmVtb3ZlKCk7XG4gICAgICAgICAgICAgICAgICAgICRoYXVkaW8uZmluZChcIi5kaWRpXCIpWzBdLnBsYXkoKTtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIH1cblxuXG4gICAgICAgICAgICB0aGlzLmdhbWUuYWRkLnR3ZWVuKHRoYXQudHh0XzEpLnRvKHthbHBoYTogMCwgeTogLTI1MH0sIDYwMCwgUGhhc2VyLkVhc2luZy5DdWJpYy5PdXQsIHRydWUpO1xuICAgICAgICAgICAgdGhpcy5nYW1lLmFkZC50d2Vlbih0aGF0LnR4dF8yKS50byh7YWxwaGE6IDEsIHk6IDEwMH0sIDYwMCwgUGhhc2VyLkVhc2luZy5DdWJpYy5PdXQsIHRydWUsIDMwMCk7XG4gICAgICAgICAgICBpZighd2luZG93LmFuZHJvaWQpe1xuICAgICAgICAgICAgICAgIHRoaXMuZ2FtZS50aW1lLmV2ZW50cy5yZXBlYXQoMTcwLDE2LHRoaXMuZGVsVGV4dCwgdGhpcyk7XG5cbiAgICAgICAgICAgIH1lbHNlIHtcbiAgICAgICAgICAgICAgICB0aGlzLmdhbWUudGltZS5ldmVudHMucmVwZWF0KDQ1MCw4LHRoaXMuZGVsVGV4dCwgdGhpcyk7XG4gICAgICAgICAgICB9XG5cblxuICAgICAgICAgICAgdGhpcy5yZW5kZXJDbG9jaygpO1xuXG5cbiAgICAgICAgICAgIC8vIHRoaXMuZ2FtZS50aW1lLmV2ZW50cy5yZXBlYXQoMjAwLCAxMDAwLCBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAvL1xuICAgICAgICAgICAgLy8gfSwgdGhpcyk7XG5cbiAgICAgICAgfSxcbiAgICAgICAgcmVuZGVyQ2xvY2s6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHZhciB0aGF0ID0gdGhpcztcbiAgICAgICAgICAgIHRoaXMuY2xvY2tfZ3JvdXAgPSB0aGlzLmFkZC5ncm91cCgpO1xuICAgICAgICAgICAgLy8gY2xvY2tfZ3JvdXAuYW5jaG9yLnNldFRvKDAuNSk7XG4gICAgICAgICAgICB2YXIgY2xvY2tfc3ByaXRlID0gdGhpcy5jbG9ja19ncm91cC5jcmVhdGUoMzc1LCA2MDEsICdjbG9ja19zcHJpdGUnKTtcbiAgICAgICAgICAgIGNsb2NrX3Nwcml0ZS5hbmNob3Iuc2V0VG8oMC41KTtcbiAgICAgICAgICAgIHZhciBob3VyaGFuZCA9IHRoaXMuY2xvY2tfZ3JvdXAuY3JlYXRlKDM3NSwgNjAxLCAnaG91cmhhbmQnKTtcbiAgICAgICAgICAgIGhvdXJoYW5kLmFuY2hvci5zZXRUbygwLjUsIDEpO1xuICAgICAgICAgICAgdmFyIHNlY29uZGhhbmQgPSB0aGlzLmNsb2NrX2dyb3VwLmNyZWF0ZSgzNzUsIDYwMSwgJ3NlY29uZGhhbmQnKTtcbiAgICAgICAgICAgIHNlY29uZGhhbmQuYW5jaG9yLnNldFRvKDAsIDAuNSk7XG5cbiAgICAgICAgICAgIHZhciBjMSA9IHRoaXMuZ2FtZS5hZGQudHdlZW4oaG91cmhhbmQpLnRvKHthbmdsZTogLTM2MH0sIDgwMDAsIFBoYXNlci5FYXNpbmcuUXVhcnRpYy5JbiwgdHJ1ZSwgMCwgMCk7XG4gICAgICAgICAgICB0aGlzLmdhbWUuYWRkLnR3ZWVuKHNlY29uZGhhbmQpLnRvKHthbmdsZTogLTM2MCoxMCoyNH0sIDgwMDAsIFBoYXNlci5FYXNpbmcuUXVhcnRpYy5JbiwgdHJ1ZSwgMCk7XG4gICAgICAgICAgICAvLyBjMS5vbkNvbXBsZXRlLmFkZChmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAvL1xuICAgICAgICAgICAgLy8gICAgIC8vIHRoYXQuY2xvY2tfZ3JvdXAuYWxwaGEgPSAwO1xuICAgICAgICAgICAgLy9cbiAgICAgICAgICAgIC8vXG4gICAgICAgICAgICAvLyAgICAgLy8gdGhpcy5nYW1lLnN0YXRlLnN0YXJ0KCdHYW1lJyk7XG4gICAgICAgICAgICAvLyB9LCB0aGlzKTtcblxuICAgICAgICAgICAgdGhpcy5nYW1lLmFkZC50d2Vlbih0aGlzLmNsb2NrX2dyb3VwKS50byh7YWxwaGE6IDB9LCA0MDAwLCBQaGFzZXIuRWFzaW5nLlF1YXJ0aWMuSW4sIHRydWUpO1xuICAgICAgICAgICAgdGhpcy5nYW1lLmFkZC50d2Vlbih0aGlzLnZvaWNlX3Nwcml0ZSkudG8oe2FscGhhOiAwfSwgMzAwMCwgbnVsbCwgdHJ1ZSk7XG4gICAgICAgICAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcImJnMlwiKS5zdHlsZS5kaXNwbGF5PSdibG9jayc7XG4gICAgICAgICAgICBUd2Vlbk1heC50byhkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcImJnMlwiKSwgNSwge29wYWNpdHk6IDEsIHRvcDogMCxlYXNlOkV4cG8uZWFzZUluLG9uQ29tcGxldGU6ZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgIHRoYXQucmVuZGVyQmFieSgpO1xuICAgICAgICAgICAgICAgIC8vIGlmKHdpbmRvdy5hbmRyb2lkKXtcbiAgICAgICAgICAgICAgICAvLyAgICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJiZzJcIikuc3R5bGUuZGlzcGxheT0nbm9uZSc7XG4gICAgICAgICAgICAgICAgLy8gICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwiYmcyXCIpLnN0eWxlLmRpc3BsYXk9J25vbmUnO1xuICAgICAgICAgICAgICAgIC8vICAgICAkKFwiI2N6XCIpWzBdLnBsYXkoKTtcbiAgICAgICAgICAgICAgICAvLyB9XG4gICAgICAgICAgICB9fSk7XG5cbiAgICAgICAgfSxcbiAgICAgICAgcmVuZGVyQmFieTogZnVuY3Rpb24gKCkge1xuXG4gICAgICAgICAgICB0aGlzLmJhYnl0eHQxID0gdGhpcy5hZGQuYml0bWFwVGV4dCg0NCwgOTgsICdiYWJ5Zm9udCcsICfkvaDlpb3vvIzmiJHmmK9iYWJ5IFNpcmnvvIznjrDlnKjmnInku4DkuYgnLCAzNik7XG4gICAgICAgICAgICB0aGlzLmJhYnl0eHQyID0gdGhpcy5hZGQuYml0bWFwVGV4dCg0NCwgMTU4LCAnYmFieWZvbnQnLCAn6Zeu6aKY5oOz6Zeu5oiR5ZCX77yf6Jm954S25oiR6L+Y5bCP77yM5L2G5oiRJywgMzYpO1xuICAgICAgICAgICAgdGhpcy5iYWJ5dHh0MyA9IHRoaXMuYWRkLmJpdG1hcFRleHQoNDQsIDIxOCwgJ2JhYnlmb250JywgJ+efpemBk+eahOWPr+S4jeWwkeWTpu+8gScsIDM2KTtcblxuXG5cbiAgICAgICAgICAgIHRoaXMubWFzazEgPSBnYW1lLmFkZC5ncmFwaGljcygwLCAwKTtcbiAgICAgICAgICAgIHRoaXMubWFzazEuYmVnaW5GaWxsKDB4ZmZmZmZmKTtcbiAgICAgICAgICAgIHRoaXMubWFzazEuZHJhd1JlY3QoNDQtNTM4LCA5OCwgNTM4LDQwKTtcbiAgICAgICAgICAgIHRoaXMubWFzazEuZW5kRmlsbCgpO1xuICAgICAgICAgICAgdGhpcy5iYWJ5dHh0MS5tYXNrPXRoaXMubWFzazE7XG5cbiAgICAgICAgICAgIHRoaXMubWFzazIgPSBnYW1lLmFkZC5ncmFwaGljcygwLCAwKTtcbiAgICAgICAgICAgIHRoaXMubWFzazIuYmVnaW5GaWxsKDB4ZmZmZmZmKTtcbiAgICAgICAgICAgIHRoaXMubWFzazIuZHJhd1JlY3QoNDQtNTM4LCAxNTgsIDUzOCw0MCk7XG4gICAgICAgICAgICB0aGlzLm1hc2syLmVuZEZpbGwoKTtcbiAgICAgICAgICAgIHRoaXMuYmFieXR4dDIubWFzaz10aGlzLm1hc2syO1xuXG4gICAgICAgICAgICB0aGlzLm1hc2szID0gZ2FtZS5hZGQuZ3JhcGhpY3MoMCwgMCk7XG4gICAgICAgICAgICB0aGlzLm1hc2szLmJlZ2luRmlsbCgweGZmZmZmZik7XG4gICAgICAgICAgICB0aGlzLm1hc2szLmRyYXdSZWN0KDQ0LTUzOCwgMjE4LCA1MzgsNDApO1xuICAgICAgICAgICAgdGhpcy5tYXNrMy5lbmRGaWxsKCk7XG4gICAgICAgICAgICB0aGlzLmJhYnl0eHQzLm1hc2s9dGhpcy5tYXNrMztcblxuICAgICAgICAgICAgdGhpcy5idm9pY2Vfc3ByaXRlID0gdGhpcy5hZGQuc3ByaXRlKDM3NSwgMTIwNiwgJ2J2b2ljZV9zcHJpdGUnKTtcbiAgICAgICAgICAgIHRoaXMuYnZvaWNlX3Nwcml0ZS5hbmNob3Iuc2V0VG8oMC41LDEpO1xuXG4gICAgICAgICAgICB0aGlzLmJ2b2ljZV9zcHJpdGUuYW5pbWF0aW9ucy5hZGQoJ3N0YXJ0cCcsWzAsMSwyLDMsNCw1LDYsN10sMTUsZmFsc2UpO1xuICAgICAgICAgICAgdGhpcy5idm9pY2Vfc3ByaXRlLmFuaW1hdGlvbnMuYWRkKCdsb29wcCcsWzgsOSwxMCwxMSwxMiwxMywxNCwxNSwxNiwxNywxOCwxOSwyMCwyMSwyMiwyMywyNCwyNSwyNiwyN10sMTUsdHJ1ZSk7XG4gICAgICAgICAgICB0aGlzLmJ2b2ljZV9zcHJpdGUuYW5pbWF0aW9ucy5hZGQoJ2VuZHAnLFs3LDYsNSw0LDMsMiwxLDBdLDE1LGZhbHNlKTtcblxuICAgICAgICAgICAgdGhpcy5yZW5kZXJUeHRNYXNrKCk7XG4gICAgICAgICAgICB0aGlzLnZvaWNlX3Nwcml0ZS5raWxsKCk7XG5cblxuICAgICAgICAgICAgLy9wbGF5IGF1ZGlvXG4gICAgICAgICAgICAvL2VuZFxuXG5cblxuICAgICAgICB9LFxuICAgICAgICByZW5kZXJUeHRNYXNrOmZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHZhciB0aGF0PXRoaXM7XG4gICAgICAgICAgICB2YXIgYTE9IHRoaXMuYnZvaWNlX3Nwcml0ZS5wbGF5KCdzdGFydHAnKTtcbiAgICAgICAgICAgIGExLm9uQ29tcGxldGUuYWRkKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICB0aGlzLmJ2b2ljZV9zcHJpdGUucGxheSgnbG9vcHAnKTtcbiAgICAgICAgICAgIH0sdGhpcyk7XG5cbiAgICAgICAgICAgIC8vIHZhciBoMT10aGlzLmFkZC5hdWRpbygnaDEnKTtcbiAgICAgICAgICAgIGlmKCF3aW5kb3cuYW5kcm9pZCl7XG4gICAgICAgICAgICAgICAgdGhhdC5ob21lMS5wbGF5KCk7XG4gICAgICAgICAgICAgICAgdGhhdC5ob21lMS5vbignZW5kJyxmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgICAgIHZhciBlbmRhbmltPXRoYXQuYnZvaWNlX3Nwcml0ZS5wbGF5KCdlbmRwJyk7XG4gICAgICAgICAgICAgICAgICAgIGVuZGFuaW0ub25Db21wbGV0ZS5hZGQoZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhhdC5nYW1lLnN0YXRlLnN0YXJ0KCdHYW1lJyk7XG4gICAgICAgICAgICAgICAgICAgIH0sdGhpcyk7XG4gICAgICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgIH1lbHNlIHtcbiAgICAgICAgICAgICAgICBpZih3aW5kb3cuYW5kcm9pZHYpe1xuICAgICAgICAgICAgICAgICAgICB0aGF0LmhvbWVfYXVkaW8ub24oJ2VuZCcsZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGVuZGFuaW09dGhhdC5idm9pY2Vfc3ByaXRlLnBsYXkoJ2VuZHAnKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGVuZGFuaW0ub25Db21wbGV0ZS5hZGQoZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoYXQuZ2FtZS5zdGF0ZS5zdGFydCgnR2FtZScpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfSx0aGlzKTtcbiAgICAgICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICAgICAgICAgdGhhdC5ob21lX2F1ZGlvLnBsYXkoKTtcbiAgICAgICAgICAgICAgICB9ZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIHZhciBob21lMT0kKFwiI2hvbWUxXCIpO1xuICAgICAgICAgICAgICAgICAgICBob21lMVswXS5wbGF5KCk7XG4gICAgICAgICAgICAgICAgICAgIGhvbWUxLmJpbmQoJ2VuZGVkJyxmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgZW5kYW5pbT10aGF0LmJ2b2ljZV9zcHJpdGUucGxheSgnZW5kcCcpO1xuICAgICAgICAgICAgICAgICAgICAgICAgZW5kYW5pbS5vbkNvbXBsZXRlLmFkZChmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhhdC5nYW1lLnN0YXRlLnN0YXJ0KCdHYW1lJyk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9LHRoaXMpO1xuICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLy9sb25ndGltZVxuICAgICAgICAgICAgdGhhdC5sb25ndGltZT10aGlzLmdhbWUudGltZS5ldmVudHMuYWRkKDIwMDAwLCBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgdGhhdC5nYW1lLnN0YXRlLnN0YXJ0KCdHYW1lJyk7XG4gICAgICAgICAgICB9LHRoaXMpO1xuXG5cbiAgICAgICAgICAgIC8vICRoMS5vblN0b3AuYWRkKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIC8vXG4gICAgICAgICAgICAvL1xuICAgICAgICAgICAgLy8gfSx0aGlzKTtcblxuICAgICAgICAgICAgdGhpcy50bDE9dGhpcy5hZGQuaW1hZ2UoNDQsOTgtMzUsJ3RfbCcpO1xuICAgICAgICAgICAgdGhpcy50bDEuYWxwaGE9MDtcbiAgICAgICAgICAgIHRoaXMudGwyPXRoaXMuYWRkLmltYWdlKDQ0LDE1OC0zNSwndF9sJyk7XG4gICAgICAgICAgICB0aGlzLnRsMi5hbHBoYT0wO1xuICAgICAgICAgICAgdGhpcy50bDM9dGhpcy5hZGQuaW1hZ2UoNDQsMjI4LTM1LCd0X2wnKTtcbiAgICAgICAgICAgIHRoaXMudGwzLmFscGhhPTA7XG5cbiAgICAgICAgICAgIHRoaXMuZ2FtZS5hZGQudHdlZW4odGhpcy50bDEpLnRvKHt4OiA1MzgrNDQsYWxwaGE6WzEsMF19LCAxMDAwLCBQaGFzZXIuRWFzaW5nLlF1YXJ0aWMuT3V0LCB0cnVlLCAzMDApO1xuICAgICAgICAgICAgdGhpcy5nYW1lLmFkZC50d2Vlbih0aGlzLnRsMikudG8oe3g6IDUzOCs0NCxhbHBoYTpbMSwwXX0sIDEwMDAsIFBoYXNlci5FYXNpbmcuUXVhcnRpYy5PdXQsIHRydWUsIDEwMDApO1xuICAgICAgICAgICAgdGhpcy5nYW1lLmFkZC50d2Vlbih0aGlzLnRsMykudG8oe3g6IDUzOCs0NCxhbHBoYTpbMSwwXX0sIDEwMDAsIFBoYXNlci5FYXNpbmcuUXVhcnRpYy5PdXQsIHRydWUsIDE4MDApO1xuXG4gICAgICAgICAgICB0aGlzLmdhbWUuYWRkLnR3ZWVuKHRoaXMubWFzazEpLnRvKHt4OiA1Mzh9LCAxMDAwLCBQaGFzZXIuRWFzaW5nLlF1YXJ0aWMuT3V0LCB0cnVlLCAzMDApO1xuICAgICAgICAgICAgdGhpcy5nYW1lLmFkZC50d2Vlbih0aGlzLm1hc2syKS50byh7eDogNTM4fSwgMTAwMCwgUGhhc2VyLkVhc2luZy5RdWFydGljLk91dCwgdHJ1ZSwgMTAwMCk7XG4gICAgICAgICAgICB2YXIgYz10aGlzLmdhbWUuYWRkLnR3ZWVuKHRoaXMubWFzazMpLnRvKHt4OiA1Mzh9LCAxMDAwLCBQaGFzZXIuRWFzaW5nLlF1YXJ0aWMuT3V0LCB0cnVlLCAxODAwKTtcblxuXG4gICAgICAgIH0sXG4gICAgICAgIGRlbFRleHQ6ZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgdmFyIHR4dF9iZiA9IHRoaXMudHh0XzIudGV4dDtcbiAgICAgICAgICAgIHR4dF9iZj10eHRfYmYuc3Vic3RyaW5nKDAsdHh0X2JmLmxlbmd0aC0xKTtcbiAgICAgICAgICAgIHRoaXMudHh0XzIudGV4dD10eHRfYmY7XG5cblxuICAgICAgICB9LFxuICAgICAgICBhZGRUZXh0OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICB2YXIgdGhhdD10aGlzO1xuICAgICAgICAgICAgdmFyIHR4dF9iZiA9IHRoaXMudHh0XzEudGV4dDtcblxuICAgICAgICAgICAgaWYgKCh0aGlzLnR4dEFycmF5W3RoaXMudHh0X251bV09PSctJykmJih0aGlzLnR4dF9udW0hPTApKSB7XG4gICAgICAgICAgICAgICAgdGhpcy50eHRfbnVtKys7XG4gICAgICAgICAgICAgICAgdGhpcy50eHRfMS50ZXh0ID0gdHh0X2JmICsgJ1xcbicgKyB0aGlzLnR4dEFycmF5W3RoaXMudHh0X251bV07XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIHRoaXMudHh0XzEudGV4dCA9IHR4dF9iZiArIHRoaXMudHh0QXJyYXlbdGhpcy50eHRfbnVtXTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHRoaXMudHh0X251bSsrO1xuICAgICAgICAgICAgaWYgKHRoaXMudHh0X251bSA9PSB0aGlzLnR4dEFycmF5Lmxlbmd0aCAtIDEpIHtcbiAgICAgICAgICAgICAgICB0aGlzLnZvaWNlX3Nwcml0ZS5wbGF5KCdlbmRwJyk7XG4gICAgICAgICAgICAgICAgLy8gdGhpcy5nYW1lLmFkZC50d2VlbiggdGhpcy52b2ljZV9zcHJpdGUuc2NhbGUpLnRvKHt4OiAwLHk6MH0sIDEwMDAsIFBoYXNlci5FYXNpbmcuUXVhcnRpYy5PdXQsIHRydWUsIDMwMCk7XG4gICAgICAgICAgICAgICAgdmFyIGFlPXRoaXMuZ2FtZS5hZGQudHdlZW4oIHRoaXMuYWN0c2lyaS5zY2FsZSkudG8oe3g6IDEseToxfSwgMTAwMCwgUGhhc2VyLkVhc2luZy5Cb3VuY2UuT3V0LCB0cnVlLCAzMDApO1xuICAgICAgICAgICAgICAgIGFlLm9uQ29tcGxldGUuYWRkKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgICAgIGlmKHRoYXQubG9uZ3RpbWUhPXVuZGVmaW5lZCl7XG4gICAgICAgICAgICAgICAgICAgICAgICBnYW1lLnRpbWUuZXZlbnRzLnJlbW92ZSh0aGF0Lmxvbmd0aW1lKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgICAgIHZhciBlYTEgPSB0aGlzLmFkZC50d2Vlbih0aGlzLmFjdHNpcmkpLnRvKHthbmdsZTogWzAsLTUsMCw1LDBdfSwgMjAwLCBudWxsLCB0cnVlLCAzMDAsIC0xLCB0cnVlKTtcbiAgICAgICAgICAgICAgICAgICAgdmFyIGVhMiA9IHRoaXMuYWRkLnR3ZWVuKHRoaXMuYWN0c2lyaS5zY2FsZSkudG8oe3g6IDEuMiwgeTogMS4yfSwgMjAwLCBudWxsLCB0cnVlLCAzMDAsIC0xLCB0cnVlKTtcbiAgICAgICAgICAgICAgICAgICAgZWExLnJlcGVhdERlbGF5KDEwMDApO1xuICAgICAgICAgICAgICAgICAgICBlYTIucmVwZWF0RGVsYXkoMTAwMCk7XG4gICAgICAgICAgICAgICAgICAgIC8vIHRoaXMuZ2FtZS50aW1lLmV2ZW50cy5hZGQoMTAwMCwgZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgICAgICAvLyAgICAgdGhhdC5hY3RzaXJpLmlucHV0RW5hYmxlZD1mYWxzZTtcbiAgICAgICAgICAgICAgICAgICAgLy8gICAgIHRoYXQuYWN0c2lyaS5raWxsKCk7XG4gICAgICAgICAgICAgICAgICAgIC8vICAgICB0aGF0LmdvQmFjaygpO1xuICAgICAgICAgICAgICAgICAgICAvL1xuICAgICAgICAgICAgICAgICAgICAvLyB9LHRoaXMpXG4gICAgICAgICAgICAgICAgfSx0aGlzKTtcblxuXG4gICAgICAgICAgICB9XG5cbiAgICAgICAgfSxcblxuICAgICAgICB1cGRhdGU6IGZ1bmN0aW9uICgpIHtcblxuICAgICAgICB9LFxuXG4gICAgICAgIG9uRG93bjogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgLy8gdGhpcy5nYW1lLnN0YXRlLnN0YXJ0KCdNZ2FtZScpO1xuICAgICAgICB9XG4gICAgfTtcblxufSgpKTsiLCIvKipcbiAqIENyZWF0ZWQgYnkgc2FuY2hleiBvbiAxNi82LzIwLlxuICovXG4oZnVuY3Rpb24gKCkge1xuICAgICd1c2Ugc3RyaWN0JztcblxuICAgIHZhciBNbmFtZSA9IGZ1bmN0aW9uICgpIHtcblxuICAgIH07XG5cbiAgICBtb2R1bGUuZXhwb3J0cyA9IE1uYW1lO1xuXG4gICAgTW5hbWUucHJvdG90eXBlID0ge1xuICAgICAgICByZW5kZXJMb2FkOiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICB2YXIgdGhhdCA9IHRoaXM7XG4gICAgICAgICAgICB0aGlzLmxvYWQub25Mb2FkQ29tcGxldGUuYWRkT25jZShmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgd2luZG93LmhhdmVsb2FkZWQgPSB0cnVlO1xuICAgICAgICAgICAgfSwgdGhpcyk7XG5cbiAgICAgICAgICAgIHRoaXMubG9hZC5hdWRpbygncTAnLCAnYXNzZXRzL2F1ZGlvL3EwLm1wMycpO1xuICAgICAgICAgICAgdGhpcy5sb2FkLmF1ZGlvKCdxMF8xJywgJ2Fzc2V0cy9hdWRpby9xMF8xLm1wMycpO1xuICAgICAgICAgICAgdGhpcy5sb2FkLnN0YXJ0KCk7XG5cbiAgICAgICAgfSxcbiAgICAgICAgY3JlYXRlOiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICB2YXIgdGhhdD10aGlzO1xuICAgICAgICAgICAgdGhpcy5idm9pY2Vfc3ByaXRlID0gdGhpcy5hZGQuc3ByaXRlKDM3NSwgMTIwNiwgJ2J2b2ljZV9zcHJpdGUnKTtcbiAgICAgICAgICAgIHRoaXMuYnZvaWNlX3Nwcml0ZS5hbmNob3Iuc2V0VG8oMC41LCAxKTtcbiAgICAgICAgICAgIHRoaXMuYnZvaWNlX3Nwcml0ZS5hbmltYXRpb25zLmFkZCgnc3RhcnRwJywgWzAsIDEsIDIsIDMsIDQsIDUsIDYsIDddLCAxNSwgZmFsc2UpO1xuICAgICAgICAgICAgdGhpcy5idm9pY2Vfc3ByaXRlLmFuaW1hdGlvbnMuYWRkKCdsb29wcCcsIFs4LCA5LCAxMCwgMTEsIDEyLCAxMywgMTQsIDE1LCAxNiwgMTcsIDE4LCAxOSwgMjAsIDIxLCAyMiwgMjMsIDI0LCAyNSwgMjYsIDI3XSwgMTUsIHRydWUpO1xuICAgICAgICAgICAgdGhpcy5idm9pY2Vfc3ByaXRlLmFuaW1hdGlvbnMuYWRkKCdlbmRwJywgWzcsIDYsIDUsIDQsIDMsIDIsIDEsIDBdLCAxNSwgZmFsc2UpO1xuXG5cbiAgICAgICAgICAgIHRoaXMuYmFja19idG4gPSB0aGlzLmFkZC5zcHJpdGUoMzc1LCAxMTA2LCAnYmFja19idG4nKTtcbiAgICAgICAgICAgIHRoaXMuYmFja19idG4uYW5jaG9yLnNldFRvKDAuNSk7XG4gICAgICAgICAgICB0aGlzLmJhY2tfYnRuLnNjYWxlLnNldFRvKDApO1xuICAgICAgICAgICAgdGhpcy5iYWNrX2J0bi5pbnB1dEVuYWJsZWQgPSB0cnVlO1xuICAgICAgICAgICAgdGhpcy5iYWNrX2J0bi5ldmVudHMub25JbnB1dERvd24uYWRkT25jZShmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5iYWNrX2J0bi5hbHBoYSA9IDAuNjtcbiAgICAgICAgICAgIH0sIHRoaXMpO1xuICAgICAgICAgICAgdGhpcy5iYWNrX2J0bi5ldmVudHMub25JbnB1dFVwLmFkZE9uY2UoZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgICQoXCIjbmFtZV93cmFwcGVyXCIpLmNzcyhcImRpc3BsYXlcIiwgXCJub25lXCIpO1xuXG4gICAgICAgICAgICAgICAgJChcIi5uYW1lX3N1Y2Nlc3NcIikucmVtb3ZlQ2xhc3MoXCJuYW1lX3MxXCIpLmFkZENsYXNzKFwibmFtZV9zMlwiKTtcbiAgICAgICAgICAgICAgICB0aGlzLmdhbWUuc3RhdGUuc3RhcnQoJ0dhbWUnKTtcbiAgICAgICAgICAgIH0sIHRoaXMpO1xuXG4gICAgICAgICAgICBpZighd2luZG93LmFuZHJvaWR8fHdpbmRvdy5hbmRyb2lkdil7XG4gICAgICAgICAgICAgICAgaWYod2luZG93LmhhdmVuYW1lZCl7XG4gICAgICAgICAgICAgICAgICAgIHRoYXQucW5hbWUgPSBuZXcgSG93bCh7XG4gICAgICAgICAgICAgICAgICAgICAgICBzcmM6IFsnYXNzZXRzL2F1ZGlvL3EwXzEubXAzJ11cbiAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgfWVsc2Uge1xuICAgICAgICAgICAgICAgICAgICB0aGF0LnFuYW1lID0gbmV3IEhvd2woe1xuICAgICAgICAgICAgICAgICAgICAgICAgc3JjOiBbJ2Fzc2V0cy9hdWRpby9xMC5tcDMnXVxuICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGlmICghd2luZG93LmhhdmVuYW1lZCkge1xuICAgICAgICAgICAgICAgIHRoaXMucmVuZGVySW5wdXQoKTtcbiAgICAgICAgICAgICAgICB0aGlzLmJhYnl0eHQxID0gdGhpcy5hZGQuYml0bWFwVGV4dCg0NCwgMTY2LCAnYmFieWZvbnQnLCAn5oiR5Y+rQmFieSBTaXJp77yMJywgMzYpO1xuICAgICAgICAgICAgICAgIHRoaXMuYmFieXR4dDIgPSB0aGlzLmFkZC5iaXRtYXBUZXh0KDQ0LCAyMjYsICdiYWJ5Zm9udCcsICfkvaDmnaXnu5nmiJHlj5bkuIDkuKrmm7Tlpb3lkKznmoTlkI3lrZflkKcnLCAzNik7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIHRoaXMuYmFieXR4dDEgPSB0aGlzLmFkZC5iaXRtYXBUZXh0KDQ0LCAxNjYsICdiYWJ5Zm9udCcsICfmiJHnmoTlkI3lrZflj6/mmK/kvaDlj5bnmoTlk6bvvIwnLCAzNik7XG4gICAgICAgICAgICAgICAgdGhpcy5iYWJ5dHh0MiA9IHRoaXMuYWRkLmJpdG1hcFRleHQoNDQsIDIyNiwgJ2JhYnlmb250JywgJ+S4jeiusOW+l+S6huWQl++8nycsIDM2KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHRoaXMubWFzazEgPSBnYW1lLmFkZC5ncmFwaGljcygwLCAwKTtcbiAgICAgICAgICAgIHRoaXMubWFzazEuYmVnaW5GaWxsKDB4ZmZmZmZmKTtcbiAgICAgICAgICAgIHRoaXMubWFzazEuZHJhd1JlY3QoNDQgLSA1MzgsIDE2NiwgNTM4LCA0MCk7XG4gICAgICAgICAgICB0aGlzLm1hc2sxLmVuZEZpbGwoKTtcbiAgICAgICAgICAgIHRoaXMuYmFieXR4dDEubWFzayA9IHRoaXMubWFzazE7XG5cbiAgICAgICAgICAgIHRoaXMubWFzazIgPSBnYW1lLmFkZC5ncmFwaGljcygwLCAwKTtcbiAgICAgICAgICAgIHRoaXMubWFzazIuYmVnaW5GaWxsKDB4ZmZmZmZmKTtcbiAgICAgICAgICAgIHRoaXMubWFzazIuZHJhd1JlY3QoNDQgLSA1MzgsIDIyNiwgNTM4LCA0MCk7XG4gICAgICAgICAgICB0aGlzLm1hc2syLmVuZEZpbGwoKTtcbiAgICAgICAgICAgIHRoaXMuYmFieXR4dDIubWFzayA9IHRoaXMubWFzazI7XG4gICAgICAgICAgICAvL3BsYXkgYXVkaW9cbiAgICAgICAgICAgIC8vZW5kXG4gICAgICAgICAgICB2YXIgdDIgPSB0aGlzLmFkZC5iaXRtYXBUZXh0KDczMywgNjMsICdiYWJ5Zm9udCcsICfigJzkvaDlj6vku4DkuYjlkI3lrZfigJ0nLCAzNik7XG4gICAgICAgICAgICB0Mi5hbmNob3Iuc2V0VG8oMSwgMCk7XG4gICAgICAgICAgICB2YXIgYzEgPSBnYW1lLmFkZC50d2Vlbih0MikuZnJvbSh7XG4gICAgICAgICAgICAgICAgeDogNzUwICsgMjAwLFxuICAgICAgICAgICAgICAgIGFscGhhOiAwXG4gICAgICAgICAgICB9LCAxMDAwLCBQaGFzZXIuRWFzaW5nLkJvdW5jZS5PdXQsIHRydWUsIDIwKTtcbiAgICAgICAgICAgIGMxLm9uQ29tcGxldGUuYWRkKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICB0aGlzLnFsb2FkZXIgPSB0aGlzLmFkZC5zcHJpdGUoMTIyLCAxODAsICdxbG9hZGVyJyk7XG4gICAgICAgICAgICAgICAgdGhpcy5xbG9hZGVyLmFuY2hvci5zZXRUbygwLjUpO1xuICAgICAgICAgICAgICAgIHRoaXMucWxvYWRlci5zY2FsZS5zZXRUbygwLjUpO1xuICAgICAgICAgICAgICAgIHRoaXMucWxfYWltID0gdGhpcy5xbG9hZGVyLmFuaW1hdGlvbnMuYWRkKCdxbCcsIFswLCAxLCAyLCAzLCA0LCA1LCA2LCA3LCA4LCA5LCAxMCwgMTEsIDAsIDEsIDIsIDMsIDQsIDUsIDYsIDcsIDgsIDksIDEwLCAxMSwgMCwgMSwgMiwgMywgNCwgNSwgNiwgNywgOCwgOSwgMTAsIDExLCAwLCAxLCAyLCAzLCA0LCA1LCA2LCA3LCA4LCA5LCAxMCwgMTFdKTtcbiAgICAgICAgICAgICAgICB0aGlzLnFsX2FpbS5wbGF5KDE3LCB0cnVlKTtcbiAgICAgICAgICAgICAgICB0aGlzLnJlbmRlckxvYWQoKTtcbiAgICAgICAgICAgICAgICAvLyB0aGlzLnJlbmRlclR4dE1hc2soKTtcbiAgICAgICAgICAgIH0sIHRoaXMpO1xuXG4gICAgICAgIH0sXG4gICAgICAgIHVwZGF0ZTogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgaWYgKHdpbmRvdy5oYXZlbG9hZGVkKSB7XG4gICAgICAgICAgICAgICAgd2luZG93LmhhdmVsb2FkZWQgPSBmYWxzZTtcbiAgICAgICAgICAgICAgICB0aGlzLnFsX2FpbS5zdG9wKCk7XG4gICAgICAgICAgICAgICAgLy8gdGhpcy5xbF9haW0ucGxheSgxNywgZmFsc2UpO1xuICAgICAgICAgICAgICAgIHRoaXMucWxvYWRlci5raWxsKCk7XG4gICAgICAgICAgICAgICAgaWYoIXdpbmRvdy5hbmRyb2lkfHx3aW5kb3cuYW5kcm9pZHYpe1xuICAgICAgICAgICAgICAgICAgICB0aGlzLnJlbmRlclR4dE1hc2tBKCk7XG4gICAgICAgICAgICAgICAgfWVsc2Uge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLnJlbmRlclR4dE1hc2soKTtcbiAgICAgICAgICAgICAgICB9XG5cblxuICAgICAgICAgICAgfVxuXG4gICAgICAgIH0sXG4gICAgICAgIHJlbmRlclR4dE1hc2tBOmZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHZhciB0aGF0ID0gdGhpcztcblxuXG4gICAgICAgICAgICB2YXIgYTEgPSB0aGlzLmJ2b2ljZV9zcHJpdGUucGxheSgnc3RhcnRwJyk7XG4gICAgICAgICAgICBhMS5vbkNvbXBsZXRlLmFkZChmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5idm9pY2Vfc3ByaXRlLnBsYXkoJ2xvb3BwJyk7XG4gICAgICAgICAgICB9LCB0aGlzKTtcblxuXG4gICAgICAgICAgICB2YXIgdGwxID0gdGhpcy5hZGQuaW1hZ2UoNDQsIDE2NiAtIDM1LCAndF9sJyk7XG4gICAgICAgICAgICB0bDEuYWxwaGEgPSAwO1xuICAgICAgICAgICAgdmFyIHRsMiA9IHRoaXMuYWRkLmltYWdlKDQ0LCAyMjYgLSAzNSwgJ3RfbCcpO1xuICAgICAgICAgICAgdGwyLmFscGhhID0gMDtcblxuICAgICAgICAgICAgdGhpcy5nYW1lLmFkZC50d2Vlbih0bDEpLnRvKHt4OiA1MzggKyA0NCwgYWxwaGE6IFsxLCAwLCAwXX0sIDE1MDAsIFBoYXNlci5FYXNpbmcuUXVhcnRpYy5PdXQsIHRydWUsIDMwMCk7XG4gICAgICAgICAgICB0aGlzLmdhbWUuYWRkLnR3ZWVuKHRsMikudG8oe1xuICAgICAgICAgICAgICAgIHg6IDUzOCArIDQ0LFxuICAgICAgICAgICAgICAgIGFscGhhOiBbMSwgMSwgMSwgMSwgMSwgMF1cbiAgICAgICAgICAgIH0sIDE1MDAsIFBoYXNlci5FYXNpbmcuUXVhcnRpYy5PdXQsIHRydWUsIDE4MDApO1xuXG4gICAgICAgICAgICB0aGlzLmdhbWUuYWRkLnR3ZWVuKHRoaXMubWFzazEpLnRvKHt4OiA1Mzh9LCAxNTAwLCBQaGFzZXIuRWFzaW5nLlF1YXJ0aWMuT3V0LCB0cnVlLCAzMDApO1xuICAgICAgICAgICAgdmFyIGMgPSB0aGlzLmdhbWUuYWRkLnR3ZWVuKHRoaXMubWFzazIpLnRvKHt4OiA1Mzh9LCAxNTAwLCBQaGFzZXIuRWFzaW5nLlF1YXJ0aWMuT3V0LCB0cnVlLCAxODAwKTtcbiAgICAgICAgICAgIC8vIHRoaXMuZ2FtZS5hZGQudHdlZW4odGhpcy5tYXNrMykudG8oe3g6IDUzOH0sIDUwMCwgUGhhc2VyLkVhc2luZy5RdWFydGljLk91dCwgdHJ1ZSwgOTAwKTtcblxuICAgICAgICAgICAgZnVuY3Rpb24gZW5kZWRIYW5kbGVyKCkge1xuICAgICAgICAgICAgICAgIHRoYXQuYnZvaWNlX3Nwcml0ZS5wbGF5KCdlbmRwJyk7XG4gICAgICAgICAgICAgICAgLy8gdmFyIG5hbWVfd3JhcHBlciA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwibmFtZV93cmFwcGVyXCIpO1xuICAgICAgICAgICAgICAgIHZhciBuYW1lX3dyYXBwZXIgPSAkKFwiI25hbWVfd3JhcHBlclwiKTtcbiAgICAgICAgICAgICAgICBuYW1lX3dyYXBwZXIuY3NzKHtcImRpc3BsYXlcIjogXCJibG9ja1wiLGhlaWdodDowfSk7XG4gICAgICAgICAgICAgICAgVHdlZW5NYXgudG8obmFtZV93cmFwcGVyLCAwLjgsIHtoZWlnaHQ6IDM4OCxvbkNvbXBsZXRlOmZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICAgICAgZ2FtZS5hZGQudHdlZW4odGhhdC5iYWNrX2J0bi5zY2FsZSkudG8oe1xuICAgICAgICAgICAgICAgICAgICAgICAgeDogMSxcbiAgICAgICAgICAgICAgICAgICAgICAgIHk6IDFcbiAgICAgICAgICAgICAgICAgICAgfSwgODAwLCBQaGFzZXIuRWFzaW5nLlF1YXJ0aWMuT3V0LCB0cnVlLCAxMDAwKS5vbkNvbXBsZXRlLmFkZChmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgZWEyID0gdGhhdC5hZGQudHdlZW4odGhhdC5iYWNrX2J0bi5zY2FsZSkudG8oe1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHg6IDEuNSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB5OiAxLjVcbiAgICAgICAgICAgICAgICAgICAgICAgIH0sIDEwMDAsIFBoYXNlci5FYXNpbmcuQm91bmNlLk91dCwgdHJ1ZSwgMzAwLCAtMSwgdHJ1ZSk7XG4gICAgICAgICAgICAgICAgICAgICAgICBlYTIucmVwZWF0RGVsYXkoMTUwMCk7XG4gICAgICAgICAgICAgICAgICAgIH0sIHRoaXMpO1xuICAgICAgICAgICAgICAgIH19KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHRoYXQucW5hbWUub25jZSgnZW5kJyxlbmRlZEhhbmRsZXIpO1xuICAgICAgICAgICAgdGhhdC5xbmFtZS5wbGF5KCk7XG4gICAgICAgIH0sXG4gICAgICAgIHJlbmRlclR4dE1hc2s6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHZhciB0aGF0ID0gdGhpcztcblxuXG4gICAgICAgICAgICB2YXIgYTEgPSB0aGlzLmJ2b2ljZV9zcHJpdGUucGxheSgnc3RhcnRwJyk7XG4gICAgICAgICAgICBhMS5vbkNvbXBsZXRlLmFkZChmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5idm9pY2Vfc3ByaXRlLnBsYXkoJ2xvb3BwJyk7XG4gICAgICAgICAgICB9LCB0aGlzKTtcblxuXG4gICAgICAgICAgICB2YXIgdGwxID0gdGhpcy5hZGQuaW1hZ2UoNDQsIDE2NiAtIDM1LCAndF9sJyk7XG4gICAgICAgICAgICB0bDEuYWxwaGEgPSAwO1xuICAgICAgICAgICAgdmFyIHRsMiA9IHRoaXMuYWRkLmltYWdlKDQ0LCAyMjYgLSAzNSwgJ3RfbCcpO1xuICAgICAgICAgICAgdGwyLmFscGhhID0gMDtcblxuICAgICAgICAgICAgdGhpcy5nYW1lLmFkZC50d2Vlbih0bDEpLnRvKHt4OiA1MzggKyA0NCwgYWxwaGE6IFsxLCAwLCAwXX0sIDE1MDAsIFBoYXNlci5FYXNpbmcuUXVhcnRpYy5PdXQsIHRydWUsIDMwMCk7XG4gICAgICAgICAgICB0aGlzLmdhbWUuYWRkLnR3ZWVuKHRsMikudG8oe1xuICAgICAgICAgICAgICAgIHg6IDUzOCArIDQ0LFxuICAgICAgICAgICAgICAgIGFscGhhOiBbMSwgMSwgMSwgMSwgMSwgMF1cbiAgICAgICAgICAgIH0sIDE1MDAsIFBoYXNlci5FYXNpbmcuUXVhcnRpYy5PdXQsIHRydWUsIDE4MDApO1xuXG4gICAgICAgICAgICB0aGlzLmdhbWUuYWRkLnR3ZWVuKHRoaXMubWFzazEpLnRvKHt4OiA1Mzh9LCAxNTAwLCBQaGFzZXIuRWFzaW5nLlF1YXJ0aWMuT3V0LCB0cnVlLCAzMDApO1xuICAgICAgICAgICAgdmFyIGMgPSB0aGlzLmdhbWUuYWRkLnR3ZWVuKHRoaXMubWFzazIpLnRvKHt4OiA1Mzh9LCAxNTAwLCBQaGFzZXIuRWFzaW5nLlF1YXJ0aWMuT3V0LCB0cnVlLCAxODAwKTtcbiAgICAgICAgICAgIC8vIHRoaXMuZ2FtZS5hZGQudHdlZW4odGhpcy5tYXNrMykudG8oe3g6IDUzOH0sIDUwMCwgUGhhc2VyLkVhc2luZy5RdWFydGljLk91dCwgdHJ1ZSwgOTAwKTtcblxuICAgICAgICAgICAgdmFyICRxYXVkaW8gPSAkKFwiI3FhdWRpb1wiKTtcbiAgICAgICAgICAgIGlmICh3aW5kb3cuaGF2ZW5hbWVkKSB7XG4gICAgICAgICAgICAgICAgdmFyIHEwID0gJHFhdWRpby5maW5kKCcucTBfMScpXG5cbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgdmFyIHEwID0gJHFhdWRpby5maW5kKCcucTAnKVxuICAgICAgICAgICAgfVxuXG5cbiAgICAgICAgICAgIGZ1bmN0aW9uIGVuZGVkSGFuZGxlcigpIHtcbiAgICAgICAgICAgICAgICB0aGF0LmJ2b2ljZV9zcHJpdGUucGxheSgnZW5kcCcpO1xuICAgICAgICAgICAgICAgIC8vIHZhciBuYW1lX3dyYXBwZXIgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcIm5hbWVfd3JhcHBlclwiKTtcbiAgICAgICAgICAgICAgICB2YXIgbmFtZV93cmFwcGVyID0gJChcIiNuYW1lX3dyYXBwZXJcIik7XG4gICAgICAgICAgICAgICAgbmFtZV93cmFwcGVyLmNzcyh7XCJkaXNwbGF5XCI6IFwiYmxvY2tcIixoZWlnaHQ6MH0pO1xuICAgICAgICAgICAgICAgIFR3ZWVuTWF4LnRvKG5hbWVfd3JhcHBlciwgMC44LCB7aGVpZ2h0OiAzODgsb25Db21wbGV0ZTpmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgICAgIGdhbWUuYWRkLnR3ZWVuKHRoYXQuYmFja19idG4uc2NhbGUpLnRvKHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHg6IDEsXG4gICAgICAgICAgICAgICAgICAgICAgICB5OiAxXG4gICAgICAgICAgICAgICAgICAgIH0sIDgwMCwgUGhhc2VyLkVhc2luZy5RdWFydGljLk91dCwgdHJ1ZSwgMTAwMCkub25Db21wbGV0ZS5hZGQoZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGVhMiA9IHRoYXQuYWRkLnR3ZWVuKHRoYXQuYmFja19idG4uc2NhbGUpLnRvKHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB4OiAxLjUsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgeTogMS41XG4gICAgICAgICAgICAgICAgICAgICAgICB9LCAxMDAwLCBQaGFzZXIuRWFzaW5nLkJvdW5jZS5PdXQsIHRydWUsIDMwMCwgLTEsIHRydWUpO1xuICAgICAgICAgICAgICAgICAgICAgICAgZWEyLnJlcGVhdERlbGF5KDE1MDApO1xuICAgICAgICAgICAgICAgICAgICB9LCB0aGlzKTtcbiAgICAgICAgICAgICAgICB9fSk7XG4gICAgICAgICAgICAgICAgcTAudW5iaW5kKCdlbmRlZCcsZW5kZWRIYW5kbGVyKTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgcTAuYmluZCgnZW5kZWQnLGVuZGVkSGFuZGxlcik7XG5cbiAgICAgICAgICAgIHEwWzBdLnBsYXkoKTtcblxuXG4gICAgICAgIH0sXG4gICAgICAgIHJlbmRlclRpcHM6IGZ1bmN0aW9uIChtc2csIGR1cmluZykge1xuICAgICAgICAgICAgdmFyICR3aW4gPSAkKFwiI3BfdGlwc1wiKTtcbiAgICAgICAgICAgIGNsZWFyVGltZW91dCgkd2luLmF0dHIoXCJ0aW1laWRcIikpO1xuICAgICAgICAgICAgJHdpbi5odG1sKG1zZyk7XG4gICAgICAgICAgICAkd2luLmZhZGVJbig1MDApO1xuICAgICAgICAgICAgaWYgKCEhZHVyaW5nKSB7XG4gICAgICAgICAgICAgICAgJHdpbi5hdHRyKFwidGltZWlkXCIsIHNldFRpbWVvdXQoZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgICAgICAkd2luLmZhZGVPdXQoNTAwKTtcbiAgICAgICAgICAgICAgICB9LCBkdXJpbmcpKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSxcbiAgICAgICAgcmVuZGVySW5wdXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHZhciB0aGF0ID0gdGhpcztcbiAgICAgICAgICAgICQoXCIjbmFtZV9idG5cIikub24oXCJjbGlja1wiLCBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgLy8gY29uc29sZS5sb2coXCJja1wiKVxuICAgICAgICAgICAgICAgIGlmICgkKHRoaXMpLmhhc0NsYXNzKFwiYmVzdWJtaXRcIikpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB2YXIgX3NpcmluYW1lID0gJChcIiNzaXJpbmFtZVwiKS52YWwoKTtcblxuICAgICAgICAgICAgICAgIGlmICgkLnRyaW0oX3NpcmluYW1lKSA9PSBcIlwiKSB7XG4gICAgICAgICAgICAgICAgICAgIHRoYXQucmVuZGVyVGlwcyhcIuWQjeWtl+epuuepun5cIiwgMTUwMCk7XG4gICAgICAgICAgICAgICAgICAgICQoXCIjc2lyaW5hbWVcIikuZm9jdXMoKTtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBpZiAoIXRoYXQuaXNOYW1lKF9zaXJpbmFtZSkpIHtcbiAgICAgICAgICAgICAgICAgICAgdGhhdC5yZW5kZXJUaXBzKFwi5ZCN5a2X5aSqbG935LqGXCIsIDE1MDApO1xuICAgICAgICAgICAgICAgICAgICAkKFwiI3NpcmluYW1lXCIpLmZvY3VzKCk7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAkKFwiI3N1Ym1pdF9idG5cIikuYWRkQ2xhc3MoXCJiZXN1Ym1pdFwiKTtcbiAgICAgICAgICAgICAgICAkKFwiLmlucHV0X3dyYXBwZXJcIikuZmluZChcImlucHV0XCIpWzBdLnJlYWRPbmx5ID0gdHJ1ZTtcblxuICAgICAgICAgICAgICAgIHdpbmRvdy5oYXZlbmFtZWQgPSB0cnVlO1xuICAgICAgICAgICAgICAgIHdpbmRvdy5zaXJpbmFtZSA9IF9zaXJpbmFtZTtcblxuICAgICAgICAgICAgICAgIHZhciBzaGFyZV90eHQgPSBcIuaIkeeahGJhYnnniYhzaXJp5ZCN5Y+rXCIgKyB3aW5kb3cuc2lyaW5hbWUgKyBcIu+8jOS9oOeahOWRou+8n1wiO1xuXG4gICAgICAgICAgICAgICAgd2luZG93LnNoYXJlLnNldCgndGltZWxpbmUnLCAndGl0bGUnLCBzaGFyZV90eHQpO1xuICAgICAgICAgICAgICAgIHdpbmRvdy5zaGFyZS5zZXQoJ2FwcG1lc3NhZ2UnLCAndGl0bGUnLCBcIkhlbGxvIFdvcmxkXCIpO1xuICAgICAgICAgICAgICAgIHdpbmRvdy5zaGFyZS5zZXQoJ2FwcG1lc3NhZ2UnLCAnZGVzYycsIHNoYXJlX3R4dCk7XG5cbiAgICAgICAgICAgICAgICB2YXIgJG5hbWVfdHh0ID0gJChcIiNuYW1lX3R4dFwiKTtcbiAgICAgICAgICAgICAgICAkbmFtZV90eHQuaHRtbCh3aW5kb3cuc2lyaW5hbWUpO1xuICAgICAgICAgICAgICAgICQoXCIubmFtZV9jb250ZW50MVwiKS5jc3MoXCJkaXNwbGF5XCIsIFwibm9uZVwiKTtcbiAgICAgICAgICAgICAgICAkKFwiLm5hbWVfY29udGVudDJcIikuY3NzKFwiZGlzcGxheVwiLCBcImJsb2NrXCIpO1xuXG4gICAgICAgICAgICAgICAgdGhhdC5nYW1lLmFkZC50d2Vlbih0aGF0LmJhY2tfYnRuLnNjYWxlKS50byh7XG4gICAgICAgICAgICAgICAgICAgIHg6IDEsXG4gICAgICAgICAgICAgICAgICAgIHk6IDFcbiAgICAgICAgICAgICAgICB9LCA4MDAsIFBoYXNlci5FYXNpbmcuUXVhcnRpYy5PdXQsIHRydWUpLm9uQ29tcGxldGUuYWRkKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICAgICAgdmFyIGVhMiA9IHRoYXQuYWRkLnR3ZWVuKHRoYXQuYmFja19idG4uc2NhbGUpLnRvKHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHg6IDEuNSxcbiAgICAgICAgICAgICAgICAgICAgICAgIHk6IDEuNVxuICAgICAgICAgICAgICAgICAgICB9LCAxMDAwLCBQaGFzZXIuRWFzaW5nLkJvdW5jZS5PdXQsIHRydWUsIDMwMCwgLTEsIHRydWUpO1xuICAgICAgICAgICAgICAgICAgICBlYTIucmVwZWF0RGVsYXkoMTUwMCk7XG5cbiAgICAgICAgICAgICAgICB9LCB0aGlzKTtcblxuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAvLyB0aGlzLmFkZC5zcHJpdGVcbiAgICAgICAgICAgIC8vIHZhciBjb250ZW50X2JnPXRoaXMuYWRkLmltYWdlKDM3NSw1MjIsJ2NvbnRlbnRfYmcnKTtcbiAgICAgICAgICAgIC8vIGNvbnRlbnRfYmcuYW5jaG9yLnNldFRvKDAuNSk7XG4gICAgICAgIH0sXG4gICAgICAgIGlzTmFtZTogZnVuY3Rpb24gKGlucHV0U3RyaW5nKSB7XG4gICAgICAgICAgICB2YXIgcGFydHRlbiA9IC9eW1xcdTRlMDAtXFx1OWZhNV9hLXpBLVowLTldKyQvO1xuICAgICAgICAgICAgaWYgKHBhcnR0ZW4udGVzdChpbnB1dFN0cmluZykpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICB9XG4gICAgfTtcbn0oKSk7IiwiLyoqXG4gKiBDcmVhdGVkIGJ5IHNhbmNoZXogb24gMTYvNi8xNi5cbiAqL1xuKGZ1bmN0aW9uICgpIHtcbiAgICAndXNlIHN0cmljdCc7XG4gICAgdmFyIE1vdmllQ2xpcCA9IHJlcXVpcmUoJy4uL2VudGl0aWVzL01vdmllQ2xpcCcpO1xuICAgIHZhciBNdmlkZW8gPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHRoaXMuYnZpZGVvID0gbnVsbDtcblxuICAgIH07XG5cbiAgICBtb2R1bGUuZXhwb3J0cyA9IE12aWRlbztcblxuICAgIE12aWRlby5wcm90b3R5cGUgPSB7XG4gICAgICAgIGNyZWF0ZTogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgdmFyIHRoYXQgPSB0aGlzO1xuICAgICAgICAgICAgd2luZG93LmVuZF9uID0gMDtcbiAgICAgICAgICAgIHRoaXMuYnZvaWNlX3Nwcml0ZSA9IHRoaXMuYWRkLnNwcml0ZSgzNzUsIDEyMDYsICdidm9pY2Vfc3ByaXRlJyk7XG4gICAgICAgICAgICB0aGlzLmJ2b2ljZV9zcHJpdGUuYW5jaG9yLnNldFRvKDAuNSwgMSk7XG4gICAgICAgICAgICB0aGlzLmJ2b2ljZV9zcHJpdGUuYW5jaG9yLnNldFRvKDAuNSwgMSk7XG4gICAgICAgICAgICB0aGlzLmJ2b2ljZV9zcHJpdGUuYW5pbWF0aW9ucy5hZGQoJ3N0YXJ0cCcsIFswLCAxLCAyLCAzLCA0LCA1LCA2LCA3XSwgMTUsIGZhbHNlKTtcbiAgICAgICAgICAgIHRoaXMuYnZvaWNlX3Nwcml0ZS5hbmltYXRpb25zLmFkZCgnbG9vcHAnLCBbOCwgOSwgMTAsIDExLCAxMiwgMTMsIDE0LCAxNSwgMTYsIDE3LCAxOCwgMTksIDIwLCAyMSwgMjIsIDIzLCAyNCwgMjUsIDI2LCAyN10sIDE1LCB0cnVlKTtcbiAgICAgICAgICAgIHRoaXMuYnZvaWNlX3Nwcml0ZS5hbmltYXRpb25zLmFkZCgnZW5kcCcsIFs3LCA2LCA1LCA0LCAzLCAyLCAxLCAwXSwgMTUsIGZhbHNlKTtcblxuXG4gICAgICAgICAgICB0aGlzLmJhY2tfYnRuID0gdGhpcy5hZGQuc3ByaXRlKDM3NSwgMTEwNiwgJ2JhY2tfYnRuJyk7XG4gICAgICAgICAgICB0aGlzLmJhY2tfYnRuLmFuY2hvci5zZXRUbygwLjUpO1xuICAgICAgICAgICAgdGhpcy5iYWNrX2J0bi5zY2FsZS5zZXRUbygwKTtcbiAgICAgICAgICAgIHRoaXMuYmFja19idG4uaW5wdXRFbmFibGVkID0gdHJ1ZTtcbiAgICAgICAgICAgIHRoaXMuYmFja19idG4uZXZlbnRzLm9uSW5wdXREb3duLmFkZE9uY2UoZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgIHRoaXMuYmFja19idG4uYWxwaGEgPSAwLjY7XG4gICAgICAgICAgICB9LCB0aGlzKTtcbiAgICAgICAgICAgIHRoaXMuYmFja19idG4uZXZlbnRzLm9uSW5wdXRVcC5hZGRPbmNlKGZ1bmN0aW9uICgpIHtcblxuICAgICAgICAgICAgICAgIGlmICghd2luZG93LmFuZHJvaWR8fHdpbmRvdy5hbmRyb2lkdikge1xuICAgICAgICAgICAgICAgICAgICAvLyB2YXIgbXZkPSQoXCIjdmF1ZGlvXCIpWzBdO1xuICAgICAgICAgICAgICAgICAgICAvLyBtdmQucGF1c2UoKTtcbiAgICAgICAgICAgICAgICAgICAgLy8gJChcIiN2YXVkaW9cIikuZmluZChcIi5idlwiK3dpbmRvdy5xdWVzdGlvbl9ubylbMF0ucGF1c2UoKTtcbiAgICAgICAgICAgICAgICAgICAgdGhhdC4kYnYucGF1c2UoKTtcbiAgICAgICAgICAgICAgICAgICAgLy8gbXZkLnNyYyA9IFwiXCI7XG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgdmFyIG12aWRlbyA9ICQoXCIjbXZpZGVvXCIpWzBdO1xuICAgICAgICAgICAgICAgICAgICBtdmlkZW8ucGF1c2UoKTtcbiAgICAgICAgICAgICAgICAgICAgbXZpZGVvLnNyYyA9IFwiXCI7XG4gICAgICAgICAgICAgICAgICAgIG12aWRlby5wb3N0ZXIgPSBcIlwiO1xuICAgICAgICAgICAgICAgICAgICAkKFwiI3ZpZGVvX3dyYXBwZXJcIikuY3NzKHtcbiAgICAgICAgICAgICAgICAgICAgICAgIFwiZGlzcGxheVwiOiBcIm5vbmVcIixcbiAgICAgICAgICAgICAgICAgICAgICAgIFwid2lkdGhcIjogMCxcbiAgICAgICAgICAgICAgICAgICAgICAgIFwiaGVpZ2h0XCI6IDAsXG4gICAgICAgICAgICAgICAgICAgICAgICBcInRvcFwiOiAzMDAgLyAxMjA2ICogd2luZG93LmlubmVySGVpZ2h0XG4gICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB0aGlzLmdhbWUuc3RhdGUuc3RhcnQoJ0dhbWUnKTtcblxuXG4gICAgICAgICAgICB9LCB0aGlzKTtcbiAgICAgICAgICAgIHRoaXMuYmFja19idG4uYnJpbmdUb1RvcCgpO1xuXG4gICAgICAgICAgICBpZiAod2luZG93LnF1ZXN0aW9uX25vID09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgICAgIHdpbmRvdy5xdWVzdGlvbl9ubyA9IDE1O1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICB2YXIgdDIgPSB0aGlzLmFkZC5iaXRtYXBUZXh0KDczMywgNjMsICdiYWJ5Zm9udCcsICfigJwnICsgd2luZG93LnF1QXJyYXlbd2luZG93LnF1ZXN0aW9uX25vXSArICfigJ0nLCAzNik7XG4gICAgICAgICAgICB0Mi5hbmNob3Iuc2V0VG8oMSwgMCk7XG4gICAgICAgICAgICB2YXIgYzEgPSBnYW1lLmFkZC50d2Vlbih0MikuZnJvbSh7XG4gICAgICAgICAgICAgICAgeDogNzUwICsgMjAwLFxuICAgICAgICAgICAgICAgIGFscGhhOiAwXG4gICAgICAgICAgICB9LCA4MDAsIFBoYXNlci5FYXNpbmcuQm91bmNlLk91dCwgdHJ1ZSwgMjApO1xuXG5cbiAgICAgICAgICAgIC8vIHZhciBjMj0gZ2FtZS5hZGQudHdlZW4odDIpLmZyb20oIHsgeDogMjAwKk1hdGgucmFuZG9tKCkseToyMDAqTWF0aC5yYW5kb20oKSxhbHBoYTowfSwgMTAwMCwgUGhhc2VyLkVhc2luZy5RdWFydGljLk91dCx0cnVlLDUwMCk7XG5cbiAgICAgICAgICAgIGMxLm9uQ29tcGxldGUuYWRkKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICB0aGlzLnFsb2FkZXIgPSB0aGlzLmFkZC5zcHJpdGUoMTIyLCAxODAsICdxbG9hZGVyJyk7XG4gICAgICAgICAgICAgICAgdGhpcy5xbG9hZGVyLmFuY2hvci5zZXRUbygwLjUpO1xuICAgICAgICAgICAgICAgIHRoaXMucWxvYWRlci5zY2FsZS5zZXRUbygwLjUpO1xuXG4gICAgICAgICAgICAgICAgdGhpcy5xbG9hZGVyLmFuY2hvci5zZXRUbygwLjUpO1xuXG5cbiAgICAgICAgICAgICAgICB0aGlzLnFsX2FpbSA9IHRoaXMucWxvYWRlci5hbmltYXRpb25zLmFkZCgncWwnLCBbMCwgMSwgMiwgMywgNCwgNSwgNiwgNywgOCwgOSwgMTAsIDExLCAwLCAxLCAyLCAzLCA0LCA1LCA2LCA3LCA4LCA5LCAxMCwgMTEsIDAsIDEsIDIsIDMsIDQsIDUsIDYsIDcsIDgsIDksIDEwLCAxMSwgMCwgMSwgMiwgMywgNCwgNSwgNiwgNywgOCwgOSwgMTAsIDExXSk7XG4gICAgICAgICAgICAgICAgdGhpcy5xbF9haW0ucGxheSgxNywgdHJ1ZSk7XG4gICAgICAgICAgICAgICAgaWYgKCF3aW5kb3cuYW5kcm9pZHx8d2luZG93LmFuZHJvaWR2KSB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMucmVuZGVyTG9hZEEoKTtcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLnJlbmRlckxvYWQoKTtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIH0sIHRoaXMpXG4gICAgICAgIH0sXG4gICAgICAgIHVwZGF0ZTogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgaWYgKHdpbmRvdy5oYXZlbG9hZGVkKSB7XG4gICAgICAgICAgICAgICAgd2luZG93LmhhdmVsb2FkZWQgPSBmYWxzZTtcbiAgICAgICAgICAgICAgICB0aGlzLnFsX2FpbS5zdG9wKCk7XG4gICAgICAgICAgICAgICAgLy8gdGhpcy5xbF9haW0ucGxheSgxNywgZmFsc2UpO1xuICAgICAgICAgICAgICAgIHRoaXMucWxvYWRlci5raWxsKCk7XG4gICAgICAgICAgICAgICAgaWYgKCF3aW5kb3cuYW5kcm9pZHx8d2luZG93LmFuZHJvaWR2KSB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuc2hvd0FuQSgpO1xuXG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5zaG93QW4oKTtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIH1cblxuICAgICAgICB9LFxuICAgICAgICBzaG93QW5BOiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICB2YXIgdGhhdCA9IHRoaXM7XG5cbiAgICAgICAgICAgIC8vIHZhciAkdmF1ZGlvPSQoXCIjdmF1ZGlvXCIpO1xuICAgICAgICAgICAgLy8gdmFyICRidj0kdmF1ZGlvLmZpbmQoJy5idicrIHdpbmRvdy5xdWVzdGlvbl9ubyk7XG4gICAgICAgICAgICB0aGlzLiRidiA9IG5ldyBIb3dsKHtcbiAgICAgICAgICAgICAgICBzcmM6IFsnYXNzZXRzL2F1ZGlvL2J2Jyt3aW5kb3cucXVlc3Rpb25fbm8rJy5tcDMnXVxuICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgIGlmICh3aW5kb3cuYXNBcnJheVt3aW5kb3cucXVlc3Rpb25fbm9dID09IG51bGwpIHtcbiAgICAgICAgICAgICAgICB2YXIgdmlkZW9fYmcgPSB0aGlzLmFkZC5pbWFnZSgwLCAxNjgsICd2aWRlb19iZycpO1xuXG4gICAgICAgICAgICAgICAgdmFyIG1hc2syID0gZ2FtZS5hZGQuZ3JhcGhpY3MoMCwgMCk7XG4gICAgICAgICAgICAgICAgbWFzazIuYmVnaW5GaWxsKDB4ZmZmZmZmKTtcbiAgICAgICAgICAgICAgICBtYXNrMi5kcmF3UmVjdCgwIC0gNzUwLCAxNjggLSA1NDgsIDc1MCwgNTQ4KTtcbiAgICAgICAgICAgICAgICBtYXNrMi5lbmRGaWxsKCk7XG4gICAgICAgICAgICAgICAgdmlkZW9fYmcubWFzayA9IG1hc2syO1xuXG4gICAgICAgICAgICAgICAgdmFyIGJ2ZiA9IHRoaXMuYWRkLmltYWdlKDQwLCA1NCwgJ2J2ZicgKyB3aW5kb3cucXVlc3Rpb25fbm8pO1xuICAgICAgICAgICAgICAgIHRoaXMuYnZpZGVvID0gbmV3IE1vdmllQ2xpcCh0aGlzLCA0MCwgNTQsIDY3MCwgNDQwLCB3aW5kb3cuYnZDb25maWdBcnJheVt3aW5kb3cucXVlc3Rpb25fbm9dLCBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgICAgIHRoYXQuJGJ2LnBhdXNlKCk7XG4gICAgICAgICAgICAgICAgICAgIC8vICRidlswXS5jdXJyZW50VGltZT0wO1xuICAgICAgICAgICAgICAgICAgICB0aGF0LiRidi5zZWVrKDApO1xuICAgICAgICAgICAgICAgICAgICB0aGF0LiRidi5wbGF5KCk7XG4gICAgICAgICAgICAgICAgICAgIC8vIHRoYXQudmF1ZGlvLnJlc3RhcnQoKTtcbiAgICAgICAgICAgICAgICAgICAgdGhhdC5idmlkZW8ucGxheVZpZGVvKCk7XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgdmlkZW9fYmcuYWRkQ2hpbGQoYnZmKTtcbiAgICAgICAgICAgICAgICB2aWRlb19iZy5hZGRDaGlsZCh0aGlzLmJ2aWRlbyk7XG5cblxuICAgICAgICAgICAgICAgIHZhciBjID0gZ2FtZS5hZGQudHdlZW4obWFzazIpLnRvKHt4OiA3NTAsIHk6IDU0OH0sIDgwMCwgUGhhc2VyLkVhc2luZy5RdWFydGljLk91dCwgdHJ1ZSwgNDAwKTtcbiAgICAgICAgICAgICAgICBjLm9uQ29tcGxldGUuYWRkKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICAgICAgLy8gJGJ2LmN1cnJlbnRUaW1lPTA7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuJGJ2LnNlZWsoMCk7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuJGJ2LnBsYXkoKTtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5idmlkZW8ucGxheVZpZGVvKCk7XG4gICAgICAgICAgICAgICAgICAgIGdhbWUuYWRkLnR3ZWVuKHRoYXQuYmFja19idG4uc2NhbGUpLnRvKHt4OiAxLCB5OiAxfSwgODAwLCBQaGFzZXIuRWFzaW5nLkJvdW5jZS5PdXQsIHRydWUpLm9uQ29tcGxldGUuYWRkKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBlYTIgPSB0aGF0LmFkZC50d2Vlbih0aGF0LmJhY2tfYnRuLnNjYWxlKS50byh7eDogMS41LCB5OiAxLjV9LCAxMDAwLCBQaGFzZXIuRWFzaW5nLkJvdW5jZS5PdXQsIHRydWUsIDMwMCwgLTEsdHJ1ZSk7XG4gICAgICAgICAgICAgICAgICAgICAgICBlYTIucmVwZWF0RGVsYXkoMTUwMCk7XG4gICAgICAgICAgICAgICAgICAgIH0sdGhpcyk7XG4gICAgICAgICAgICAgICAgfSwgdGhpcyk7XG5cbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgdmFyIHZpZGVvX2JnID0gdGhpcy5hZGQuaW1hZ2UoMCwgMjQ1LCAndmlkZW9fYmcnKTtcblxuICAgICAgICAgICAgICAgIHZhciBtYXNrMiA9IGdhbWUuYWRkLmdyYXBoaWNzKDAsIDApO1xuICAgICAgICAgICAgICAgIG1hc2syLmJlZ2luRmlsbCgweGZmZmZmZik7XG4gICAgICAgICAgICAgICAgbWFzazIuZHJhd1JlY3QoMCAtIDc1MCwgMjQ1IC0gNTQ4LCA3NTAsIDU0OCk7XG4gICAgICAgICAgICAgICAgbWFzazIuZW5kRmlsbCgpO1xuICAgICAgICAgICAgICAgIHZpZGVvX2JnLm1hc2sgPSBtYXNrMjtcblxuICAgICAgICAgICAgICAgIHZhciBhMSA9IHRoaXMuYnZvaWNlX3Nwcml0ZS5wbGF5KCdzdGFydHAnKTtcbiAgICAgICAgICAgICAgICBhMS5vbkNvbXBsZXRlLmFkZChmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuYnZvaWNlX3Nwcml0ZS5wbGF5KCdsb29wcCcpO1xuICAgICAgICAgICAgICAgIH0sIHRoaXMpO1xuICAgICAgICAgICAgICAgIHZhciBxdDEgPSB0aGlzLmFkZC5iaXRtYXBUZXh0KDQ0LCAxNjQsICdiYWJ5Zm9udCcsIHdpbmRvdy5hc0FycmF5W3dpbmRvdy5xdWVzdGlvbl9ub10sIDM2KTtcblxuICAgICAgICAgICAgICAgIHRoaXMubWFzazEgPSBnYW1lLmFkZC5ncmFwaGljcygwLCAwKTtcbiAgICAgICAgICAgICAgICB0aGlzLm1hc2sxLmJlZ2luRmlsbCgweGZmZmZmZik7XG4gICAgICAgICAgICAgICAgdGhpcy5tYXNrMS5kcmF3UmVjdCg0NCAtIDYwMCwgMTY0LCA2MDAsIDQwKTtcbiAgICAgICAgICAgICAgICB0aGlzLm1hc2sxLmVuZEZpbGwoKTtcbiAgICAgICAgICAgICAgICBxdDEubWFzayA9IHRoaXMubWFzazE7XG5cbiAgICAgICAgICAgICAgICB2YXIgdGwxID0gdGhpcy5hZGQuaW1hZ2UoNDQsIDE2NCAtIDI4LCAndF9sJyk7XG4gICAgICAgICAgICAgICAgdGwxLmFscGhhID0gMDtcbiAgICAgICAgICAgICAgICB0aGlzLmdhbWUuYWRkLnR3ZWVuKHRsMSkudG8oe1xuICAgICAgICAgICAgICAgICAgICB4OiA2MDAgKyA0NCxcbiAgICAgICAgICAgICAgICAgICAgYWxwaGE6IFsxLCAxLCAxLCAxLCAwXVxuICAgICAgICAgICAgICAgIH0sIDEwMDAsIFBoYXNlci5FYXNpbmcuUXVhcnRpYy5PdXQsIHRydWUsIDIwMCk7XG5cblxuICAgICAgICAgICAgICAgIGdhbWUuYWRkLnR3ZWVuKHRoaXMubWFzazEpLnRvKHt4OiA2MDB9LCAxMDAwLCBQaGFzZXIuRWFzaW5nLlF1YXJ0aWMuT3V0LCB0cnVlLCAyMDApO1xuICAgICAgICAgICAgICAgIC8vcGxheSBhdWRpb1xuICAgICAgICAgICAgICAgIC8vZW5kXG5cblxuXG5cblxuICAgICAgICAgICAgICAgIHZhciBhMSA9IHRoaXMuYnZvaWNlX3Nwcml0ZS5wbGF5KCdzdGFydHAnKTtcbiAgICAgICAgICAgICAgICBhMS5vbkNvbXBsZXRlLmFkZChmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuYnZvaWNlX3Nwcml0ZS5wbGF5KCdsb29wcCcpO1xuICAgICAgICAgICAgICAgIH0sIHRoaXMpO1xuICAgICAgICAgICAgICAgIC8vIHFhdWRpby5wbGF5KCk7XG4gICAgICAgICAgICAgICAgdmFyIHFlbmRlZEg9ZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICAgICAgICAgIHRoYXQuYnZvaWNlX3Nwcml0ZS5wbGF5KCdlbmRwJyk7XG4gICAgICAgICAgICAgICAgICAgIHZhciBidmYgPSB0aGF0LmFkZC5pbWFnZSg0MCwgNTQsICdidmYnICsgd2luZG93LnF1ZXN0aW9uX25vKTtcbiAgICAgICAgICAgICAgICAgICAgdGhhdC5idmlkZW8gPSBuZXcgTW92aWVDbGlwKHRoYXQsIDQwLCA1NCwgNjcwLCA0NDAsIHdpbmRvdy5idkNvbmZpZ0FycmF5W3dpbmRvdy5xdWVzdGlvbl9ub10sIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoYXQuJGJ2LnBhdXNlKCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAvLyAkYnZbMF0uY3VycmVudFRpbWU9MDtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoYXQuJGJ2LnNlZWsoMCk7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGF0LiRidi5wbGF5KCk7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGF0LmJ2aWRlby5wbGF5VmlkZW8oKTtcbiAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgIHZpZGVvX2JnLmFkZENoaWxkKGJ2Zik7XG4gICAgICAgICAgICAgICAgICAgIHZpZGVvX2JnLmFkZENoaWxkKHRoYXQuYnZpZGVvKTtcblxuXG4gICAgICAgICAgICAgICAgICAgIHZhciBjID0gZ2FtZS5hZGQudHdlZW4obWFzazIpLnRvKHt4OiA3NTAsIHk6IDU0OH0sIDgwMCwgUGhhc2VyLkVhc2luZy5RdWFydGljLk91dCwgdHJ1ZSwgNDAwKTtcbiAgICAgICAgICAgICAgICAgICAgYy5vbkNvbXBsZXRlLmFkZChmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAvLyAkYnZbMF0uY3VycmVudFRpbWU9MDtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoYXQuJGJ2LnNlZWsoMCk7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGF0LiRidi5wbGF5KCk7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGF0LmJ2aWRlby5wbGF5VmlkZW8oKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGdhbWUuYWRkLnR3ZWVuKHRoYXQuYmFja19idG4uc2NhbGUpLnRvKHt4OiAxLCB5OiAxfSwgODAwLCBQaGFzZXIuRWFzaW5nLkJvdW5jZS5PdXQsIHRydWUpLm9uQ29tcGxldGUuYWRkKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgZWEyID0gdGhhdC5hZGQudHdlZW4odGhhdC5iYWNrX2J0bi5zY2FsZSkudG8oe3g6IDEuNSwgeTogMS41fSwgMTAwMCwgUGhhc2VyLkVhc2luZy5Cb3VuY2UuT3V0LCB0cnVlLCAzMDAsIC0xLHRydWUpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVhMi5yZXBlYXREZWxheSgxNTAwKTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgfSx0aGlzKTtcbiAgICAgICAgICAgICAgICAgICAgfSwgdGhpcyk7XG5cbiAgICAgICAgICAgICAgICAgICAgLy8gJHEudW5iaW5kKCdlbmRlZCcscWVuZGVkSCk7XG4gICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgICB2YXIgcSA9IG5ldyBIb3dsKHtcbiAgICAgICAgICAgICAgICAgICAgc3JjOiBbJ2Fzc2V0cy9hdWRpby9xJyt3aW5kb3cucXVlc3Rpb25fbm8rJy5tcDMnXVxuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIHEub25jZSgnZW5kJyxxZW5kZWRIKTtcbiAgICAgICAgICAgICAgICBxLnBsYXkoKTtcbiAgICAgICAgICAgICAgICAvLyAkcS5iaW5kKCdlbmRlZCcscWVuZGVkSCk7XG4gICAgICAgICAgICAgICAgLy8gJHFbMF0ucGxheSgpO1xuXG5cbiAgICAgICAgICAgIH1cblxuXG4gICAgICAgIH0sXG4gICAgICAgIHNob3dBbjogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgdmFyIHRoYXQgPSB0aGlzO1xuICAgICAgICAgICAgaWYgKHdpbmRvdy5hc0FycmF5W3dpbmRvdy5xdWVzdGlvbl9ub10gPT0gbnVsbCkge1xuICAgICAgICAgICAgICAgICQoXCIjdmlkZW9fd3JhcHBlclwiKS5jc3MoXCJ0b3BcIiwgMjEwIC8gMTIwNiAqIHdpbmRvdy5pbm5lckhlaWdodCk7XG4gICAgICAgICAgICAgICAgdGhpcy5yZW5kZXJWaWRlb0h0bWwoKTtcblxuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICB2YXIgYTEgPSB0aGlzLmJ2b2ljZV9zcHJpdGUucGxheSgnc3RhcnRwJyk7XG4gICAgICAgICAgICAgICAgYTEub25Db21wbGV0ZS5hZGQoZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLmJ2b2ljZV9zcHJpdGUucGxheSgnbG9vcHAnKTtcbiAgICAgICAgICAgICAgICB9LCB0aGlzKTtcbiAgICAgICAgICAgICAgICB2YXIgcXQxID0gdGhpcy5hZGQuYml0bWFwVGV4dCg0NCwgMTY0LCAnYmFieWZvbnQnLCB3aW5kb3cuYXNBcnJheVt3aW5kb3cucXVlc3Rpb25fbm9dLCAzNik7XG5cbiAgICAgICAgICAgICAgICB0aGlzLm1hc2sxID0gZ2FtZS5hZGQuZ3JhcGhpY3MoMCwgMCk7XG4gICAgICAgICAgICAgICAgdGhpcy5tYXNrMS5iZWdpbkZpbGwoMHhmZmZmZmYpO1xuICAgICAgICAgICAgICAgIHRoaXMubWFzazEuZHJhd1JlY3QoNDQgLSA2MDAsIDE2NCwgNjAwLCA0MCk7XG4gICAgICAgICAgICAgICAgdGhpcy5tYXNrMS5lbmRGaWxsKCk7XG4gICAgICAgICAgICAgICAgcXQxLm1hc2sgPSB0aGlzLm1hc2sxO1xuXG5cbiAgICAgICAgICAgICAgICB2YXIgdGwxID0gdGhpcy5hZGQuaW1hZ2UoNDQsIDE2NCAtIDI4LCAndF9sJyk7XG4gICAgICAgICAgICAgICAgdGwxLmFscGhhID0gMDtcbiAgICAgICAgICAgICAgICB0aGlzLmdhbWUuYWRkLnR3ZWVuKHRsMSkudG8oe1xuICAgICAgICAgICAgICAgICAgICB4OiA2MDAgKyA0NCxcbiAgICAgICAgICAgICAgICAgICAgYWxwaGE6IFsxLCAxLCAxLCAxLCAxLCAxLCAxLCAwXVxuICAgICAgICAgICAgICAgIH0sIDEwMDAsIFBoYXNlci5FYXNpbmcuUXVhcnRpYy5PdXQsIHRydWUsIDIwMCk7XG5cbiAgICAgICAgICAgICAgICBnYW1lLmFkZC50d2Vlbih0aGlzLm1hc2sxKS50byh7eDogNjAwfSwgMTAwMCwgUGhhc2VyLkVhc2luZy5RdWFydGljLk91dCwgdHJ1ZSwgMjAwKTtcbiAgICAgICAgICAgICAgICAvL3BsYXkgYXVkaW9cbiAgICAgICAgICAgICAgICAvL2VuZFxuICAgICAgICAgICAgICAgIHZhciAkcWF1ZGlvID0gJChcIiNxYXVkaW9cIik7XG4gICAgICAgICAgICAgICAgdmFyICRxPSRxYXVkaW8uZmluZCgnLnEnK3dpbmRvdy5xdWVzdGlvbl9ubyk7XG5cbiAgICAgICAgICAgICAgICAvLyB2YXIgcWF1ZGlvID0gdGhpcy5hZGQuYXVkaW8oJ3EnK3dpbmRvdy5xdWVzdGlvbl9ubyk7XG4gICAgICAgICAgICAgICAgLy8gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJxYXVkaW9cIikuYWRkRXZlbnRMaXN0ZW5lcignZW5kZWQnLGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICAvLyAgICAgYWxlcnQoXCJhYWFcIik7XG4gICAgICAgICAgICAgICAgLy8gfSxmYWxzZSk7XG5cbiAgICAgICAgICAgICAgICAvLyBxYXVkaW8ucGxheSgpO1xuICAgICAgICAgICAgICAgIC8vIHFhdWRpby5vblN0b3AuYWRkKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICAvLyBcbiAgICAgICAgICAgICAgICAvLyB9LHRoaXMpO1xuXG4gICAgICAgICAgICAgICAgdGhhdC5sb25ndGltZT1nYW1lLnRpbWUuZXZlbnRzLmFkZCgxNTAwMCwgZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgICAgICBlbmRlZEhhbmRsZXIoKTtcbiAgICAgICAgICAgICAgICB9LHRoaXMpO1xuICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgIHZhciBlbmRlZEhhbmRsZXI9ZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgICAgICB0aGF0LmJ2b2ljZV9zcHJpdGUucGxheSgnZW5kcCcpO1xuICAgICAgICAgICAgICAgICAgICB0aGF0LnJlbmRlclZpZGVvSHRtbCgpO1xuICAgICAgICAgICAgICAgICAgICBpZih0aGF0Lmxvbmd0aW1lIT11bmRlZmluZWQpe1xuICAgICAgICAgICAgICAgICAgICAgICAgZ2FtZS50aW1lLmV2ZW50cy5yZW1vdmUodGhhdC5sb25ndGltZSk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgJHEudW5iaW5kKCdlbmRlZCcsIGVuZGVkSGFuZGxlcik7XG4gICAgICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgJHEuYmluZCgnZW5kZWQnLCBlbmRlZEhhbmRsZXIpO1xuICAgICAgICAgICAgICAgICRxWzBdLnBsYXkoKTtcblxuICAgICAgICAgICAgICAgIC8vbG9uZ3RpbWVcbiAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgfVxuXG4gICAgICAgIH0sXG4gICAgICAgIGJpbmQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHZhciB0aGF0ID0gdGhpcztcbiAgICAgICAgICAgIHZhciBtdmlkZW8gPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcIm12aWRlb1wiKTtcblxuICAgICAgICAgICAgZnVuY3Rpb24gdmlkZW9IYW5kbGVyKCkge1xuICAgICAgICAgICAgICAgIC8vIGNvbnNvbGUubG9nKFwiY2FucGxheXRocm91Z2hcIik7XG4gICAgICAgICAgICAgICAgd2luZG93LmhhdmVsb2FkZWQgPSB0cnVlO1xuICAgICAgICAgICAgICAgIG12aWRlby5yZW1vdmVFdmVudExpc3RlbmVyKFwiY2FucGxheXRocm91Z2hcIiwgdmlkZW9IYW5kbGVyKTtcblxuXG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIG12aWRlby5hZGRFdmVudExpc3RlbmVyKFwiY2FucGxheXRocm91Z2hcIiwgdmlkZW9IYW5kbGVyLCBmYWxzZSk7XG4gICAgICAgICAgICAkKFwiI212aWRlb1wiKVswXS5sb2FkKCk7XG4gICAgICAgIH0sXG4gICAgICAgIHJlbmRlclZpZGVvSHRtbDogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgdmFyIHRoYXQgPSB0aGlzO1xuXG4gICAgICAgICAgICAkKFwiI3ZpZGVvX3dyYXBwZXJcIikuY3NzKHtcImRpc3BsYXlcIjogXCJibG9ja1wiLCBcIndpZHRoXCI6IDAsIFwiaGVpZ2h0XCI6IDB9KTtcblxuICAgICAgICAgICAgVHdlZW5NYXgudG8oJChcIiN2aWRlb193cmFwcGVyXCIpLCAwLjUsIHtcbiAgICAgICAgICAgICAgICB3aWR0aDogXCI3NTBweFwiLCBoZWlnaHQ6IFwiNTQ4cHhcIiwgZWFzZTogUG93ZXIyLmVhc2VJbiwgb25Db21wbGV0ZTogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgICAgICAvLyBjb25zb2xlLmxvZyhcInBsYXlcIik7XG4gICAgICAgICAgICAgICAgICAgICQoXCIjbXZpZGVvXCIpWzBdLnBsYXkoKTtcbiAgICAgICAgICAgICAgICAgICAgZ2FtZS5hZGQudHdlZW4odGhhdC5iYWNrX2J0bi5zY2FsZSkudG8oe3g6IDEsIHk6IDF9LCA4MDAsIFBoYXNlci5FYXNpbmcuQm91bmNlLk91dCwgdHJ1ZSkub25Db21wbGV0ZS5hZGQoZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGVhMiA9IHRoYXQuYWRkLnR3ZWVuKHRoYXQuYmFja19idG4uc2NhbGUpLnRvKHt4OiAxLjUsIHk6IDEuNX0sIDEwMDAsIFBoYXNlci5FYXNpbmcuQm91bmNlLk91dCwgdHJ1ZSwgMzAwLCAtMSx0cnVlKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGVhMi5yZXBlYXREZWxheSgxNTAwKTtcbiAgICAgICAgICAgICAgICAgICAgfSx0aGlzKTtcblxuXG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgfSxcbiAgICAgICAgcmVuZGVyTG9hZEE6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHZhciB0aGF0ID0gdGhpcztcbiAgICAgICAgICAgIHRoaXMubG9hZC5vbkxvYWRDb21wbGV0ZS5hZGRPbmNlKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICB3aW5kb3cuaGF2ZWxvYWRlZCA9IHRydWU7XG5cbiAgICAgICAgICAgIH0sIHRoaXMpO1xuICAgICAgICAgICAgaWYgKHdpbmRvdy5hc0FycmF5W3dpbmRvdy5xdWVzdGlvbl9ub10gIT0gbnVsbCkge1xuICAgICAgICAgICAgICAgIHRoaXMubG9hZC5hdWRpbygncScgKyB3aW5kb3cucXVlc3Rpb25fbm8sICdhc3NldHMvYXVkaW8vcScgKyB3aW5kb3cucXVlc3Rpb25fbm8gKyAnLm1wMycpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKHdpbmRvdy5idkNvbmZpZ0FycmF5W3dpbmRvdy5xdWVzdGlvbl9ub10gIT0gbnVsbCkge1xuICAgICAgICAgICAgICAgIHdpbmRvdy5idkNvbmZpZ0FycmF5W3dpbmRvdy5xdWVzdGlvbl9ub10ucHJlbG9hZCgpO1xuICAgICAgICAgICAgICAgIHRoaXMubG9hZC5pbWFnZSgnYnZmJyArIHdpbmRvdy5xdWVzdGlvbl9ubywgJ2Fzc2V0cy92aWRlby9iJyArIHdpbmRvdy5xdWVzdGlvbl9ubyArICcuanBnJyk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB0aGlzLmxvYWQuYXVkaW8oJ2J2JyArIHdpbmRvdy5xdWVzdGlvbl9ubywgJ2Fzc2V0cy9hdWRpby9idicgKyB3aW5kb3cucXVlc3Rpb25fbm8gKyAnLm1wMycpO1xuXG5cbiAgICAgICAgICAgIHRoaXMubG9hZC5zdGFydCgpO1xuXG4gICAgICAgIH0sXG4gICAgICAgIHJlbmRlckxvYWQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHZhciB0aGF0ID0gdGhpcztcbiAgICAgICAgICAgIGlmICh3aW5kb3cuYXNBcnJheVt3aW5kb3cucXVlc3Rpb25fbm9dICE9IG51bGwpIHtcbiAgICAgICAgICAgICAgICB0aGlzLmxvYWQub25Mb2FkQ29tcGxldGUuYWRkT25jZShmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgICAgICQoXCIjbXZpZGVvXCIpWzBdLnNyYyA9IFwiLi9hc3NldHMvdmlkZW8vYlwiICsgd2luZG93LnF1ZXN0aW9uX25vICsgXCIubXA0XCI7XG4gICAgICAgICAgICAgICAgICAgICQoXCIjbXZpZGVvXCIpWzBdLnBvc3RlciA9IFwiLi9hc3NldHMvdmlkZW8vYlwiICsgd2luZG93LnF1ZXN0aW9uX25vICsgXCIuanBnXCI7XG4gICAgICAgICAgICAgICAgICAgIC8vICQoXCIjbXZpZGVvXCIpWzBdLnBsYXkoKTtcbiAgICAgICAgICAgICAgICAgICAgLy8gJChcIiNtdmlkZW9cIilbMF0ucGF1c2UoKTtcblxuICAgICAgICAgICAgICAgICAgICB0aGlzLmJpbmQoKTtcbiAgICAgICAgICAgICAgICB9LCB0aGlzKTtcblxuICAgICAgICAgICAgICAgIHRoaXMubG9hZC5hdWRpbygncScgKyB3aW5kb3cucXVlc3Rpb25fbm8sICdhc3NldHMvYXVkaW8vcScgKyB3aW5kb3cucXVlc3Rpb25fbm8gKyAnLm1wMycpO1xuICAgICAgICAgICAgICAgIHRoaXMubG9hZC5zdGFydCgpO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAkKFwiI212aWRlb1wiKVswXS5zcmMgPSBcIi4vYXNzZXRzL3ZpZGVvL2JcIiArIHdpbmRvdy5xdWVzdGlvbl9ubyArIFwiLm1wNFwiO1xuICAgICAgICAgICAgICAgICQoXCIjbXZpZGVvXCIpWzBdLnBvc3RlciA9IFwiLi9hc3NldHMvdmlkZW8vYlwiICsgd2luZG93LnF1ZXN0aW9uX25vICsgXCIuanBnXCI7XG4gICAgICAgICAgICAgICAgLy8gJChcIiNtdmlkZW9cIilbMF0ucGxheSgpO1xuICAgICAgICAgICAgICAgIC8vICQoXCIjbXZpZGVvXCIpWzBdLnBhdXNlKCk7XG4gICAgICAgICAgICAgICAgdGhpcy5iaW5kKCk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgfSxcbiAgICAgICAgcmVuZGVyVmlkZW86IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHZhciB2aWRlb19ncm91cCA9IHRoaXMuYWRkLmdyb3VwKCk7XG5cbiAgICAgICAgICAgIHZhciBiZyA9IHZpZGVvX2dyb3VwLmNyZWF0ZSgzNzUsIDYxNSwgJ3ZpZGVvX2JnJyk7XG4gICAgICAgICAgICBiZy5hbmNob3Iuc2V0VG8oMC41KTtcblxuICAgICAgICAgICAgdmFyIGV2aWRlbyA9IHZpZGVvX2dyb3VwLmNyZWF0ZSgzNzUsIDYxNSwgJ2V2aWRlbycpO1xuICAgICAgICAgICAgZXZpZGVvLmFuY2hvci5zZXRUbygwLjUpO1xuICAgICAgICAgICAgdmFyIGMxID0gZ2FtZS5hZGQudHdlZW4odmlkZW9fZ3JvdXApLmZyb20oe2FscGhhOiAwfSwgMTAwMCwgUGhhc2VyLkVhc2luZy5RdWFydGljLk91dCwgdHJ1ZSk7XG4gICAgICAgIH1cbiAgICB9O1xufSgpKTsiLCIvKipcbiAqIENyZWF0ZWQgYnkgc2FuY2hleiBvbiAxNi82LzE2LlxuICovXG4oZnVuY3Rpb24gKCkge1xuICAgICd1c2Ugc3RyaWN0JztcbiAgICB2YXIgTW92aWVDbGlwID0gcmVxdWlyZSgnLi4vZW50aXRpZXMvTW92aWVDbGlwJyk7XG4gICAgdmFyIEZyaWVuZEJ0biA9IHJlcXVpcmUoJy4uL2VudGl0aWVzL0ZyaWVuZEJ0bicpO1xuICAgIHZhciBNdm9pY2UgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHRoaXMuZmJ0bjE9bnVsbDtcbiAgICAgICAgdGhpcy5mYnRuMj1udWxsO1xuICAgICAgICB0aGlzLmZidG4zPW51bGw7XG4gICAgICAgIHRoaXMuZmJ0bjQ9bnVsbDtcbiAgICAgICAgdGhpcy5mYnRuNT1udWxsO1xuICAgICAgICB0aGlzLmZidG42PW51bGw7XG5cbiAgICB9O1xuXG4gICAgbW9kdWxlLmV4cG9ydHMgPSBNdm9pY2U7XG5cbiAgICBNdm9pY2UucHJvdG90eXBlID0ge1xuXG4gICAgICAgIGNyZWF0ZTogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgdmFyIHRoYXQgPSB0aGlzO1xuXG5cblxuICAgICAgICAgICAgdGhpcy5idm9pY2Vfc3ByaXRlID0gdGhpcy5hZGQuc3ByaXRlKDM3NSwgMTIwNiwgJ2J2b2ljZV9zcHJpdGUnKTtcbiAgICAgICAgICAgIHRoaXMuYnZvaWNlX3Nwcml0ZS5hbmNob3Iuc2V0VG8oMC41LCAxKTtcbiAgICAgICAgICAgIHRoaXMuYnZvaWNlX3Nwcml0ZS5hbmltYXRpb25zLmFkZCgnc3RhcnRwJywgWzAsIDEsIDIsIDMsIDQsIDUsIDYsIDddLCAxNSwgZmFsc2UpO1xuICAgICAgICAgICAgdGhpcy5idm9pY2Vfc3ByaXRlLmFuaW1hdGlvbnMuYWRkKCdsb29wcCcsIFs4LCA5LCAxMCwgMTEsIDEyLCAxMywgMTQsIDE1LCAxNiwgMTcsIDE4LCAxOSwgMjAsIDIxLCAyMiwgMjMsIDI0LCAyNSwgMjYsIDI3XSwgMTUsIHRydWUpO1xuICAgICAgICAgICAgdGhpcy5idm9pY2Vfc3ByaXRlLmFuaW1hdGlvbnMuYWRkKCdlbmRwJywgWzcsIDYsIDUsIDQsIDMsIDIsIDEsIDBdLCAxNSwgZmFsc2UpO1xuXG5cbiAgICAgICAgICAgIHRoaXMuYmFja19idG4gPSB0aGlzLmFkZC5zcHJpdGUoMzc1LCAxMTA2LCAnYmFja19idG4nKTtcbiAgICAgICAgICAgIHRoaXMuYmFja19idG4uYW5jaG9yLnNldFRvKDAuNSk7XG4gICAgICAgICAgICB0aGlzLmJhY2tfYnRuLnNjYWxlLnNldFRvKDApO1xuICAgICAgICAgICAgdGhpcy5iYWNrX2J0bi5pbnB1dEVuYWJsZWQgPSB0cnVlO1xuICAgICAgICAgICAgdGhpcy5iYWNrX2J0bi5ldmVudHMub25JbnB1dERvd24uYWRkT25jZShmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5iYWNrX2J0bi5hbHBoYSA9IDAuNjtcbiAgICAgICAgICAgIH0sIHRoaXMpO1xuICAgICAgICAgICAgdGhpcy5iYWNrX2J0bi5ldmVudHMub25JbnB1dFVwLmFkZE9uY2UoZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgIHRoaXMuZ2FtZS5zdGF0ZS5zdGFydCgnR2FtZScpO1xuICAgICAgICAgICAgfSwgdGhpcyk7XG4gICAgICAgICAgICBpZih3aW5kb3cucXVlc3Rpb25fbm89PXVuZGVmaW5lZCl7XG4gICAgICAgICAgICAgICAgd2luZG93LnF1ZXN0aW9uX25vID0gOSA7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZighd2luZG93LmFuZHJvaWR8fHdpbmRvdy5hbmRyb2lkdil7XG4gICAgICAgICAgICAgICAgaWYod2luZG93LnF1ZXN0aW9uX25vIT0xMil7XG4gICAgICAgICAgICAgICAgICAgIHRoYXQucWEgPSBuZXcgSG93bCh7XG4gICAgICAgICAgICAgICAgICAgICAgICBzcmM6IFsnYXNzZXRzL2F1ZGlvL3EnK3dpbmRvdy5xdWVzdGlvbl9ubysnLm1wMyddXG4gICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHRoaXMudDIgPSB0aGlzLmFkZC5iaXRtYXBUZXh0KDczMywgNjMsICdiYWJ5Zm9udCcsICfigJwnICsgd2luZG93LnF1QXJyYXlbd2luZG93LnF1ZXN0aW9uX25vXSArICfigJ0nLCAzNik7XG4gICAgICAgICAgICB0aGlzLnQyLmFuY2hvci5zZXRUbygxLCAwKTtcbiAgICAgICAgICAgIHZhciBjMSA9IGdhbWUuYWRkLnR3ZWVuKHRoaXMudDIpLmZyb20oe1xuICAgICAgICAgICAgICAgIHg6IDc1MCArIDIwMCxcbiAgICAgICAgICAgICAgICBhbHBoYTogMFxuICAgICAgICAgICAgfSwgODAwLCBQaGFzZXIuRWFzaW5nLkJvdW5jZS5PdXQsIHRydWUsIDIwKTtcblxuXG4gICAgICAgICAgICBjMS5vbkNvbXBsZXRlLmFkZChmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5xbG9hZGVyID0gdGhpcy5hZGQuc3ByaXRlKDEyMiwgMTgwLCAncWxvYWRlcicpO1xuICAgICAgICAgICAgICAgIHRoaXMucWxvYWRlci5hbmNob3Iuc2V0VG8oMC41KTtcbiAgICAgICAgICAgICAgICB0aGlzLnFsb2FkZXIuc2NhbGUuc2V0VG8oMC41KTtcblxuICAgICAgICAgICAgICAgIHRoaXMucWxfYWltID0gdGhpcy5xbG9hZGVyLmFuaW1hdGlvbnMuYWRkKCdxbCcsIFswLCAxLCAyLCAzLCA0LCA1LCA2LCA3LCA4LCA5LCAxMCwgMTEsIDAsIDEsIDIsIDMsIDQsIDUsIDYsIDcsIDgsIDksIDEwLCAxMSwgMCwgMSwgMiwgMywgNCwgNSwgNiwgNywgOCwgOSwgMTAsIDExLCAwLCAxLCAyLCAzLCA0LCA1LCA2LCA3LCA4LCA5LCAxMCwgMTFdKTtcbiAgICAgICAgICAgICAgICB0aGlzLnFsX2FpbS5wbGF5KDE3LCB0cnVlKTtcbiAgICAgICAgICAgICAgICB0aGlzLnJlbmRlckxvYWQoKTtcblxuICAgICAgICAgICAgfSwgdGhpcyk7XG5cbiAgICAgICAgICAgIC8vbG9uZ3RpbWVcblxuICAgICAgICB9LFxuICAgICAgICB1cGRhdGU6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIGlmICh3aW5kb3cuaGF2ZWxvYWRlZCkge1xuICAgICAgICAgICAgICAgIHdpbmRvdy5oYXZlbG9hZGVkID0gZmFsc2U7XG5cbiAgICAgICAgICAgICAgICBpZih3aW5kb3cucXVlc3Rpb25fbm8hPTEyKXtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5xbF9haW0uc3RvcCgpO1xuICAgICAgICAgICAgICAgICAgICAvLyB0aGlzLnFsX2FpbS5wbGF5KDE3LCBmYWxzZSk7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMucWxvYWRlci5raWxsKCk7XG4gICAgICAgICAgICAgICAgICAgIGlmKCF3aW5kb3cuYW5kcm9pZHx8d2luZG93LmFuZHJvaWR2KXtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMucmVuZGVyQW5BKCk7XG4gICAgICAgICAgICAgICAgICAgIH1lbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMucmVuZGVyQW4oKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgfWVsc2Uge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLmdhbWUudGltZS5ldmVudHMuYWRkKDEwMDAsIHRoaXMucmVuZGVyMTIsdGhpcyk7XG5cbiAgICAgICAgICAgICAgICB9XG5cblxuICAgICAgICAgICAgfVxuXG4gICAgICAgIH0sXG4gICAgICAgIHJlbmRlcjEyOmZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHZhciB0aGF0PXRoaXM7XG4gICAgICAgICAgICB0aGlzLnFsX2FpbS5zdG9wKCk7XG4gICAgICAgICAgICAvLyB0aGlzLnFsX2FpbS5wbGF5KDE3LCBmYWxzZSk7XG4gICAgICAgICAgICB0aGlzLnFsb2FkZXIua2lsbCgpO1xuICAgICAgICAgICAgdmFyIGZyaWVuZF9iZz10aGlzLmFkZC5pbWFnZSgwLDE2MywnZnJpZW5kX2JnJyk7XG4gICAgICAgICAgICB0aGlzLmZidG4xPW5ldyBGcmllbmRCdG4odGhpcywxMzcsMzc0LDApO1xuICAgICAgICAgICAgZnJpZW5kX2JnLmFkZENoaWxkKHRoaXMuZmJ0bjEpO1xuICAgICAgICAgICAgdGhpcy5mYnRuMj1uZXcgRnJpZW5kQnRuKHRoaXMsMzc1LDM3NCwxKTtcbiAgICAgICAgICAgIGZyaWVuZF9iZy5hZGRDaGlsZCh0aGlzLmZidG4yKTtcbiAgICAgICAgICAgIHRoaXMuZmJ0bjM9bmV3IEZyaWVuZEJ0bih0aGlzLDYxNCwzNzQsMik7XG4gICAgICAgICAgICBmcmllbmRfYmcuYWRkQ2hpbGQodGhpcy5mYnRuMyk7XG4gICAgICAgICAgICB0aGlzLmZidG40PW5ldyBGcmllbmRCdG4odGhpcywxMzcsNjQyLDMpO1xuICAgICAgICAgICAgZnJpZW5kX2JnLmFkZENoaWxkKHRoaXMuZmJ0bjQpO1xuICAgICAgICAgICAgdGhpcy5mYnRuNT1uZXcgRnJpZW5kQnRuKHRoaXMsMzc1LDY0Miw0KTtcbiAgICAgICAgICAgIGZyaWVuZF9iZy5hZGRDaGlsZCh0aGlzLmZidG41KTtcbiAgICAgICAgICAgIHRoaXMuZmJ0bjY9bmV3IEZyaWVuZEJ0bih0aGlzLDYxNCw2NDIsNSk7XG4gICAgICAgICAgICBmcmllbmRfYmcuYWRkQ2hpbGQodGhpcy5mYnRuNik7XG5cbiAgICAgICAgICAgIHZhciBtYXNrMiA9IGdhbWUuYWRkLmdyYXBoaWNzKDAsIDApO1xuICAgICAgICAgICAgbWFzazIuYmVnaW5GaWxsKDB4ZmZmZmZmKTtcbiAgICAgICAgICAgIG1hc2syLmRyYXdSZWN0KDAsIDE2My03OTAsIDc1MCwgNzkwKTtcbiAgICAgICAgICAgIG1hc2syLmVuZEZpbGwoKTtcbiAgICAgICAgICAgIGZyaWVuZF9iZy5tYXNrID0gbWFzazI7XG4gICAgICAgICAgICBnYW1lLmFkZC50d2VlbihtYXNrMikudG8oe3k6NzkwfSwgODAwLCBQaGFzZXIuRWFzaW5nLlF1YXJ0aWMuT3V0LCB0cnVlLCA0MDApO1xuXG4gICAgICAgICAgICBnYW1lLmFkZC50d2VlbiggdGhpcy5mYnRuMS5zY2FsZSkudG8oe3g6MSx5OjF9LCA1MDAsIFBoYXNlci5FYXNpbmcuUXVhcnRpYy5PdXQsIHRydWUsIDgwMCk7XG4gICAgICAgICAgICBnYW1lLmFkZC50d2VlbiggdGhpcy5mYnRuMi5zY2FsZSkudG8oe3g6MSx5OjF9LCA1MDAsIFBoYXNlci5FYXNpbmcuUXVhcnRpYy5PdXQsIHRydWUsIDEwMDApO1xuICAgICAgICAgICAgZ2FtZS5hZGQudHdlZW4oIHRoaXMuZmJ0bjMuc2NhbGUpLnRvKHt4OjEseToxfSwgNTAwLCBQaGFzZXIuRWFzaW5nLlF1YXJ0aWMuT3V0LCB0cnVlLCAxMTAwKTtcbiAgICAgICAgICAgIGdhbWUuYWRkLnR3ZWVuKCB0aGlzLmZidG40LnNjYWxlKS50byh7eDoxLHk6MX0sIDUwMCwgUGhhc2VyLkVhc2luZy5RdWFydGljLk91dCwgdHJ1ZSwgMTIwMCk7XG4gICAgICAgICAgICBnYW1lLmFkZC50d2VlbiggdGhpcy5mYnRuNS5zY2FsZSkudG8oe3g6MSx5OjF9LCA1MDAsIFBoYXNlci5FYXNpbmcuUXVhcnRpYy5PdXQsIHRydWUsIDEzMDApO1xuICAgICAgICAgICAgdmFyIGM9Z2FtZS5hZGQudHdlZW4oIHRoaXMuZmJ0bjYuc2NhbGUpLnRvKHt4OjEseToxfSwgNTAwLCBQaGFzZXIuRWFzaW5nLlF1YXJ0aWMuT3V0LCB0cnVlLCAxNDAwKTtcbiAgICAgICAgICAgIGMub25Db21wbGV0ZS5hZGQoZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgIGdhbWUuYWRkLnR3ZWVuKHRoaXMuYmFja19idG4uc2NhbGUpLnRvKHt4OiAxLCB5OiAxfSwgODAwLCBQaGFzZXIuRWFzaW5nLkJvdW5jZS5PdXQsIHRydWUpLm9uQ29tcGxldGUuYWRkKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICAgICAgdmFyIGVhMiA9IHRoYXQuYWRkLnR3ZWVuKHRoYXQuYmFja19idG4uc2NhbGUpLnRvKHt4OiAxLjUsIHk6IDEuNX0sIDEwMDAsIFBoYXNlci5FYXNpbmcuQm91bmNlLk91dCwgdHJ1ZSwgMzAwLCAtMSx0cnVlKTtcbiAgICAgICAgICAgICAgICAgICAgZWEyLnJlcGVhdERlbGF5KDE1MDApO1xuXG4gICAgICAgICAgICAgICAgfSx0aGlzKTtcbiAgICAgICAgICAgIH0sdGhpcylcblxuICAgICAgICB9LFxuICAgICAgICByZW5kZXJBbkE6ZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgdmFyIHRoYXQ9dGhpcztcbiAgICAgICAgICAgIHRoaXMucXQxID0gdGhpcy5hZGQuYml0bWFwVGV4dCg0NCwgMTY0LCAnYmFieWZvbnQnLCB3aW5kb3cuYXNBcnJheVt3aW5kb3cucXVlc3Rpb25fbm9dLCAzNik7XG5cbiAgICAgICAgICAgIHRoaXMubWFzazEgPSBnYW1lLmFkZC5ncmFwaGljcygwLCAwKTtcbiAgICAgICAgICAgIHRoaXMubWFzazEuYmVnaW5GaWxsKDB4ZmZmZmZmKTtcbiAgICAgICAgICAgIHRoaXMubWFzazEuZHJhd1JlY3QoNDQgLSA1MzgsIDE2NCwgNTM4LCA0MCk7XG4gICAgICAgICAgICB0aGlzLm1hc2sxLmVuZEZpbGwoKTtcbiAgICAgICAgICAgIHRoaXMucXQxLm1hc2sgPSB0aGlzLm1hc2sxO1xuXG4gICAgICAgICAgICB2YXIgdGwxPXRoaXMuYWRkLmltYWdlKDQ0LDE2NC0yOCwndF9sJyk7XG4gICAgICAgICAgICB0bDEuYWxwaGE9MDtcbiAgICAgICAgICAgIHRoaXMuZ2FtZS5hZGQudHdlZW4odGwxKS50byh7eDogNTM4KzQ0LGFscGhhOlsxLDEsMSwxLDEsMSwxLDBdfSwgMTAwMCwgUGhhc2VyLkVhc2luZy5RdWFydGljLk91dCwgdHJ1ZSwgNDAwKTtcblxuXG4gICAgICAgICAgICBnYW1lLmFkZC50d2Vlbih0aGlzLm1hc2sxKS50byh7eDogNTM4fSwgMTAwMCwgUGhhc2VyLkVhc2luZy5RdWFydGljLk91dCwgdHJ1ZSwgNDAwKTtcblxuXG4gICAgICAgICAgICB2YXIgYTEgPSB0aGlzLmJ2b2ljZV9zcHJpdGUucGxheSgnc3RhcnRwJyk7XG4gICAgICAgICAgICBhMS5vbkNvbXBsZXRlLmFkZChmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5idm9pY2Vfc3ByaXRlLnBsYXkoJ2xvb3BwJyk7XG4gICAgICAgICAgICB9LCB0aGlzKTtcblxuICAgICAgICAgICAgZnVuY3Rpb24gZW5kZWRIYW5kbGVyKCkge1xuICAgICAgICAgICAgICAgIHRoYXQuYnZvaWNlX3Nwcml0ZS5wbGF5KCdlbmRwJyk7XG4gICAgICAgICAgICAgICAgaWYgKHdpbmRvdy5xdWVzdGlvbl9ubyAhPSAzKSB7XG4gICAgICAgICAgICAgICAgICAgIGdhbWUuYWRkLnR3ZWVuKHRoYXQuYmFja19idG4uc2NhbGUpLnRvKHt4OiAxLCB5OiAxfSwgODAwLCBQaGFzZXIuRWFzaW5nLkJvdW5jZS5PdXQsIHRydWUsODAwKS5vbkNvbXBsZXRlLmFkZChmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgZWEyID0gdGhhdC5hZGQudHdlZW4odGhhdC5iYWNrX2J0bi5zY2FsZSkudG8oe3g6IDEuNSwgeTogMS41fSwgMTAwMCwgUGhhc2VyLkVhc2luZy5Cb3VuY2UuT3V0LCB0cnVlLCAzMDAsIC0xLHRydWUpO1xuICAgICAgICAgICAgICAgICAgICAgICAgZWEyLnJlcGVhdERlbGF5KDE1MDApO1xuXG4gICAgICAgICAgICAgICAgICAgIH0sdGhpcyk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHN3aXRjaCAod2luZG93LnF1ZXN0aW9uX25vKSB7XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgOTpcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoYXQucmVuZGVyOSgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgMTE6XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGF0LnJlbmRlcjExKCk7XG4gICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgY2FzZSAxNDpcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoYXQucmVuZGVyMTQoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICBjYXNlIDM6XG4gICAgICAgICAgICAgICAgICAgICAgICBpZighd2luZG93LmFuZHJvaWR8fHdpbmRvdy5hbmRyb2lkdil7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhhdC5yZW5kZXIzQSgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfWVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoYXQucmVuZGVyMygpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcblxuICAgICAgICAgICAgICAgICAgICBkZWZhdWx0OlxuICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG5cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9O1xuICAgICAgICAgICAgdGhhdC5xYS5vbmNlKCdlbmQnLGVuZGVkSGFuZGxlcik7XG4gICAgICAgICAgICB0aGF0LnFhLnBsYXkoKTtcblxuXG4gICAgICAgIH0sXG4gICAgICAgIHJlbmRlckFuOiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICB2YXIgdGhhdD10aGlzO1xuICAgICAgICAgICAgdGhpcy5xdDEgPSB0aGlzLmFkZC5iaXRtYXBUZXh0KDQ0LCAxNjQsICdiYWJ5Zm9udCcsIHdpbmRvdy5hc0FycmF5W3dpbmRvdy5xdWVzdGlvbl9ub10sIDM2KTtcblxuICAgICAgICAgICAgdGhpcy5tYXNrMSA9IGdhbWUuYWRkLmdyYXBoaWNzKDAsIDApO1xuICAgICAgICAgICAgdGhpcy5tYXNrMS5iZWdpbkZpbGwoMHhmZmZmZmYpO1xuICAgICAgICAgICAgdGhpcy5tYXNrMS5kcmF3UmVjdCg0NCAtIDUzOCwgMTY0LCA1MzgsIDQwKTtcbiAgICAgICAgICAgIHRoaXMubWFzazEuZW5kRmlsbCgpO1xuICAgICAgICAgICAgdGhpcy5xdDEubWFzayA9IHRoaXMubWFzazE7XG5cbiAgICAgICAgICAgIHZhciB0bDE9dGhpcy5hZGQuaW1hZ2UoNDQsMTY0LTI4LCd0X2wnKTtcbiAgICAgICAgICAgIHRsMS5hbHBoYT0wO1xuICAgICAgICAgICAgdGhpcy5nYW1lLmFkZC50d2Vlbih0bDEpLnRvKHt4OiA1MzgrNDQsYWxwaGE6WzEsMSwxLDEsMSwxLDEsMF19LCAxMDAwLCBQaGFzZXIuRWFzaW5nLlF1YXJ0aWMuT3V0LCB0cnVlLCA0MDApO1xuXG5cbiAgICAgICAgICAgIGdhbWUuYWRkLnR3ZWVuKHRoaXMubWFzazEpLnRvKHt4OiA1Mzh9LCAxMDAwLCBQaGFzZXIuRWFzaW5nLlF1YXJ0aWMuT3V0LCB0cnVlLCA0MDApO1xuXG5cbiAgICAgICAgICAgIHZhciBhMSA9IHRoaXMuYnZvaWNlX3Nwcml0ZS5wbGF5KCdzdGFydHAnKTtcbiAgICAgICAgICAgIGExLm9uQ29tcGxldGUuYWRkKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICB0aGlzLmJ2b2ljZV9zcHJpdGUucGxheSgnbG9vcHAnKTtcbiAgICAgICAgICAgIH0sIHRoaXMpO1xuXG4gICAgICAgICAgICB2YXIgJHFhdWRpbz0kKFwiI3FhdWRpb1wiKTtcbiAgICAgICAgICAgIHZhciAkcT0kcWF1ZGlvLmZpbmQoJy5xJyt3aW5kb3cucXVlc3Rpb25fbm8pO1xuXG4gICAgICAgICAgICBmdW5jdGlvbiBlbmRlZEhhbmRsZXIoKSB7XG4gICAgICAgICAgICAgICAgdGhhdC5idm9pY2Vfc3ByaXRlLnBsYXkoJ2VuZHAnKTtcbiAgICAgICAgICAgICAgICBpZiAod2luZG93LnF1ZXN0aW9uX25vICE9IDMpIHtcbiAgICAgICAgICAgICAgICAgICAgZ2FtZS5hZGQudHdlZW4odGhhdC5iYWNrX2J0bi5zY2FsZSkudG8oe3g6IDEsIHk6IDF9LCA4MDAsIFBoYXNlci5FYXNpbmcuQm91bmNlLk91dCwgdHJ1ZSw4MDApLm9uQ29tcGxldGUuYWRkKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBlYTIgPSB0aGF0LmFkZC50d2Vlbih0aGF0LmJhY2tfYnRuLnNjYWxlKS50byh7eDogMS41LCB5OiAxLjV9LCAxMDAwLCBQaGFzZXIuRWFzaW5nLkJvdW5jZS5PdXQsIHRydWUsIDMwMCwgLTEsdHJ1ZSk7XG4gICAgICAgICAgICAgICAgICAgICAgICBlYTIucmVwZWF0RGVsYXkoMTUwMCk7XG5cbiAgICAgICAgICAgICAgICAgICAgfSx0aGlzKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgc3dpdGNoICh3aW5kb3cucXVlc3Rpb25fbm8pIHtcbiAgICAgICAgICAgICAgICAgICAgY2FzZSA5OlxuICAgICAgICAgICAgICAgICAgICAgICAgdGhhdC5yZW5kZXI5KCk7XG4gICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgY2FzZSAxMTpcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoYXQucmVuZGVyMTEoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICBjYXNlIDM6XG4gICAgICAgICAgICAgICAgICAgICAgICBpZighd2luZG93LmFuZHJvaWR8fHdpbmRvdy5hbmRyb2lkdil7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhhdC5yZW5kZXIzQSgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfWVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoYXQucmVuZGVyMygpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcblxuICAgICAgICAgICAgICAgICAgICBkZWZhdWx0OlxuICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG5cbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICBpZih0aGF0Lmxvbmd0aW1lIT11bmRlZmluZWQpe1xuICAgICAgICAgICAgICAgICAgICBnYW1lLnRpbWUuZXZlbnRzLnJlbW92ZSh0aGF0Lmxvbmd0aW1lKTtcbiAgICAgICAgICAgICAgICB9XG5cblxuICAgICAgICAgICAgICAgICRxLnVuYmluZCgnZW5kZWQnLGVuZGVkSGFuZGxlcik7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICRxLmJpbmQoJ2VuZGVkJyxlbmRlZEhhbmRsZXIpO1xuICAgICAgICAgICAgJHFbMF0ucGxheSgpO1xuXG4gICAgICAgICAgICB0aGF0Lmxvbmd0aW1lPXRoaXMuZ2FtZS50aW1lLmV2ZW50cy5hZGQoMTUwMDAsIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICB0aGF0LmVuZGVkSGFuZGxlcigpO1xuICAgICAgICAgICAgfSx0aGlzKTtcbiAgICAgICAgICAgXG4gICAgICAgICAgICAvLyBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcInFhdWRpb1wiKS5hZGRFdmVudExpc3RlbmVyKCdlbmRlZCcsZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgLy8gICAgIGFsZXJ0KFwiYWFhXCIpO1xuICAgICAgICAgICAgLy8gfSxmYWxzZSk7XG5cblxuICAgICAgICAgICAgLy9wbGF5IGF1ZGlvXG4gICAgICAgICAgICAvL2VuZFxuXG4gICAgICAgICAgIFxuICAgICAgICAgICBcbiAgICAgICAgIFxuXG4gICAgICAgICBcbiAgICAgICAgICAgIFxuICAgICAgICB9LFxuICAgICAgICBiaW5kOiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICB2YXIgdGhhdCA9IHRoaXM7XG4gICAgICAgICAgICB2YXIgbXZpZGVvID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJtcGhvbmVcIik7XG4gICAgICAgICAgICAvLyAkKFwiI21waG9uZVwiKVswXS5wbGF5KCk7XG4gICAgICAgICAgICAvLyAkKFwiI21waG9uZVwiKVswXS5wYXVzZSgpO1xuICAgICAgICAgICAgZnVuY3Rpb24gdmlkZW9IYW5kbGVyKCkge1xuICAgICAgICAgICAgICAgIC8vIGNvbnNvbGUubG9nKFwiY2FucGxheXRocm91Z2hcIik7XG4gICAgICAgICAgICAgICAgd2luZG93LmhhdmVsb2FkZWQgPSB0cnVlO1xuICAgICAgICAgICAgICAgIC8vIG12aWRlby5yZW1vdmVFdmVudExpc3RlbmVyKFwiY2FucGxheXRocm91Z2hcIiwgdmlkZW9IYW5kbGVyKTtcblxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgd2luZG93LmhhdmVsb2FkZWQgPSB0cnVlO1xuXG4gICAgICAgICAgICAvLyBtdmlkZW8uYWRkRXZlbnRMaXN0ZW5lcihcImNhbnBsYXl0aHJvdWdoXCIsIHZpZGVvSGFuZGxlciwgZmFsc2UpO1xuXG4gICAgICAgICAgICAvLyBmdW5jdGlvbiB2ZW5kSGFuZGxlcigpIHtcbiAgICAgICAgICAgIC8vICAgICBpZiggIXdpbmRvdy5waG9uZV9jbGlja2VkKXtcbiAgICAgICAgICAgIC8vICAgICAgICAgY29uc29sZS5sb2coXCJlbmRlZFwiKTtcbiAgICAgICAgICAgIC8vICAgICAgICAgd2luZG93LnZpZGVvZW5kPXRydWU7XG4gICAgICAgICAgICAvLyAgICAgICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwicGhvbmVfd3JhcHBlclwiKS5zdHlsZS5kaXNwbGF5PVwibm9uZVwiO1xuICAgICAgICAgICAgLy8gICAgICAgICBtdmlkZW8ucGF1c2UoKTtcbiAgICAgICAgICAgIC8vICAgICAgICAgdGhhdC5nYW1lLnN0YXRlLnN0YXJ0KCdHYW1lJyk7XG4gICAgICAgICAgICAvLyAgICAgICAgIG12aWRlby5yZW1vdmVFdmVudExpc3RlbmVyKFwiZW5kZWRcIiwgdmlkZW9IYW5kbGVyKTtcbiAgICAgICAgICAgIC8vICAgICB9XG4gICAgICAgICAgICAvLyB9XG4gICAgICAgICAgICAvLyBtdmlkZW8uYWRkRXZlbnRMaXN0ZW5lcihcImVuZGVkXCIsIHZlbmRIYW5kbGVyLCBmYWxzZSk7XG5cblxuICAgICAgICB9LFxuICAgICAgICByZW5kZXIzQTpmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICB2YXIgdGhhdD10aGlzO1xuICAgICAgICAgICAgZ2FtZS5hZGQudHdlZW4odGhpcy5xdDEpLnRvKHthbHBoYTogMH0sIDEwLCBudWxsLCB0cnVlLCA0MDApO1xuICAgICAgICAgICAgZ2FtZS5hZGQudHdlZW4odGhpcy50MikudG8oe2FscGhhOiAwfSwgMTAsIG51bGwsIHRydWUsIDQwMCkub25Db21wbGV0ZS5hZGQoZnVuY3Rpb24gKCkge1xuXG4gICAgICAgICAgICAgICAgdmFyIHBob25lX3QgPSB0aGlzLmFkZC5pbWFnZSgzNzUsIDE2NCwgJ3Bob25lX3QnKTtcbiAgICAgICAgICAgICAgICBwaG9uZV90LmFuY2hvci5zZXRUbygwLjUpO1xuICAgICAgICAgICAgICAgIC8vIHZhciBjYWxsPSQoXCIjcGNhbGxcIilbMF07XG4gICAgICAgICAgICAgICAgLy8gY2FsbC5wbGF5KCk7XG4gICAgICAgICAgICAgICAgdmFyIHBjYWxsID0gbmV3IEhvd2woe1xuICAgICAgICAgICAgICAgICAgICBzcmM6IFsnYXNzZXRzL2F1ZGlvL2NhbGwubXAzJ10sXG4gICAgICAgICAgICAgICAgICAgIGxvb3A6dHJ1ZVxuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIHZhciBwaG9uZSA9IG5ldyBIb3dsKHtcbiAgICAgICAgICAgICAgICAgICAgc3JjOiBbJ2Fzc2V0cy9hdWRpby9waG9uZS5tcDMnXVxuICAgICAgICAgICAgICAgIH0pO1xuXG5cbiAgICAgICAgICAgICAgICBwY2FsbC5wbGF5KCk7XG4gICAgICAgICAgICAgICAgdmFyIHBob25lX2kxID0gdGhpcy5hZGQuaW1hZ2UoMzc1LCAxMDQwLCAncGhvbmVfaTEnKTtcbiAgICAgICAgICAgICAgICBwaG9uZV9pMS5hbmNob3Iuc2V0VG8oMC41KTtcbiAgICAgICAgICAgICAgICBwaG9uZV9pMS5pbnB1dEVuYWJsZWQ9dHJ1ZTtcbiAgICAgICAgICAgICAgICBwaG9uZV9pMS5ldmVudHMub25JbnB1dERvd24uYWRkT25jZShmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgICAgIHBob25lX2kxLmFscGhhID0gMC42O1xuICAgICAgICAgICAgICAgIH0sIHRoaXMpO1xuICAgICAgICAgICAgICAgIHBob25lX2kxLmV2ZW50cy5vbklucHV0VXAuYWRkT25jZShmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwiYmcyXCIpLnN0eWxlLmRpc3BsYXk9XCJub25lXCI7XG4gICAgICAgICAgICAgICAgICAgIHBjYWxsLnBhdXNlKCk7XG4gICAgICAgICAgICAgICAgICAgIC8vIHZhciBwYXVkaW89ICQoXCIjcGF1ZGlvXCIpWzBdO1xuICAgICAgICAgICAgICAgICAgICB2YXIgdmdyb3VwID0gdGhpcy5hZGQuZ3JvdXAoKTtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5idjM9bmV3IE1vdmllQ2xpcCh0aGlzLDAsMCw3NTAsMTIwNix3aW5kb3cucGhvbmUsZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgICAgICAgICAvLyBjb25zb2xlLmxvZygnZW5kJyk7XG4gICAgICAgICAgICAgICAgICAgICAgICBwaG9uZS5wYXVzZSgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgcGhvbmUuc2VlaygwKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIHBhdWRpby5jdXJyZW50VGltZT0wO1xuICAgICAgICAgICAgICAgICAgICAgICAgcGhvbmUucGxheSgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhhdC5idjMucGxheVZpZGVvKCk7XG4gICAgICAgICAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICAgICAgICAgIHZncm91cC5hZGRDaGlsZCggdGhpcy5idjMpO1xuICAgICAgICAgICAgICAgICAgICB2YXIgY2FudmFzPSAkKFwiI2JhYnlzaXJpLWdhbWVcIikuZmluZChcImNhbnZhc1wiKTtcblxuICAgICAgICAgICAgICAgICAgICBjYW52YXMuYWRkQ2xhc3MoJ21pZCcpO1xuICAgICAgICAgICAgICAgICAgICBwaG9uZS5zZWVrKDApO1xuICAgICAgICAgICAgICAgICAgICBwaG9uZS5wbGF5KCk7XG5cbiAgICAgICAgICAgICAgICAgICAgLy8gcGhvbmUuY3VycmVudFRpbWU9MDtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5idjMucGxheVZpZGVvKCk7XG5cbiAgICAgICAgICAgICAgICAgICAgcGhvbmVfdC5raWxsKCk7XG4gICAgICAgICAgICAgICAgICAgIHBob25lX2kxLmtpbGwoKTtcbiAgICAgICAgICAgICAgICAgICAgdmFyIHBob25lX2kyID0gdGhpcy5hZGQuaW1hZ2UoMzc1LCAxMDQwLCAncGhvbmVfaTInKTtcbiAgICAgICAgICAgICAgICAgICAgcGhvbmVfaTIuYW5jaG9yLnNldFRvKDAuNSk7XG4gICAgICAgICAgICAgICAgICAgIHBob25lX2kyLmlucHV0RW5hYmxlZD10cnVlO1xuICAgICAgICAgICAgICAgICAgICBwaG9uZV9pMi5ldmVudHMub25JbnB1dERvd24uYWRkT25jZShmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBwaG9uZV9pMi5hbHBoYSA9IDAuNjtcbiAgICAgICAgICAgICAgICAgICAgfSwgdGhpcyk7XG4gICAgICAgICAgICAgICAgICAgIHBob25lX2kyLmV2ZW50cy5vbklucHV0VXAuYWRkT25jZShmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBwaG9uZS5wYXVzZSgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJiZzJcIikuc3R5bGUuZGlzcGxheT1cImJsb2NrXCI7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGF0LmdhbWUuc3RhdGUuc3RhcnQoJ0dhbWUnKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vICQoJyNtcGhvbmUnKVswXS5jdXJyZW50VGltZT0wO1xuXG4gICAgICAgICAgICAgICAgICAgIH0sIHRoaXMpO1xuXG5cbiAgICAgICAgICAgICAgICB9LCB0aGlzKTtcblxuICAgICAgICAgICAgfSwgdGhpcyk7XG4gICAgICAgICAgICBcbiAgICAgICAgfSxcbiAgICAgICAgcmVuZGVyMzogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgdmFyIHRoYXQ9dGhpcztcbiAgICAgICAgICAgIGdhbWUuYWRkLnR3ZWVuKHRoaXMucXQxKS50byh7YWxwaGE6IDB9LCAxMCwgbnVsbCwgdHJ1ZSwgNDAwKTtcbiAgICAgICAgICAgIGdhbWUuYWRkLnR3ZWVuKHRoaXMudDIpLnRvKHthbHBoYTogMH0sIDEwLCBudWxsLCB0cnVlLCA0MDApLm9uQ29tcGxldGUuYWRkKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICAvLyB2YXIgY2FsbD10aGlzLmFkZC5hdWRpbygnY2FsbCcsMSx0cnVlKTtcbiAgICAgICAgICAgICAgICB2YXIgY2FsbD0kKFwiI3BjYWxsXCIpWzBdO1xuICAgICAgICAgICAgICAgIGNhbGwuY3VycmVudFRpbWU9MDtcbiAgICAgICAgICAgICAgICBjYWxsLnBsYXkoKTtcbiAgICAgICAgICAgICAgICB2YXIgcGhvbmVfdCA9IHRoaXMuYWRkLmltYWdlKDM3NSwgMTY0LCAncGhvbmVfdCcpO1xuICAgICAgICAgICAgICAgIHBob25lX3QuYW5jaG9yLnNldFRvKDAuNSk7XG5cbiAgICAgICAgICAgICAgICB2YXIgcGhvbmVfaTEgPSB0aGlzLmFkZC5pbWFnZSgzNzUsIDEwNDAsICdwaG9uZV9pMScpO1xuICAgICAgICAgICAgICAgIHBob25lX2kxLmFuY2hvci5zZXRUbygwLjUpO1xuICAgICAgICAgICAgICAgIHBob25lX2kxLmlucHV0RW5hYmxlZD10cnVlO1xuICAgICAgICAgICAgICAgIHBob25lX2kxLmV2ZW50cy5vbklucHV0RG93bi5hZGRPbmNlKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICAgICAgcGhvbmVfaTEuYWxwaGEgPSAwLjY7XG4gICAgICAgICAgICAgICAgfSwgdGhpcyk7XG4gICAgICAgICAgICAgICAgcGhvbmVfaTEuZXZlbnRzLm9uSW5wdXRVcC5hZGRPbmNlKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICAgICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJwaG9uZV93cmFwcGVyXCIpLnN0eWxlLmRpc3BsYXk9XCJibG9ja1wiO1xuICAgICAgICAgICAgICAgICAgICBjYWxsLnBhdXNlKCk7XG4gICAgICAgICAgICAgICAgICAgICQoJyNtcGhvbmUnKVswXS5jdXJyZW50VGltZT0wO1xuICAgICAgICAgICAgICAgICAgICAkKCcjbXBob25lJylbMF0ucGxheSgpO1xuICAgICAgICAgICAgICAgICAgICAvLyBjYWxsLmRlc3Ryb3koKTtcbiAgICAgICAgICAgICAgICAgICAgcGhvbmVfdC5raWxsKCk7XG4gICAgICAgICAgICAgICAgICAgIHBob25lX2kxLmtpbGwoKTtcbiAgICAgICAgICAgICAgICAgICAgdmFyIHBob25lX2kyID0gdGhpcy5hZGQuaW1hZ2UoMzc1LCAxMDQwLCAncGhvbmVfaTInKTtcbiAgICAgICAgICAgICAgICAgICAgcGhvbmVfaTIuYW5jaG9yLnNldFRvKDAuNSk7XG4gICAgICAgICAgICAgICAgICAgIHBob25lX2kyLmlucHV0RW5hYmxlZD10cnVlO1xuICAgICAgICAgICAgICAgICAgICBwaG9uZV9pMi5ldmVudHMub25JbnB1dERvd24uYWRkT25jZShmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBwaG9uZV9pMi5hbHBoYSA9IDAuNjtcbiAgICAgICAgICAgICAgICAgICAgfSwgdGhpcyk7XG4gICAgICAgICAgICAgICAgICAgIHBob25lX2kyLmV2ZW50cy5vbklucHV0VXAuYWRkT25jZShmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB3aW5kb3cucGhvbmVfY2xpY2tlZD10cnVlO1xuICAgICAgICAgICAgICAgICAgICAgICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJwaG9uZV93cmFwcGVyXCIpLnN0eWxlLmRpc3BsYXk9XCJub25lXCI7XG4gICAgICAgICAgICAgICAgICAgICAgICAkKCcjbXBob25lJylbMF0ucGF1c2UoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vICQoJyNtcGhvbmUnKVswXS5jdXJyZW50VGltZT0wO1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhhdC5nYW1lLnN0YXRlLnN0YXJ0KCdHYW1lJyk7XG5cbiAgICAgICAgICAgICAgICAgICAgfSwgdGhpcyk7XG5cblxuICAgICAgICAgICAgICAgIH0sIHRoaXMpO1xuXG4gICAgICAgICAgICB9LCB0aGlzKTtcblxuXG4gICAgICAgIH0sXG4gICAgICAgIHJlbmRlcjk6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHZhciBkZWxheSA9IDA7XG4gICAgICAgICAgICB2YXIgcmFuZGY9TWF0aC5mbG9vcihNYXRoLnJhbmRvbSgpKjUpO1xuICAgICAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCAxNTsgaSsrKSB7XG4gICAgICAgICAgICAgICAgdmFyIHFpID0gdGhpcy5hZGQuc3ByaXRlKDUwICsgTWF0aC5yYW5kb20oKSAqIDY1MCwgLTE1MCwgJ3E5X2knLHJhbmRmKTtcbiAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgIHFpLmFuZ2xlID0gTWF0aC5yYW5kb20oKSAqIDM2MDtcbiAgICAgICAgICAgICAgICBxaS5zY2FsZS5zZXQoZ2FtZS5ybmQucmVhbEluUmFuZ2UoMC40LCAxLjIpKTtcbiAgICAgICAgICAgICAgICB2YXIgc3BlZWQgPSBnYW1lLnJuZC5iZXR3ZWVuKDQwMDAsIDYwMDApO1xuXG4gICAgICAgICAgICAgICAgZ2FtZS5hZGQudHdlZW4ocWkpLnRvKHtcbiAgICAgICAgICAgICAgICAgICAgeDogNTAgKyBNYXRoLnJhbmRvbSgpICogNjUwLFxuICAgICAgICAgICAgICAgICAgICB5OiAxNTAwLFxuICAgICAgICAgICAgICAgICAgICBhbmdsZTotMTBcbiAgICAgICAgICAgICAgICB9LCBzcGVlZCwgUGhhc2VyLkVhc2luZy5TaW51c29pZGFsLkluT3V0LCB0cnVlLCBkZWxheSwgODAwLCBmYWxzZSk7XG5cbiAgICAgICAgICAgICAgICBkZWxheSArPSAyMDA7XG5cbiAgICAgICAgICAgIH1cblxuXG4gICAgICAgIH0sXG5cbiAgICAgICAgcmVuZGVyMTE6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHZhciBxMSA9IHRoaXMuYWRkLmltYWdlKDAsIDI3OCwgJ3ExMV9pMScpO1xuXG5cbiAgICAgICAgICAgIHZhciBtYXNrMiA9IGdhbWUuYWRkLmdyYXBoaWNzKDAsIDApO1xuICAgICAgICAgICAgbWFzazIuYmVnaW5GaWxsKDB4ZmZmZmZmKTtcbiAgICAgICAgICAgIG1hc2syLmRyYXdSZWN0KDAsIDI2OC02NTAsIDc1MCwgNjUwKTtcbiAgICAgICAgICAgIG1hc2syLmVuZEZpbGwoKTtcbiAgICAgICAgICAgIHExLm1hc2sgPSBtYXNrMjtcbiAgICAgICAgICAgIGdhbWUuYWRkLnR3ZWVuKG1hc2syKS50byh7eTo2NTB9LCA4MDAsIFBoYXNlci5FYXNpbmcuUXVhcnRpYy5PdXQsIHRydWUsIDQwMCk7XG5cbiAgICAgICAgICAgIHZhciBxMiA9IHRoaXMuYWRkLmltYWdlKDQxNSwgMTg4LCAncTExX2kyJyk7XG4gICAgICAgICAgICB2YXIgX21hcD10aGlzLmFkZC5pbWFnZSgwLDE0OSwnbWFwJyk7XG4gICAgICAgICAgICBfbWFwLmFkZENoaWxkKHEyKTtcbiAgICAgICAgICAgIC8vIF9tYXAuc2NhbGUuc2V0VG8oMS4xMzMpO1xuXG4gICAgICAgICAgICB2YXIgbW0gPSBnYW1lLmFkZC5ncmFwaGljcygwLCAwKTtcbiAgICAgICAgICAgIG1tLmJlZ2luRmlsbCgweGZmZmZmZik7XG4gICAgICAgICAgICBtbS5kcmF3UmVjdCgwLCA0MjcsIDc1MCwgNTAwKTtcbiAgICAgICAgICAgIG1tLmVuZEZpbGwoKTtcbiAgICAgICAgICAgIF9tYXAubWFzayA9IG1tO1xuXG4gICAgICAgICAgICB2YXIgYm91bmRzID0gbmV3IFBoYXNlci5SZWN0YW5nbGUoMCwgMTQ5LTM0NCwgNzUwLCAxMTg4KTtcblxuICAgICAgICAgICAgX21hcC5pbnB1dEVuYWJsZWQgPSB0cnVlO1xuICAgICAgICAgICAgX21hcC5pbnB1dC5lbmFibGVEcmFnKCk7XG4gICAgICAgICAgICBfbWFwLmlucHV0LmJvdW5kc1JlY3QgPSBib3VuZHM7XG5cbiAgICAgICAgICAgIHExLmFkZENoaWxkKF9tYXApO1xuXG4gICAgICAgICAgICAvLyBxMS5hZGRDaGlsZCgpXG5cbiAgICAgICAgICAgIHZhciBhbmltID0gZ2FtZS5hZGQudHdlZW4ocTIpLmZyb20oe3g6IDQxNSwgeTogMCwgYWxwaGE6IDB9LCA4MDAsIFBoYXNlci5FYXNpbmcuQm91bmNlLk91dCwgdHJ1ZSwgMTAwMCk7XG4gICAgICAgICAgICB0aGlzLmJhY2tfYnRuLmJyaW5nVG9Ub3AoKTtcblxuXG4gICAgICAgIH0sXG4gICAgICAgIHJlbmRlckxvYWQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHZhciB0aGF0ID0gdGhpcztcbiAgICAgICAgICAgIHRoaXMubG9hZC5vbkxvYWRDb21wbGV0ZS5hZGRPbmNlKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICBpZiAod2luZG93LnF1ZXN0aW9uX25vICE9IDMpIHtcbiAgICAgICAgICAgICAgICAgICAgd2luZG93LmhhdmVsb2FkZWQgPSB0cnVlO1xuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIC8vICQoXCIjbXBob25lXCIpWzBdLnBsYXkoKTtcbiAgICAgICAgICAgICAgICAgICAgLy8gJChcIiNtcGhvbmVcIilbMF0ucGF1c2UoKTtcbiAgICAgICAgICAgICAgICAgICAgdGhhdC5iaW5kKCk7XG4gICAgICAgICAgICAgICAgICAgIC8vIHdpbmRvdy5oYXZlbG9hZGVkID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIH0sIHRoaXMpO1xuICAgICAgICAgICAgaWYod2luZG93LnF1ZXN0aW9uX25vIT0xMil7XG4gICAgICAgICAgICAgICAgdGhpcy5sb2FkLmF1ZGlvKCdxJyt3aW5kb3cucXVlc3Rpb25fbm8sICdhc3NldHMvYXVkaW8vcScgKyB3aW5kb3cucXVlc3Rpb25fbm8gKyAnLm1wMycpO1xuICAgICAgICAgICAgICAgIHN3aXRjaCAod2luZG93LnF1ZXN0aW9uX25vKSB7XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgOTpcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIHRoaXMubG9hZC5pbWFnZSgncTlfaScsICdhc3NldHMvaW1nL3E5X2kucG5nJyw3NCw3Mik7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmxvYWQuc3ByaXRlc2hlZXQoJ3E5X2knLCAnYXNzZXRzL2ltZy9xOV9pMS5wbmcnLDc0LDcyLDUpO1xuICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgMTE6XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmxvYWQuaW1hZ2UoJ3ExMV9pMScsICdhc3NldHMvaW1nL3ExMV9pMS5wbmcnKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMubG9hZC5pbWFnZSgncTExX2kyJywgJ2Fzc2V0cy9pbWcvcTExX2kyLnBuZycpO1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5sb2FkLmltYWdlKCdtYXAnLCAnYXNzZXRzL2ltZy9tYXAuanBnJyk7XG4gICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgY2FzZSAzOlxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5sb2FkLmltYWdlKCdwaG9uZV90JywgJ2Fzc2V0cy9pbWcvcGhvbmVfdC5wbmcnKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMubG9hZC5pbWFnZSgncGhvbmVfaTEnLCAnYXNzZXRzL2ltZy9waG9uZV9pMS5wbmcnKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMubG9hZC5pbWFnZSgncGhvbmVfaTInLCAnYXNzZXRzL2ltZy9waG9uZV9pMi5wbmcnKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMubG9hZC5hdWRpbygnY2FsbCcsICdhc3NldHMvYXVkaW8vY2FsbC5tcDMnKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmKCF3aW5kb3cuYW5kcm9pZHx8d2luZG93LmFuZHJvaWR2KXtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB3aW5kb3cucGhvbmUucHJlbG9hZCgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMubG9hZC5hdWRpbygncGhvbmUnLCAnYXNzZXRzL2F1ZGlvL3Bob25lLm1wMycpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfWVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMubG9hZC52aWRlbygnYjMnLCAnYXNzZXRzL3ZpZGVvL2IzLm1wNCcpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKCdlcnJvcicpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1lbHNlIHtcbiAgICAgICAgICAgICAgICB0aGlzLmxvYWQuaW1hZ2UoJ2ZyaWVuZF9iZycsJ2Fzc2V0cy9pbWcvZnJpZW5kX2JnLnBuZycpO1xuICAgICAgICAgICAgICAgIHRoaXMubG9hZC5hdWRpbygnZjAnLCAnYXNzZXRzL2F1ZGlvL2YwLm1wMycpO1xuICAgICAgICAgICAgICAgIHRoaXMubG9hZC5hdWRpbygnZjEnLCAnYXNzZXRzL2F1ZGlvL2YxLm1wMycpO1xuICAgICAgICAgICAgICAgIHRoaXMubG9hZC5hdWRpbygnZjInLCAnYXNzZXRzL2F1ZGlvL2YyLm1wMycpO1xuICAgICAgICAgICAgICAgIHRoaXMubG9hZC5hdWRpbygnZjMnLCAnYXNzZXRzL2F1ZGlvL2YzLm1wMycpO1xuICAgICAgICAgICAgICAgIHRoaXMubG9hZC5hdWRpbygnZjQnLCAnYXNzZXRzL2F1ZGlvL2Y0Lm1wMycpO1xuICAgICAgICAgICAgICAgIHRoaXMubG9hZC5hdWRpbygnZjUnLCAnYXNzZXRzL2F1ZGlvL2Y1Lm1wMycpO1xuICAgICAgICAgICAgICAgIHRoaXMubG9hZC5zcHJpdGVzaGVldCgnZnJpZW5kX3Nwcml0ZScsICdhc3NldHMvaW1nL2ZyaWVuZF9zcHJpdGUucG5nJywgMTgyLCAyMjEsIDYsMCwyKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIFxuICAgICAgICAgICBcblxuICAgICAgICAgICAgdGhpcy5sb2FkLnN0YXJ0KCk7XG4gICAgICAgIH1cblxuXG4gICAgfTtcblxufSgpKTtcblxuIiwiKGZ1bmN0aW9uICgpIHtcbiAgICAndXNlIHN0cmljdCc7XG4gICAgdmFyIFBpZVByb2dyZXNzID0gcmVxdWlyZSgnLi4vZW50aXRpZXMvUGllUHJvZ3Jlc3MnKTtcbiAgICB2YXIgUHJlbG9hZGVyID0gZnVuY3Rpb24gKCkge1xuICAgICAgICB0aGlzLmFzc2V0ID0gbnVsbDtcbiAgICAgICAgdGhpcy5yZWFkeSA9IGZhbHNlO1xuICAgICAgICB0aGlzLm1waWVwcm9ncmVzcyA9IG51bGw7XG4gICAgfTtcblxuICAgIG1vZHVsZS5leHBvcnRzID0gUHJlbG9hZGVyO1xuXG4gICAgUHJlbG9hZGVyLnByb3RvdHlwZSA9IHtcbiAgICAgICAgbG9hZFJlc291cmNlczogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgLy8gbG9hZCB5b3VyIGFzc2V0cyBoZXJlXG4gICAgICAgICAgICB0aGlzLmxvYWQuYml0bWFwRm9udCgnYmFieWZvbnQnLCAnYXNzZXRzL2ZvbnRzL2JhYnlmb250LnBuZycsICdhc3NldHMvZm9udHMvYmFieWZvbnQuZm50Jyk7XG5cblxuICAgICAgICAgICAgdGhpcy5sb2FkLmltYWdlKCdiZycsICdhc3NldHMvaW1nL2JnMi5qcGcnKTtcbiAgICAgICAgICAgIHRoaXMubG9hZC5zcHJpdGVzaGVldCgnbHQnLCAnYXNzZXRzL2ltZy9sdC5wbmcnLCAyMTgsIDMyLCA0KTtcblxuXG4gICAgICAgICAgICBpZighd2luZG93LmFuZHJvaWQpe1xuICAgICAgICAgICAgICAgIHRoaXMubG9hZC5pbWFnZSgnYWN0c2lyaScsICdhc3NldHMvaW1nL2FjdHNpcmlfYS5wbmcnKTtcbiAgICAgICAgICAgICAgICB0aGlzLmxvYWQuc3ByaXRlc2hlZXQoJ3ZvaWNlX3Nwcml0ZScsICdhc3NldHMvaW1nL2F2b2ljZV9zcHJpdGUucG5nJywgNzUwLCAxOTAsIDI3KTtcbiAgICAgICAgICAgICAgICB0aGlzLmxvYWQuaW1hZ2UoJ2VudGVyX2J0bicsICdhc3NldHMvaW1nL2VudGVyX2J0bi5wbmcnKTtcbiAgICAgICAgICAgIH1lbHNlIHtcbiAgICAgICAgICAgICAgICB0aGlzLmxvYWQuaW1hZ2UoJ2FjdHNpcmknLCAnYXNzZXRzL2ltZy9hY3RzaXJpLnBuZycpO1xuICAgICAgICAgICAgICAgIHRoaXMubG9hZC5zcHJpdGVzaGVldCgndm9pY2Vfc3ByaXRlJywgJ2Fzc2V0cy9pbWcvdm9pY2Vfc3ByaXRlLmpwZycsIDc1MCwgMTkwLCAyNyk7XG4gICAgICAgICAgICAgICAgdGhpcy5sb2FkLmltYWdlKCdmbG9hZF9pb3MnLCAnYXNzZXRzL2ltZy9mbG9hZF9pb3MucG5nJyk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIHRoaXMubG9hZC5pbWFnZSgndF9sJywgJ2Fzc2V0cy9pbWcvdF9sLnBuZycpO1xuICAgICAgICAgICAgdGhpcy5sb2FkLmltYWdlKCdjbG9ja19zcHJpdGUnLCAnYXNzZXRzL2ltZy9jbG9jay5wbmcnKTtcbiAgICAgICAgICAgIHRoaXMubG9hZC5pbWFnZSgnaG91cmhhbmQnLCAnYXNzZXRzL2ltZy9ob3VyaGFuZC5wbmcnKTtcbiAgICAgICAgICAgIHRoaXMubG9hZC5pbWFnZSgnc2Vjb25kaGFuZCcsICdhc3NldHMvaW1nL3NlY29uZGhhbmQucG5nJyk7XG4gICAgICAgICAgICB0aGlzLmxvYWQuaW1hZ2UoJ2JhY2tfYnRuJywgJ2Fzc2V0cy9pbWcvYmFja19idG4ucG5nJyk7XG5cbiAgICAgICAgICAgIHRoaXMubG9hZC5zcHJpdGVzaGVldCgnY2hhbmdlX2J0bicsICdhc3NldHMvaW1nL2NoYW5nZV9idG4ucG5nJywxODAsMzgsMTYpO1xuICAgICAgICAgICAgdGhpcy5sb2FkLmltYWdlKCdnYW1lX3RpdGxlJywgJ2Fzc2V0cy9pbWcvZ2FtZV90aXRsZS5wbmcnKTtcbiAgICAgICAgICAgIHRoaXMubG9hZC5pbWFnZSgnYnRuX2Fycm93JywgJ2Fzc2V0cy9pbWcvYnRuX2Fycm93LnBuZycpO1xuXG5cbiAgICAgICAgICAgIHRoaXMubG9hZC5pbWFnZSgndmlkZW9fYmcnLCAnYXNzZXRzL2ltZy92aWRlb19iZy5wbmcnKTtcbiAgICAgICAgICAgIHRoaXMubG9hZC5pbWFnZSgnZXZpZGVvJywgJ2Fzc2V0cy9pbWcvZXZpZGVvLnBuZycpO1xuICAgICAgICAgICAgdGhpcy5sb2FkLmltYWdlKCdsaW5rX2J0bicsICdhc3NldHMvaW1nL2xpbmtfYnRuLnBuZycpO1xuICAgICAgICAgICAgdGhpcy5sb2FkLnNwcml0ZXNoZWV0KCdlbmRfaScsICdhc3NldHMvaW1nL2VuZF9pLnBuZycsNDQsMjcsMik7XG4gICAgICAgICAgICB0aGlzLmxvYWQuaW1hZ2UoJ2NvbnRlbnRfYmcnLCdhc3NldHMvaW1nL2NvbnRlbnRfYmcucG5nJyk7XG4gICAgICAgICAgICBcblxuICAgICAgICAgICAgdGhpcy5sb2FkLnNwcml0ZXNoZWV0KCdxbG9hZGVyJywgJ2Fzc2V0cy9pbWcvcWxvYWRlci5wbmcnLCAxMjgsIDEyOCwgMTIpO1xuXG4gICAgICAgICAgICB2YXIgYnZvaWNlX3Nwcml0ZV9qc29uID0ge1xuICAgICAgICAgICAgICAgIFwiZnJhbWVzXCI6IHtcblxuICAgICAgICAgICAgICAgICAgICBcImluXzAwMDAucG5nXCI6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIFwiZnJhbWVcIjoge1wieFwiOiA3MTAsIFwieVwiOiA1ODgsIFwid1wiOiAxLCBcImhcIjogMX0sXG4gICAgICAgICAgICAgICAgICAgICAgICBcInJvdGF0ZWRcIjogZmFsc2UsXG4gICAgICAgICAgICAgICAgICAgICAgICBcInRyaW1tZWRcIjogdHJ1ZSxcbiAgICAgICAgICAgICAgICAgICAgICAgIFwic3ByaXRlU291cmNlU2l6ZVwiOiB7XCJ4XCI6IDAsIFwieVwiOiAwLCBcIndcIjogMSwgXCJoXCI6IDF9LFxuICAgICAgICAgICAgICAgICAgICAgICAgXCJzb3VyY2VTaXplXCI6IHtcIndcIjogNzUwLCBcImhcIjogMTkwfVxuICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICBcImluXzAwMDEucG5nXCI6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIFwiZnJhbWVcIjoge1wieFwiOiAwLCBcInlcIjogNTg4LCBcIndcIjogNzEwLCBcImhcIjogMTZ9LFxuICAgICAgICAgICAgICAgICAgICAgICAgXCJyb3RhdGVkXCI6IGZhbHNlLFxuICAgICAgICAgICAgICAgICAgICAgICAgXCJ0cmltbWVkXCI6IHRydWUsXG4gICAgICAgICAgICAgICAgICAgICAgICBcInNwcml0ZVNvdXJjZVNpemVcIjoge1wieFwiOiAyMCwgXCJ5XCI6IDg0LCBcIndcIjogNzEwLCBcImhcIjogMTZ9LFxuICAgICAgICAgICAgICAgICAgICAgICAgXCJzb3VyY2VTaXplXCI6IHtcIndcIjogNzUwLCBcImhcIjogMTkwfVxuICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICBcImluXzAwMDIucG5nXCI6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIFwiZnJhbWVcIjoge1wieFwiOiAwLCBcInlcIjogNTMwLCBcIndcIjogNzE2LCBcImhcIjogMzB9LFxuICAgICAgICAgICAgICAgICAgICAgICAgXCJyb3RhdGVkXCI6IGZhbHNlLFxuICAgICAgICAgICAgICAgICAgICAgICAgXCJ0cmltbWVkXCI6IHRydWUsXG4gICAgICAgICAgICAgICAgICAgICAgICBcInNwcml0ZVNvdXJjZVNpemVcIjoge1wieFwiOiAxNywgXCJ5XCI6IDc3LCBcIndcIjogNzE2LCBcImhcIjogMzB9LFxuICAgICAgICAgICAgICAgICAgICAgICAgXCJzb3VyY2VTaXplXCI6IHtcIndcIjogNzUwLCBcImhcIjogMTkwfVxuICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICBcImluXzAwMDMucG5nXCI6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIFwiZnJhbWVcIjoge1wieFwiOiA3MTYsIFwieVwiOiA1MjYsIFwid1wiOiA3MTYsIFwiaFwiOiAzMH0sXG4gICAgICAgICAgICAgICAgICAgICAgICBcInJvdGF0ZWRcIjogZmFsc2UsXG4gICAgICAgICAgICAgICAgICAgICAgICBcInRyaW1tZWRcIjogdHJ1ZSxcbiAgICAgICAgICAgICAgICAgICAgICAgIFwic3ByaXRlU291cmNlU2l6ZVwiOiB7XCJ4XCI6IDE3LCBcInlcIjogNzcsIFwid1wiOiA3MTYsIFwiaFwiOiAzMH0sXG4gICAgICAgICAgICAgICAgICAgICAgICBcInNvdXJjZVNpemVcIjoge1wid1wiOiA3NTAsIFwiaFwiOiAxOTB9XG4gICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgIFwiaW5fMDAwNC5wbmdcIjoge1xuICAgICAgICAgICAgICAgICAgICAgICAgXCJmcmFtZVwiOiB7XCJ4XCI6IDAsIFwieVwiOiA1MDAsIFwid1wiOiA3MTYsIFwiaFwiOiAzMH0sXG4gICAgICAgICAgICAgICAgICAgICAgICBcInJvdGF0ZWRcIjogZmFsc2UsXG4gICAgICAgICAgICAgICAgICAgICAgICBcInRyaW1tZWRcIjogdHJ1ZSxcbiAgICAgICAgICAgICAgICAgICAgICAgIFwic3ByaXRlU291cmNlU2l6ZVwiOiB7XCJ4XCI6IDE3LCBcInlcIjogNzcsIFwid1wiOiA3MTYsIFwiaFwiOiAzMH0sXG4gICAgICAgICAgICAgICAgICAgICAgICBcInNvdXJjZVNpemVcIjoge1wid1wiOiA3NTAsIFwiaFwiOiAxOTB9XG4gICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgIFwiaW5fMDAwNS5wbmdcIjoge1xuICAgICAgICAgICAgICAgICAgICAgICAgXCJmcmFtZVwiOiB7XCJ4XCI6IDcxNiwgXCJ5XCI6IDQ5NiwgXCJ3XCI6IDcxNiwgXCJoXCI6IDMwfSxcbiAgICAgICAgICAgICAgICAgICAgICAgIFwicm90YXRlZFwiOiBmYWxzZSxcbiAgICAgICAgICAgICAgICAgICAgICAgIFwidHJpbW1lZFwiOiB0cnVlLFxuICAgICAgICAgICAgICAgICAgICAgICAgXCJzcHJpdGVTb3VyY2VTaXplXCI6IHtcInhcIjogMTcsIFwieVwiOiA3NywgXCJ3XCI6IDcxNiwgXCJoXCI6IDMwfSxcbiAgICAgICAgICAgICAgICAgICAgICAgIFwic291cmNlU2l6ZVwiOiB7XCJ3XCI6IDc1MCwgXCJoXCI6IDE5MH1cbiAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgXCJpbl8wMDA2LnBuZ1wiOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICBcImZyYW1lXCI6IHtcInhcIjogNzE2LCBcInlcIjogNTg0LCBcIndcIjogNzE2LCBcImhcIjogMjh9LFxuICAgICAgICAgICAgICAgICAgICAgICAgXCJyb3RhdGVkXCI6IGZhbHNlLFxuICAgICAgICAgICAgICAgICAgICAgICAgXCJ0cmltbWVkXCI6IHRydWUsXG4gICAgICAgICAgICAgICAgICAgICAgICBcInNwcml0ZVNvdXJjZVNpemVcIjoge1wieFwiOiAxNywgXCJ5XCI6IDc4LCBcIndcIjogNzE2LCBcImhcIjogMjh9LFxuICAgICAgICAgICAgICAgICAgICAgICAgXCJzb3VyY2VTaXplXCI6IHtcIndcIjogNzUwLCBcImhcIjogMTkwfVxuICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICBcImluXzAwMDcucG5nXCI6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIFwiZnJhbWVcIjoge1wieFwiOiAwLCBcInlcIjogNTYwLCBcIndcIjogNzE2LCBcImhcIjogMjh9LFxuICAgICAgICAgICAgICAgICAgICAgICAgXCJyb3RhdGVkXCI6IGZhbHNlLFxuICAgICAgICAgICAgICAgICAgICAgICAgXCJ0cmltbWVkXCI6IHRydWUsXG4gICAgICAgICAgICAgICAgICAgICAgICBcInNwcml0ZVNvdXJjZVNpemVcIjoge1wieFwiOiAxNywgXCJ5XCI6IDc4LCBcIndcIjogNzE2LCBcImhcIjogMjh9LFxuICAgICAgICAgICAgICAgICAgICAgICAgXCJzb3VyY2VTaXplXCI6IHtcIndcIjogNzUwLCBcImhcIjogMTkwfVxuICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICBcIndoaXRlXzAwMDcucG5nXCI6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIFwiZnJhbWVcIjoge1wieFwiOiA3MTYsIFwieVwiOiA1NTYsIFwid1wiOiA3MTYsIFwiaFwiOiAyOH0sXG4gICAgICAgICAgICAgICAgICAgICAgICBcInJvdGF0ZWRcIjogZmFsc2UsXG4gICAgICAgICAgICAgICAgICAgICAgICBcInRyaW1tZWRcIjogdHJ1ZSxcbiAgICAgICAgICAgICAgICAgICAgICAgIFwic3ByaXRlU291cmNlU2l6ZVwiOiB7XCJ4XCI6IDE3LCBcInlcIjogNzgsIFwid1wiOiA3MTYsIFwiaFwiOiAyOH0sXG4gICAgICAgICAgICAgICAgICAgICAgICBcInNvdXJjZVNpemVcIjoge1wid1wiOiA3NTAsIFwiaFwiOiAxOTB9XG4gICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgIFwid2hpdGVfMDAwOC5wbmdcIjoge1xuICAgICAgICAgICAgICAgICAgICAgICAgXCJmcmFtZVwiOiB7XCJ4XCI6IDAsIFwieVwiOiA0MjIsIFwid1wiOiA3MTYsIFwiaFwiOiA0Mn0sXG4gICAgICAgICAgICAgICAgICAgICAgICBcInJvdGF0ZWRcIjogZmFsc2UsXG4gICAgICAgICAgICAgICAgICAgICAgICBcInRyaW1tZWRcIjogdHJ1ZSxcbiAgICAgICAgICAgICAgICAgICAgICAgIFwic3ByaXRlU291cmNlU2l6ZVwiOiB7XCJ4XCI6IDE3LCBcInlcIjogNzEsIFwid1wiOiA3MTYsIFwiaFwiOiA0Mn0sXG4gICAgICAgICAgICAgICAgICAgICAgICBcInNvdXJjZVNpemVcIjoge1wid1wiOiA3NTAsIFwiaFwiOiAxOTB9XG4gICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgIFwid2hpdGVfMDAwOS5wbmdcIjoge1xuICAgICAgICAgICAgICAgICAgICAgICAgXCJmcmFtZVwiOiB7XCJ4XCI6IDcxNiwgXCJ5XCI6IDMxNCwgXCJ3XCI6IDcxNiwgXCJoXCI6IDU2fSxcbiAgICAgICAgICAgICAgICAgICAgICAgIFwicm90YXRlZFwiOiBmYWxzZSxcbiAgICAgICAgICAgICAgICAgICAgICAgIFwidHJpbW1lZFwiOiB0cnVlLFxuICAgICAgICAgICAgICAgICAgICAgICAgXCJzcHJpdGVTb3VyY2VTaXplXCI6IHtcInhcIjogMTcsIFwieVwiOiA2NCwgXCJ3XCI6IDcxNiwgXCJoXCI6IDU2fSxcbiAgICAgICAgICAgICAgICAgICAgICAgIFwic291cmNlU2l6ZVwiOiB7XCJ3XCI6IDc1MCwgXCJoXCI6IDE5MH1cbiAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgXCJ3aGl0ZV8wMDEwLnBuZ1wiOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICBcImZyYW1lXCI6IHtcInhcIjogNzE2LCBcInlcIjogMCwgXCJ3XCI6IDcxNiwgXCJoXCI6IDcyfSxcbiAgICAgICAgICAgICAgICAgICAgICAgIFwicm90YXRlZFwiOiBmYWxzZSxcbiAgICAgICAgICAgICAgICAgICAgICAgIFwidHJpbW1lZFwiOiB0cnVlLFxuICAgICAgICAgICAgICAgICAgICAgICAgXCJzcHJpdGVTb3VyY2VTaXplXCI6IHtcInhcIjogMTcsIFwieVwiOiA1NiwgXCJ3XCI6IDcxNiwgXCJoXCI6IDcyfSxcbiAgICAgICAgICAgICAgICAgICAgICAgIFwic291cmNlU2l6ZVwiOiB7XCJ3XCI6IDc1MCwgXCJoXCI6IDE5MH1cbiAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgXCJ3aGl0ZV8wMDExLnBuZ1wiOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICBcImZyYW1lXCI6IHtcInhcIjogMCwgXCJ5XCI6IDAsIFwid1wiOiA3MTYsIFwiaFwiOiA4NH0sXG4gICAgICAgICAgICAgICAgICAgICAgICBcInJvdGF0ZWRcIjogZmFsc2UsXG4gICAgICAgICAgICAgICAgICAgICAgICBcInRyaW1tZWRcIjogdHJ1ZSxcbiAgICAgICAgICAgICAgICAgICAgICAgIFwic3ByaXRlU291cmNlU2l6ZVwiOiB7XCJ4XCI6IDE3LCBcInlcIjogNTAsIFwid1wiOiA3MTYsIFwiaFwiOiA4NH0sXG4gICAgICAgICAgICAgICAgICAgICAgICBcInNvdXJjZVNpemVcIjoge1wid1wiOiA3NTAsIFwiaFwiOiAxOTB9XG4gICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgIFwid2hpdGVfMDAxMi5wbmdcIjoge1xuICAgICAgICAgICAgICAgICAgICAgICAgXCJmcmFtZVwiOiB7XCJ4XCI6IDAsIFwieVwiOiA4NCwgXCJ3XCI6IDcxNiwgXCJoXCI6IDY0fSxcbiAgICAgICAgICAgICAgICAgICAgICAgIFwicm90YXRlZFwiOiBmYWxzZSxcbiAgICAgICAgICAgICAgICAgICAgICAgIFwidHJpbW1lZFwiOiB0cnVlLFxuICAgICAgICAgICAgICAgICAgICAgICAgXCJzcHJpdGVTb3VyY2VTaXplXCI6IHtcInhcIjogMTcsIFwieVwiOiA2MCwgXCJ3XCI6IDcxNiwgXCJoXCI6IDY0fSxcbiAgICAgICAgICAgICAgICAgICAgICAgIFwic291cmNlU2l6ZVwiOiB7XCJ3XCI6IDc1MCwgXCJoXCI6IDE5MH1cbiAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgXCJ3aGl0ZV8wMDEzLnBuZ1wiOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICBcImZyYW1lXCI6IHtcInhcIjogNzE2LCBcInlcIjogNzIsIFwid1wiOiA3MTYsIFwiaFwiOiA2OH0sXG4gICAgICAgICAgICAgICAgICAgICAgICBcInJvdGF0ZWRcIjogZmFsc2UsXG4gICAgICAgICAgICAgICAgICAgICAgICBcInRyaW1tZWRcIjogdHJ1ZSxcbiAgICAgICAgICAgICAgICAgICAgICAgIFwic3ByaXRlU291cmNlU2l6ZVwiOiB7XCJ4XCI6IDE3LCBcInlcIjogNTgsIFwid1wiOiA3MTYsIFwiaFwiOiA2OH0sXG4gICAgICAgICAgICAgICAgICAgICAgICBcInNvdXJjZVNpemVcIjoge1wid1wiOiA3NTAsIFwiaFwiOiAxOTB9XG4gICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgIFwid2hpdGVfMDAxNC5wbmdcIjoge1xuICAgICAgICAgICAgICAgICAgICAgICAgXCJmcmFtZVwiOiB7XCJ4XCI6IDAsIFwieVwiOiAyMDYsIFwid1wiOiA3MTYsIFwiaFwiOiA1OH0sXG4gICAgICAgICAgICAgICAgICAgICAgICBcInJvdGF0ZWRcIjogZmFsc2UsXG4gICAgICAgICAgICAgICAgICAgICAgICBcInRyaW1tZWRcIjogdHJ1ZSxcbiAgICAgICAgICAgICAgICAgICAgICAgIFwic3ByaXRlU291cmNlU2l6ZVwiOiB7XCJ4XCI6IDE3LCBcInlcIjogNjMsIFwid1wiOiA3MTYsIFwiaFwiOiA1OH0sXG4gICAgICAgICAgICAgICAgICAgICAgICBcInNvdXJjZVNpemVcIjoge1wid1wiOiA3NTAsIFwiaFwiOiAxOTB9XG4gICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgIFwid2hpdGVfMDAxNS5wbmdcIjoge1xuICAgICAgICAgICAgICAgICAgICAgICAgXCJmcmFtZVwiOiB7XCJ4XCI6IDcxNiwgXCJ5XCI6IDIwMCwgXCJ3XCI6IDcxNiwgXCJoXCI6IDU4fSxcbiAgICAgICAgICAgICAgICAgICAgICAgIFwicm90YXRlZFwiOiBmYWxzZSxcbiAgICAgICAgICAgICAgICAgICAgICAgIFwidHJpbW1lZFwiOiB0cnVlLFxuICAgICAgICAgICAgICAgICAgICAgICAgXCJzcHJpdGVTb3VyY2VTaXplXCI6IHtcInhcIjogMTcsIFwieVwiOiA2MywgXCJ3XCI6IDcxNiwgXCJoXCI6IDU4fSxcbiAgICAgICAgICAgICAgICAgICAgICAgIFwic291cmNlU2l6ZVwiOiB7XCJ3XCI6IDc1MCwgXCJoXCI6IDE5MH1cbiAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgXCJ3aGl0ZV8wMDE2LnBuZ1wiOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICBcImZyYW1lXCI6IHtcInhcIjogNzE2LCBcInlcIjogMTQwLCBcIndcIjogNzE2LCBcImhcIjogNjB9LFxuICAgICAgICAgICAgICAgICAgICAgICAgXCJyb3RhdGVkXCI6IGZhbHNlLFxuICAgICAgICAgICAgICAgICAgICAgICAgXCJ0cmltbWVkXCI6IHRydWUsXG4gICAgICAgICAgICAgICAgICAgICAgICBcInNwcml0ZVNvdXJjZVNpemVcIjoge1wieFwiOiAxNywgXCJ5XCI6IDYyLCBcIndcIjogNzE2LCBcImhcIjogNjB9LFxuICAgICAgICAgICAgICAgICAgICAgICAgXCJzb3VyY2VTaXplXCI6IHtcIndcIjogNzUwLCBcImhcIjogMTkwfVxuICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICBcIndoaXRlXzAwMTcucG5nXCI6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIFwiZnJhbWVcIjoge1wieFwiOiAwLCBcInlcIjogMjY0LCBcIndcIjogNzE2LCBcImhcIjogNTZ9LFxuICAgICAgICAgICAgICAgICAgICAgICAgXCJyb3RhdGVkXCI6IGZhbHNlLFxuICAgICAgICAgICAgICAgICAgICAgICAgXCJ0cmltbWVkXCI6IHRydWUsXG4gICAgICAgICAgICAgICAgICAgICAgICBcInNwcml0ZVNvdXJjZVNpemVcIjoge1wieFwiOiAxNywgXCJ5XCI6IDY0LCBcIndcIjogNzE2LCBcImhcIjogNTZ9LFxuICAgICAgICAgICAgICAgICAgICAgICAgXCJzb3VyY2VTaXplXCI6IHtcIndcIjogNzUwLCBcImhcIjogMTkwfVxuICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICBcIndoaXRlXzAwMTgucG5nXCI6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIFwiZnJhbWVcIjoge1wieFwiOiAwLCBcInlcIjogMzIwLCBcIndcIjogNzE2LCBcImhcIjogNTR9LFxuICAgICAgICAgICAgICAgICAgICAgICAgXCJyb3RhdGVkXCI6IGZhbHNlLFxuICAgICAgICAgICAgICAgICAgICAgICAgXCJ0cmltbWVkXCI6IHRydWUsXG4gICAgICAgICAgICAgICAgICAgICAgICBcInNwcml0ZVNvdXJjZVNpemVcIjoge1wieFwiOiAxNywgXCJ5XCI6IDY1LCBcIndcIjogNzE2LCBcImhcIjogNTR9LFxuICAgICAgICAgICAgICAgICAgICAgICAgXCJzb3VyY2VTaXplXCI6IHtcIndcIjogNzUwLCBcImhcIjogMTkwfVxuICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICBcIndoaXRlXzAwMTkucG5nXCI6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIFwiZnJhbWVcIjoge1wieFwiOiAwLCBcInlcIjogMzc0LCBcIndcIjogNzE2LCBcImhcIjogNDh9LFxuICAgICAgICAgICAgICAgICAgICAgICAgXCJyb3RhdGVkXCI6IGZhbHNlLFxuICAgICAgICAgICAgICAgICAgICAgICAgXCJ0cmltbWVkXCI6IHRydWUsXG4gICAgICAgICAgICAgICAgICAgICAgICBcInNwcml0ZVNvdXJjZVNpemVcIjoge1wieFwiOiAxNywgXCJ5XCI6IDY4LCBcIndcIjogNzE2LCBcImhcIjogNDh9LFxuICAgICAgICAgICAgICAgICAgICAgICAgXCJzb3VyY2VTaXplXCI6IHtcIndcIjogNzUwLCBcImhcIjogMTkwfVxuICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICBcIndoaXRlXzAwMjAucG5nXCI6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIFwiZnJhbWVcIjoge1wieFwiOiA3MTYsIFwieVwiOiAyNTgsIFwid1wiOiA3MTYsIFwiaFwiOiA1Nn0sXG4gICAgICAgICAgICAgICAgICAgICAgICBcInJvdGF0ZWRcIjogZmFsc2UsXG4gICAgICAgICAgICAgICAgICAgICAgICBcInRyaW1tZWRcIjogdHJ1ZSxcbiAgICAgICAgICAgICAgICAgICAgICAgIFwic3ByaXRlU291cmNlU2l6ZVwiOiB7XCJ4XCI6IDE3LCBcInlcIjogNjQsIFwid1wiOiA3MTYsIFwiaFwiOiA1Nn0sXG4gICAgICAgICAgICAgICAgICAgICAgICBcInNvdXJjZVNpemVcIjoge1wid1wiOiA3NTAsIFwiaFwiOiAxOTB9XG4gICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgIFwid2hpdGVfMDAyMS5wbmdcIjoge1xuICAgICAgICAgICAgICAgICAgICAgICAgXCJmcmFtZVwiOiB7XCJ4XCI6IDAsIFwieVwiOiAxNDgsIFwid1wiOiA3MTYsIFwiaFwiOiA1OH0sXG4gICAgICAgICAgICAgICAgICAgICAgICBcInJvdGF0ZWRcIjogZmFsc2UsXG4gICAgICAgICAgICAgICAgICAgICAgICBcInRyaW1tZWRcIjogdHJ1ZSxcbiAgICAgICAgICAgICAgICAgICAgICAgIFwic3ByaXRlU291cmNlU2l6ZVwiOiB7XCJ4XCI6IDE3LCBcInlcIjogNjMsIFwid1wiOiA3MTYsIFwiaFwiOiA1OH0sXG4gICAgICAgICAgICAgICAgICAgICAgICBcInNvdXJjZVNpemVcIjoge1wid1wiOiA3NTAsIFwiaFwiOiAxOTB9XG4gICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgIFwid2hpdGVfMDAyMi5wbmdcIjoge1xuICAgICAgICAgICAgICAgICAgICAgICAgXCJmcmFtZVwiOiB7XCJ4XCI6IDcxNiwgXCJ5XCI6IDM3MCwgXCJ3XCI6IDcxNiwgXCJoXCI6IDUwfSxcbiAgICAgICAgICAgICAgICAgICAgICAgIFwicm90YXRlZFwiOiBmYWxzZSxcbiAgICAgICAgICAgICAgICAgICAgICAgIFwidHJpbW1lZFwiOiB0cnVlLFxuICAgICAgICAgICAgICAgICAgICAgICAgXCJzcHJpdGVTb3VyY2VTaXplXCI6IHtcInhcIjogMTcsIFwieVwiOiA2NywgXCJ3XCI6IDcxNiwgXCJoXCI6IDUwfSxcbiAgICAgICAgICAgICAgICAgICAgICAgIFwic291cmNlU2l6ZVwiOiB7XCJ3XCI6IDc1MCwgXCJoXCI6IDE5MH1cbiAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgXCJ3aGl0ZV8wMDIzLnBuZ1wiOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICBcImZyYW1lXCI6IHtcInhcIjogNzE2LCBcInlcIjogNDIwLCBcIndcIjogNzE2LCBcImhcIjogNDR9LFxuICAgICAgICAgICAgICAgICAgICAgICAgXCJyb3RhdGVkXCI6IGZhbHNlLFxuICAgICAgICAgICAgICAgICAgICAgICAgXCJ0cmltbWVkXCI6IHRydWUsXG4gICAgICAgICAgICAgICAgICAgICAgICBcInNwcml0ZVNvdXJjZVNpemVcIjoge1wieFwiOiAxNywgXCJ5XCI6IDcwLCBcIndcIjogNzE2LCBcImhcIjogNDR9LFxuICAgICAgICAgICAgICAgICAgICAgICAgXCJzb3VyY2VTaXplXCI6IHtcIndcIjogNzUwLCBcImhcIjogMTkwfVxuICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICBcIndoaXRlXzAwMjQucG5nXCI6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIFwiZnJhbWVcIjoge1wieFwiOiAwLCBcInlcIjogNDY0LCBcIndcIjogNzE2LCBcImhcIjogMzZ9LFxuICAgICAgICAgICAgICAgICAgICAgICAgXCJyb3RhdGVkXCI6IGZhbHNlLFxuICAgICAgICAgICAgICAgICAgICAgICAgXCJ0cmltbWVkXCI6IHRydWUsXG4gICAgICAgICAgICAgICAgICAgICAgICBcInNwcml0ZVNvdXJjZVNpemVcIjoge1wieFwiOiAxNywgXCJ5XCI6IDc0LCBcIndcIjogNzE2LCBcImhcIjogMzZ9LFxuICAgICAgICAgICAgICAgICAgICAgICAgXCJzb3VyY2VTaXplXCI6IHtcIndcIjogNzUwLCBcImhcIjogMTkwfVxuICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICBcIndoaXRlXzAwMjUucG5nXCI6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIFwiZnJhbWVcIjoge1wieFwiOiA3MTYsIFwieVwiOiA0NjQsIFwid1wiOiA3MTYsIFwiaFwiOiAzMn0sXG4gICAgICAgICAgICAgICAgICAgICAgICBcInJvdGF0ZWRcIjogZmFsc2UsXG4gICAgICAgICAgICAgICAgICAgICAgICBcInRyaW1tZWRcIjogdHJ1ZSxcbiAgICAgICAgICAgICAgICAgICAgICAgIFwic3ByaXRlU291cmNlU2l6ZVwiOiB7XCJ4XCI6IDE3LCBcInlcIjogNzYsIFwid1wiOiA3MTYsIFwiaFwiOiAzMn0sXG4gICAgICAgICAgICAgICAgICAgICAgICBcInNvdXJjZVNpemVcIjoge1wid1wiOiA3NTAsIFwiaFwiOiAxOTB9XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgIFwibWV0YVwiOiB7XG4gICAgICAgICAgICAgICAgICAgIFwiYXBwXCI6IFwiaHR0cDovL3d3dy5jb2RlYW5kd2ViLmNvbS90ZXh0dXJlcGFja2VyIFwiLFxuICAgICAgICAgICAgICAgICAgICBcInZlcnNpb25cIjogXCIxLjBcIixcbiAgICAgICAgICAgICAgICAgICAgXCJpbWFnZVwiOiBcImJ2b2ljZV9zcHJpdGUucG5nXCIsXG4gICAgICAgICAgICAgICAgICAgIFwiZm9ybWF0XCI6IFwiUkdCQTg4ODhcIixcbiAgICAgICAgICAgICAgICAgICAgXCJzaXplXCI6IHtcIndcIjogMTQzMiwgXCJoXCI6IDYxMn0sXG4gICAgICAgICAgICAgICAgICAgIFwic2NhbGVcIjogXCIxXCIsXG4gICAgICAgICAgICAgICAgICAgIFwic21hcnR1cGRhdGVcIjogXCIkVGV4dHVyZVBhY2tlcjpTbWFydFVwZGF0ZTpkMmI5YTg2NTg4NWFhNGYxZmQyNDI2YzE3MDJjNzEzNToxLzEkXCJcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9O1xuXG5cbiAgICAgICAgICAgIHRoaXMubG9hZC5hdGxhcygnYnZvaWNlX3Nwcml0ZScsICdhc3NldHMvaW1nL2J2b2ljZV9zcHJpdGUucG5nJywgbnVsbCwgYnZvaWNlX3Nwcml0ZV9qc29uKTtcblxuXG5cbiAgICAgICAgICAgIC8vIHRoaXMubG9hZC5pbWFnZSgnY2xpY2thcmVhJywgJ2Fzc2V0cy9pbWcvY2xpY2thcmVhLnBuZycpO1xuICAgICAgICAgICAgLy8gdGhpcy5sb2FkLmF1ZGlvKCdxMScsICdhc3NldHMvYXVkaW8vcTEubXAzJyk7XG5cblxuXG4gICAgICAgICAgICB0aGlzLmxvYWQuc3RhcnQoKTtcblxuICAgICAgICB9LFxuXG4gICAgICAgIGNyZWF0ZTogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgdmFyIHRoYXQgPSB0aGlzO1xuXG4gICAgICAgICAgICBpZighd2luZG93LmFuZHJvaWQpe1xuICAgICAgICAgICAgICAgIHRoaXMubG9hZGVyID0gdGhpcy5hZGQuc3ByaXRlKHRoaXMuZ2FtZS53aWR0aCAvIDIsIHRoaXMuZ2FtZS5oZWlnaHQgLyAyLTExMCwgJ2xvYWRlcl9hJyk7XG4gICAgICAgICAgICAgICAgdGhpcy5sb2FkZXIuYW5jaG9yLnNldFRvKDAuNSk7XG4gICAgICAgICAgICAgICAgdGhpcy5sb2FkZXIuYW5pbWF0aW9ucy5hZGQoJ2x0JykucGxheSgxNSwgdHJ1ZSk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIHRoaXMubHQgPSB0aGlzLmFkZC5zcHJpdGUodGhpcy5nYW1lLndpZHRoIC8gMiwgdGhpcy5nYW1lLmhlaWdodCAvIDIsICdsdCcpO1xuICAgICAgICAgICAgdGhpcy5sdC5hbmNob3Iuc2V0VG8oMC41KTtcbiAgICAgICAgICAgIHRoaXMubHQuYW5pbWF0aW9ucy5hZGQoJ2x0JykucGxheSgwLjcsIHRydWUpO1xuXG4gICAgICAgICAgICAvLyB0aGlzLmxvYWQub25Mb2FkU3RhcnQuYWRkKHRoYXQubG9hZFJlc291cmNlcywgdGhpcyk7XG4gICAgICAgICAgICB0aGlzLmxvYWQub25GaWxlQ29tcGxldGUuYWRkKHRoYXQub25maWxlQ29tcGxldGUsIHRoaXMpO1xuICAgICAgICAgICAgdGhpcy5sb2FkLm9uTG9hZENvbXBsZXRlLmFkZE9uY2UodGhhdC5vbkxvYWRDb21wbGV0ZSwgdGhpcyk7XG4gICAgICAgICAgICB0aGlzLmxvYWRSZXNvdXJjZXMoKTtcblxuICAgICAgICAgICAgdGhpcy5yZWFkeSA9IHRydWU7XG5cblxuICAgICAgICB9LFxuXG4gICAgICAgIG9uTG9hZENvbXBsZXRlOiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICB2YXIgdGhhdD10aGlzO1xuICAgICAgICAgICAgLy8gdGhpcy5yZWFkeSA9IHRydWU7XG4gICAgICAgICAgICAvLyB2YXIgbWxlbmd0aCA9ICQoXCIjYmFpZHVzcG9ydC1nYW1lXCIpLmZpbmQoXCJjYW52YXNcIikud2lkdGgoKTtcbiAgICAgICAgICAgIC8vICQoXCIjYmFpZHVzcG9ydC1nYW1lXCIpLmZpbmQoXCJjYW52YXNcIikuY3NzKFwibWFyZ2luLWxlZnRcIiwpO1xuXG4gICAgICAgICAgICBpZighd2luZG93LmFuZHJvaWQpe1xuICAgICAgICAgICAgICAgIHRoaXMuZ2FtZS50aW1lLmV2ZW50cy5hZGQoMzUwMCwgZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLmxvYWRlci5raWxsKCk7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMubHQua2lsbCgpO1xuXG4gICAgICAgICAgICAgICAgICAgIHZhciBlbnRlcl9idG49dGhpcy5hZGQuaW1hZ2UodGhpcy5nYW1lLndpZHRoIC8gMiwgdGhpcy5nYW1lLmhlaWdodCAvIDItODAsJ2VudGVyX2J0bicpO1xuICAgICAgICAgICAgICAgICAgICBlbnRlcl9idG4uYW5jaG9yLnNldFRvKDAuNSk7XG4gICAgICAgICAgICAgICAgICAgIGVudGVyX2J0bi5pbnB1dEVuYWJsZWQgPSB0cnVlO1xuICAgICAgICAgICAgICAgICAgICBlbnRlcl9idG4uZXZlbnRzLm9uSW5wdXREb3duLmFkZE9uY2UoZnVuY3Rpb24gKCkge1xuXG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmdhbWUuc3RhdGUuc3RhcnQoJ0hvbWUnKTtcbiAgICAgICAgICAgICAgICAgICAgfSwgdGhpcyk7XG4gICAgICAgICAgICAgICAgfSx0aGlzKTtcblxuXG4gICAgICAgICAgICB9ZWxzZSB7XG4gICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgLy8gdGhpcy5nYW1lLnRpbWUuZXZlbnRzLmFkZCgzNTAwLCBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgLy8gICAgIHRoYXQubHQua2lsbCgpO1xuICAgICAgICAgICAgICAgIC8vICAgICB2YXIgZl9jbGljaz10aGlzLmFkZC5pbWFnZSh0aGlzLmdhbWUud2lkdGggLyAyLCB0aGlzLmdhbWUuaGVpZ2h0IC8gMik7XG4gICAgICAgICAgICAgICAgLy8gICAgIGZfY2xpY2sud2lkdGg9NDAwO1xuICAgICAgICAgICAgICAgIC8vICAgICBmX2NsaWNrLmhlaWdodD00MDA7XG4gICAgICAgICAgICAgICAgLy8gICAgIGZfY2xpY2suYW5jaG9yLnNldFRvKDAuNSk7XG4gICAgICAgICAgICAgICAgLy8gICAgIGZfY2xpY2suaW5wdXRFbmFibGVkID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICAvLyAgICAgZl9jbGljay5ldmVudHMub25JbnB1dERvd24uYWRkT25jZShmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgLy9cbiAgICAgICAgICAgICAgICAvLyAgICAgICAgIHRoaXMuZ2FtZS5zdGF0ZS5zdGFydCgnSG9tZScpO1xuICAgICAgICAgICAgICAgIC8vICAgICB9LCB0aGlzKTtcbiAgICAgICAgICAgICAgICAvLyAgICAgdmFyIGZsb2FkX2lvcz10aGlzLmFkZC5pbWFnZSh0aGlzLmdhbWUud2lkdGggLyAyLCB0aGlzLmdhbWUuaGVpZ2h0IC8gMiwnZmxvYWRfaW9zJyk7XG4gICAgICAgICAgICAgICAgLy8gICAgIGZsb2FkX2lvcy5hbmNob3Iuc2V0VG8oMC41KTtcbiAgICAgICAgICAgICAgICAvL1xuICAgICAgICAgICAgICAgIC8vXG4gICAgICAgICAgICAgICAgLy8gfSx0aGlzKTtcbiAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICB2YXIgYz1nYW1lLmFkZC50d2Vlbih0aGF0Lmx0KS50byh7YWxwaGE6MH0sIDgwMCwgUGhhc2VyLkVhc2luZy5FeHBvbmVudGlhbC5PdXQsIHRydWUsIDM0MDApO1xuXG4gICAgICAgICAgICAgICAgYy5vbkNvbXBsZXRlLmFkZChmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgICAgIHRoYXQuZ2FtZS5zdGF0ZS5zdGFydCgnSG9tZScpO1xuXG4gICAgICAgICAgICAgICAgfSx0aGlzKTtcbiAgICAgICAgICAgIH1cblxuXG5cbiAgICAgICAgfSxcbiAgICAgICAgb25maWxlQ29tcGxldGU6IGZ1bmN0aW9uIChwcm9ncmVzcywgY2FjaGVLZXksIHN1Y2Nlc3MsIHRvdGFsTG9hZGVkLCB0b3RhbEZpbGVzKSB7XG4gICAgICAgICAgICAvLyB3aW5kb3cuYmFyLmFuaW1hdGUocHJvZ3Jlc3MvMTAwKTtcbiAgICAgICAgICAgIC8vIHRoaXMubXBpZXByb2dyZXNzLl9wcm9ncmVzcz1wcm9ncmVzcy8xMDA7XG4gICAgICAgICAgICAvLyB0aGlzLm1waWVwcm9ncmVzcy51cGRhdGVQcm9ncmVzcygpO1xuICAgICAgICB9XG4gICAgfTtcblxufSgpKTtcbiJdfQ==
